(function(exports){exports.renderjs={};var MatrixStack=(function(){function a(b,c,d){'use asm';var k=new b.Float32Array(d);var l=b.Math.imul;var m=b.Math.fround;var n=b.Math.floor;var o=b.Math.sin;var p=b.Math.cos;var q=b.Math.tan;var r=b.Math.sqrt;function s(f2){f2=f2|0;f2=f2<<6;k[f2+0>>2]=m(1.0);k[f2+4>>2]=m(0.0);k[f2+8>>2]=m(0.0);k[f2+12>>2]=m(0.0);k[f2+16>>2]=m(0.0);k[f2+20>>2]=m(1.0);k[f2+24>>2]=m(0.0);k[f2+28>>2]=m(0.0);k[f2+32>>2]=m(0.0);k[f2+36>>2]=m(0.0);k[f2+40>>2]=m(1.0);k[f2+44>>2]=m(0.0);k[f2+48>>2]=m(0.0);k[f2+52>>2]=m(0.0);k[f2+56>>2]=m(0.0);k[f2+60>>2]=m(1.0);}function u(f2,w,x,y,z){f2=f2|0;w= +w;x= +x;y= +y;z= +z;var k2=0.0;var l2=0.0;f2=f2<<6;k2=1.0/q(w/2.0);l2=1.0/(y-z);k[f2+0>>2]=m(k2/x);k[f2+4>>2]=m(0.0);k[f2+8>>2]=m(0.0);k[f2+12>>2]=m(0.0);k[f2+16>>2]=m(0.0);k[f2+20>>2]=m(k2);k[f2+24>>2]=m(0.0);k[f2+28>>2]=m(0.0);k[f2+32>>2]=m(0.0);k[f2+36>>2]=m(0.0);k[f2+40>>2]=m((y+z)*l2);k[f2+44>>2]=m(-1.0);k[f2+48>>2]=m(0.0);k[f2+52>>2]=m(0.0);k[f2+56>>2]=m(((y*z)*l2)*2.0);k[f2+60>>2]=m(0.0);}function a1(d2,b2){d2=d2|0;b2=b2|0;var m2=m(0.0),n2=m(0.0),o2=m(0.0),p2=m(0.0),q2=m(0.0),r2=m(0.0),s2=m(0.0),t2=m(0.0),u2=m(0.0),v2=m(0.0),w2=m(0.0),x2=m(0.0),y2=m(0.0),z2=m(0.0),a3=m(0.0),b3=m(0.0);d2=d2<<6;b2=b2<<6;m2=m(m(m(m(k[b2+0>>2])*m(k[d2+0>>2]))+m(m(k[b2+4>>2])*m(k[d2+16>>2])))+m(m(m(k[b2+8>>2])*m(k[d2+32>>2]))+m(m(k[b2+12>>2])*m(k[d2+48>>2]))));n2=m(m(m(m(k[b2+0>>2])*m(k[d2+4>>2]))+m(m(k[b2+4>>2])*m(k[d2+20>>2])))+m(m(m(k[b2+8>>2])*m(k[d2+36>>2]))+m(m(k[b2+12>>2])*m(k[d2+52>>2]))));o2=m(m(m(m(k[b2+0>>2])*m(k[d2+8>>2]))+m(m(k[b2+4>>2])*m(k[d2+24>>2])))+m(m(m(k[b2+8>>2])*m(k[d2+40>>2]))+m(m(k[b2+12>>2])*m(k[d2+56>>2]))));p2=m(m(m(m(k[b2+0>>2])*m(k[d2+12>>2]))+m(m(k[b2+4>>2])*m(k[d2+28>>2])))+m(m(m(k[b2+8>>2])*m(k[d2+44>>2]))+m(m(k[b2+12>>2])*m(k[d2+60>>2]))));q2=m(m(m(m(k[b2+16>>2])*m(k[d2+0>>2]))+m(m(k[b2+20>>2])*m(k[d2+16>>2])))+m(m(m(k[b2+24>>2])*m(k[d2+32>>2]))+m(m(k[b2+28>>2])*m(k[d2+48>>2]))));r2=m(m(m(m(k[b2+16>>2])*m(k[d2+4>>2]))+m(m(k[b2+20>>2])*m(k[d2+20>>2])))+m(m(m(k[b2+24>>2])*m(k[d2+36>>2]))+m(m(k[b2+28>>2])*m(k[d2+52>>2]))));s2=m(m(m(m(k[b2+16>>2])*m(k[d2+8>>2]))+m(m(k[b2+20>>2])*m(k[d2+24>>2])))+m(m(m(k[b2+24>>2])*m(k[d2+40>>2]))+m(m(k[b2+28>>2])*m(k[d2+56>>2]))));t2=m(m(m(m(k[b2+16>>2])*m(k[d2+12>>2]))+m(m(k[b2+20>>2])*m(k[d2+28>>2])))+m(m(m(k[b2+24>>2])*m(k[d2+44>>2]))+m(m(k[b2+28>>2])*m(k[d2+60>>2]))));u2=m(m(m(m(k[b2+32>>2])*m(k[d2+0>>2]))+m(m(k[b2+36>>2])*m(k[d2+16>>2])))+m(m(m(k[b2+40>>2])*m(k[d2+32>>2]))+m(m(k[b2+44>>2])*m(k[d2+48>>2]))));v2=m(m(m(m(k[b2+32>>2])*m(k[d2+4>>2]))+m(m(k[b2+36>>2])*m(k[d2+20>>2])))+m(m(m(k[b2+40>>2])*m(k[d2+36>>2]))+m(m(k[b2+44>>2])*m(k[d2+52>>2]))));w2=m(m(m(m(k[b2+32>>2])*m(k[d2+8>>2]))+m(m(k[b2+36>>2])*m(k[d2+24>>2])))+m(m(m(k[b2+40>>2])*m(k[d2+40>>2]))+m(m(k[b2+44>>2])*m(k[d2+56>>2]))));x2=m(m(m(m(k[b2+32>>2])*m(k[d2+12>>2]))+m(m(k[b2+36>>2])*m(k[d2+28>>2])))+m(m(m(k[b2+40>>2])*m(k[d2+44>>2]))+m(m(k[b2+44>>2])*m(k[d2+60>>2]))));y2=m(m(m(m(k[b2+48>>2])*m(k[d2+0>>2]))+m(m(k[b2+52>>2])*m(k[d2+16>>2])))+m(m(m(k[b2+56>>2])*m(k[d2+32>>2]))+m(m(k[b2+60>>2])*m(k[d2+48>>2]))));z2=m(m(m(m(k[b2+48>>2])*m(k[d2+4>>2]))+m(m(k[b2+52>>2])*m(k[d2+20>>2])))+m(m(m(k[b2+56>>2])*m(k[d2+36>>2]))+m(m(k[b2+60>>2])*m(k[d2+52>>2]))));a3=m(m(m(m(k[b2+48>>2])*m(k[d2+8>>2]))+m(m(k[b2+52>>2])*m(k[d2+24>>2])))+m(m(m(k[b2+56>>2])*m(k[d2+40>>2]))+m(m(k[b2+60>>2])*m(k[d2+56>>2]))));b3=m(m(m(m(k[b2+48>>2])*m(k[d2+12>>2]))+m(m(k[b2+52>>2])*m(k[d2+28>>2])))+m(m(m(k[b2+56>>2])*m(k[d2+44>>2]))+m(m(k[b2+60>>2])*m(k[d2+60>>2]))));k[d2+0>>2]=m2;k[d2+4>>2]=n2;k[d2+8>>2]=o2;k[d2+12>>2]=p2;k[d2+16>>2]=q2;k[d2+20>>2]=r2;k[d2+24>>2]=s2;k[d2+28>>2]=t2;k[d2+32>>2]=u2;k[d2+36>>2]=v2;k[d2+40>>2]=w2;k[d2+44>>2]=x2;k[d2+48>>2]=y2;k[d2+52>>2]=z2;k[d2+56>>2]=a3;k[d2+60>>2]=b3;}function d1(d2,b2){d2=d2|0;b2=b2|0;var c3=m(0.0),d3=m(0.0),e3=m(0.0),f3=m(0.0),g3=m(0.0),h3=m(0.0),i3=m(0.0),j3=m(0.0),k3=m(0.0),l3=m(0.0),m3=m(0.0),n3=m(0.0),o3=m(0.0),p3=m(0.0),q3=m(0.0),r3=m(0.0);d2=d2<<6;b2=b2<<6;c3=m(m(m(m(k[d2+0>>2])*m(k[b2+0>>2]))+m(m(k[d2+4>>2])*m(k[b2+16>>2])))+m(m(m(k[d2+8>>2])*m(k[b2+32>>2]))+m(m(k[d2+12>>2])*m(k[b2+48>>2]))));d3=m(m(m(m(k[d2+0>>2])*m(k[b2+4>>2]))+m(m(k[d2+4>>2])*m(k[b2+20>>2])))+m(m(m(k[d2+8>>2])*m(k[b2+36>>2]))+m(m(k[d2+12>>2])*m(k[b2+52>>2]))));e3=m(m(m(m(k[d2+0>>2])*m(k[b2+8>>2]))+m(m(k[d2+4>>2])*m(k[b2+24>>2])))+m(m(m(k[d2+8>>2])*m(k[b2+40>>2]))+m(m(k[d2+12>>2])*m(k[b2+56>>2]))));f3=m(m(m(m(k[d2+0>>2])*m(k[b2+12>>2]))+m(m(k[d2+4>>2])*m(k[b2+28>>2])))+m(m(m(k[d2+8>>2])*m(k[b2+44>>2]))+m(m(k[d2+12>>2])*m(k[b2+60>>2]))));g3=m(m(m(m(k[d2+16>>2])*m(k[b2+0>>2]))+m(m(k[d2+20>>2])*m(k[b2+16>>2])))+m(m(m(k[d2+24>>2])*m(k[b2+32>>2]))+m(m(k[d2+28>>2])*m(k[b2+48>>2]))));h3=m(m(m(m(k[d2+16>>2])*m(k[b2+4>>2]))+m(m(k[d2+20>>2])*m(k[b2+20>>2])))+m(m(m(k[d2+24>>2])*m(k[b2+36>>2]))+m(m(k[d2+28>>2])*m(k[b2+52>>2]))));i3=m(m(m(m(k[d2+16>>2])*m(k[b2+8>>2]))+m(m(k[d2+20>>2])*m(k[b2+24>>2])))+m(m(m(k[d2+24>>2])*m(k[b2+40>>2]))+m(m(k[d2+28>>2])*m(k[b2+56>>2]))));j3=m(m(m(m(k[d2+16>>2])*m(k[b2+12>>2]))+m(m(k[d2+20>>2])*m(k[b2+28>>2])))+m(m(m(k[d2+24>>2])*m(k[b2+44>>2]))+m(m(k[d2+28>>2])*m(k[b2+60>>2]))));k3=m(m(m(m(k[d2+32>>2])*m(k[b2+0>>2]))+m(m(k[d2+36>>2])*m(k[b2+16>>2])))+m(m(m(k[d2+40>>2])*m(k[b2+32>>2]))+m(m(k[d2+44>>2])*m(k[b2+48>>2]))));l3=m(m(m(m(k[d2+32>>2])*m(k[b2+4>>2]))+m(m(k[d2+36>>2])*m(k[b2+20>>2])))+m(m(m(k[d2+40>>2])*m(k[b2+36>>2]))+m(m(k[d2+44>>2])*m(k[b2+52>>2]))));m3=m(m(m(m(k[d2+32>>2])*m(k[b2+8>>2]))+m(m(k[d2+36>>2])*m(k[b2+24>>2])))+m(m(m(k[d2+40>>2])*m(k[b2+40>>2]))+m(m(k[d2+44>>2])*m(k[b2+56>>2]))));n3=m(m(m(m(k[d2+32>>2])*m(k[b2+12>>2]))+m(m(k[d2+36>>2])*m(k[b2+28>>2])))+m(m(m(k[d2+40>>2])*m(k[b2+44>>2]))+m(m(k[d2+44>>2])*m(k[b2+60>>2]))));o3=m(m(m(m(k[d2+48>>2])*m(k[b2+0>>2]))+m(m(k[d2+52>>2])*m(k[b2+16>>2])))+m(m(m(k[d2+56>>2])*m(k[b2+32>>2]))+m(m(k[d2+60>>2])*m(k[b2+48>>2]))));p3=m(m(m(m(k[d2+48>>2])*m(k[b2+4>>2]))+m(m(k[d2+52>>2])*m(k[b2+20>>2])))+m(m(m(k[d2+56>>2])*m(k[b2+36>>2]))+m(m(k[d2+60>>2])*m(k[b2+52>>2]))));q3=m(m(m(m(k[d2+48>>2])*m(k[b2+8>>2]))+m(m(k[d2+52>>2])*m(k[b2+24>>2])))+m(m(m(k[d2+56>>2])*m(k[b2+40>>2]))+m(m(k[d2+60>>2])*m(k[b2+56>>2]))));r3=m(m(m(m(k[d2+48>>2])*m(k[b2+12>>2]))+m(m(k[d2+52>>2])*m(k[b2+28>>2])))+m(m(m(k[d2+56>>2])*m(k[b2+44>>2]))+m(m(k[d2+60>>2])*m(k[b2+60>>2]))));k[d2+0>>2]=c3;k[d2+4>>2]=d3;k[d2+8>>2]=e3;k[d2+12>>2]=f3;k[d2+16>>2]=g3;k[d2+20>>2]=h3;k[d2+24>>2]=i3;k[d2+28>>2]=j3;k[d2+32>>2]=k3;k[d2+36>>2]=l3;k[d2+40>>2]=m3;k[d2+44>>2]=n3;k[d2+48>>2]=o3;k[d2+52>>2]=p3;k[d2+56>>2]=q3;k[d2+60>>2]=r3;}function g1(f2,g2,h2,i2){f2=f2|0;g2= +g2;h2= +h2;i2= +i2;var s3=0.0,t3=0.0,u3=0.0,v3=0.0;f2=f2<<6;s3=((g2*  +k[f2+0>>2]+h2*  +k[f2+16>>2])+i2*  +k[f2+32>>2])+  +k[f2+48>>2];t3=((g2*  +k[f2+4>>2]+h2*  +k[f2+20>>2])+i2*  +k[f2+36>>2])+  +k[f2+52>>2];u3=((g2*  +k[f2+8>>2]+h2*  +k[f2+24>>2])+i2*  +k[f2+40>>2])+  +k[f2+56>>2];v3=((g2*  +k[f2+12>>2]+h2*  +k[f2+28>>2])+i2*  +k[f2+44>>2])+  +k[f2+60>>2];k[f2+48>>2]=m(s3);k[f2+52>>2]=m(t3);k[f2+56>>2]=m(u3);k[f2+60>>2]=m(v3);}function l1(f2,g2,h2,i2){f2=f2|0;g2= +g2;h2= +h2;i2= +i2;f2=f2<<6;k[f2+0>>2]=m(g2*  +k[f2+0>>2]);k[f2+4>>2]=m(g2*  +k[f2+4>>2]);k[f2+8>>2]=m(g2*  +k[f2+8>>2]);k[f2+12>>2]=m(g2*  +k[f2+12>>2]);k[f2+16>>2]=m(h2*  +k[f2+16>>2]);k[f2+20>>2]=m(h2*  +k[f2+20>>2]);k[f2+24>>2]=m(h2*  +k[f2+24>>2]);k[f2+28>>2]=m(h2*  +k[f2+28>>2]);k[f2+32>>2]=m(i2*  +k[f2+32>>2]);k[f2+36>>2]=m(i2*  +k[f2+36>>2]);k[f2+40>>2]=m(i2*  +k[f2+40>>2]);k[f2+44>>2]=m(i2*  +k[f2+44>>2]);}function q1(d2,s1,g2,h2,i2){d2=d2|0;s1= +s1;g2= +g2;h2= +h2;i2= +i2;var w3=0.0,x3=0.0,y3=0.0,z3=0.0,a4=0.0,b4=0.0,c4=0.0;d2=d2<<6;x3=g2*g2;y3=h2*h2;z3=i2*i2;w3=r((x3+y3)+z3);a4=p(s1);b4=o(s1);c4=1.0-a4;g2=g2/w3;h2=h2/w3;i2=i2/w3;k[d2+0>>2]=m(a4+x3*c4);k[d2+4>>2]=m((g2*h2)*c4+i2*b4);k[d2+8>>2]=m((g2*i2)*c4-h2*b4);k[d2+12>>2]=m(0.0);k[d2+16>>2]=m((g2*h2)*c4-i2*b4);k[d2+20>>2]=m(a4+y3*c4);k[d2+24>>2]=m((h2*i2)*c4+g2*b4);k[d2+28>>2]=m(0.0);k[d2+32>>2]=m((g2*i2)*c4+h2*b4);k[d2+36>>2]=m((h2*i2)*c4-g2*b4);k[d2+40>>2]=m(a4+z3*c4);k[d2+44>>2]=m(0.0);k[d2+48>>2]=m(0.0);k[d2+52>>2]=m(0.0);k[d2+56>>2]=m(0.0);k[d2+60>>2]=m(1.0);}function w1(d2,b2){d2=d2|0;b2=b2|0;var d4=0;d2=d2<<6;b2=b2<<6;for(;(d4|0)<64;d4=(d4|0)+4|0)k[d2+d4>>2]=m(k[b2+d4>>2]);}function z1(d2,b2){d2=d2|0;b2=b2|0;var e4=0.0,f4=0.0;var g4=0.0,h4=0.0,i4=0.0,j4=0.0,k4=0.0,l4=0.0;var m4=0.0,n4=0.0,o4=0.0,p4=0.0,q4=0.0,r4=0.0;d2=d2<<6;b2=b2<<6;if( +k[b2+12>>2]==0.0)if( +k[b2+28>>2]==0.0)if( +k[b2+44>>2]==0.0){g4= +k[b2+20>>2]*  +k[b2+40>>2]- +k[b2+36>>2]*  +k[b2+24>>2];h4= +k[b2+36>>2]*  +k[b2+8>>2]- +k[b2+4>>2]*  +k[b2+40>>2];i4= +k[b2+4>>2]*  +k[b2+24>>2]- +k[b2+20>>2]*  +k[b2+8>>2];f4=(g4*  +k[b2+0>>2]+h4*  +k[b2+16>>2])+i4*  +k[b2+32>>2];if(-2.38e-7<=f4&&f4<=2.38e-7)return 0;e4= +1/f4;k[d2+0>>2]=m(g4*e4);k[d2+4>>2]=m(h4*e4);k[d2+8>>2]=m(i4*e4);k[d2+16>>2]=m(( +k[b2+32>>2]*  +k[b2+24>>2]- +k[b2+16>>2]*  +k[b2+40>>2])*e4);k[d2+20>>2]=m(( +k[b2+0>>2]*  +k[b2+40>>2]- +k[b2+32>>2]*  +k[b2+8>>2])*e4);k[d2+24>>2]=m(( +k[b2+16>>2]*  +k[b2+8>>2]- +k[b2+0>>2]*  +k[b2+24>>2])*e4);k[d2+32>>2]=m(( +k[b2+16>>2]*  +k[b2+36>>2]- +k[b2+32>>2]*  +k[b2+20>>2])*e4);k[d2+36>>2]=m(( +k[b2+32>>2]*  +k[b2+4>>2]- +k[b2+0>>2]*  +k[b2+36>>2])*e4);k[d2+40>>2]=m(( +k[b2+0>>2]*  +k[b2+20>>2]- +k[b2+16>>2]*  +k[b2+4>>2])*e4);k[d2+48>>2]=m(-(( +k[d2+0>>2]*  +k[b2+48>>2]+ +k[d2+16>>2]*  +k[b2+52>>2])+ +k[d2+32>>2]*  +k[b2+56>>2]));k[d2+52>>2]=m(-(( +k[d2+4>>2]*  +k[b2+48>>2]+ +k[d2+20>>2]*  +k[b2+52>>2])+ +k[d2+36>>2]*  +k[b2+56>>2]));k[d2+56>>2]=m(-(( +k[d2+8>>2]*  +k[b2+48>>2]+ +k[d2+24>>2]*  +k[b2+52>>2])+ +k[d2+40>>2]*  +k[b2+56>>2]));k[d2+12>>2]=m(0.0);k[d2+28>>2]=m(0.0);k[d2+44>>2]=m(0.0);k[d2+60>>2]=m(1.0);return 1;}g4= +k[b2+0>>2]*  +k[b2+20>>2]- +k[b2+4>>2]*  +k[b2+16>>2];h4= +k[b2+0>>2]*  +k[b2+36>>2]- +k[b2+4>>2]*  +k[b2+32>>2];i4= +k[b2+0>>2]*  +k[b2+52>>2]- +k[b2+4>>2]*  +k[b2+48>>2];j4= +k[b2+16>>2]*  +k[b2+36>>2]- +k[b2+20>>2]*  +k[b2+32>>2];k4= +k[b2+16>>2]*  +k[b2+52>>2]- +k[b2+20>>2]*  +k[b2+48>>2];l4= +k[b2+32>>2]*  +k[b2+52>>2]- +k[b2+36>>2]*  +k[b2+48>>2];r4= +k[b2+40>>2]*  +k[b2+60>>2]- +k[b2+44>>2]*  +k[b2+56>>2];q4= +k[b2+24>>2]*  +k[b2+60>>2]- +k[b2+28>>2]*  +k[b2+56>>2];p4= +k[b2+24>>2]*  +k[b2+44>>2]- +k[b2+28>>2]*  +k[b2+40>>2];o4= +k[b2+8>>2]*  +k[b2+60>>2]- +k[b2+12>>2]*  +k[b2+56>>2];n4= +k[b2+8>>2]*  +k[b2+44>>2]- +k[b2+12>>2]*  +k[b2+40>>2];m4= +k[b2+8>>2]*  +k[b2+28>>2]- +k[b2+12>>2]*  +k[b2+24>>2];f4=((((g4*r4-h4*q4)+i4*p4)+j4*o4)-k4*n4)+l4*m4;if(-2.38e-7<=f4&&f4<=2.38e-7)return 0;e4= +1/f4;k[d2+0>>2]=(( +k[b2+20>>2]*r4- +k[b2+36>>2]*q4)+ +k[b2+52>>2]*p4)*e4;k[d2+16>>2]=((- +k[b2+16>>2]*r4+ +k[b2+32>>2]*q4)- +k[b2+48>>2]*p4)*e4;k[d2+32>>2]=(( +k[b2+28>>2]*l4- +k[b2+44>>2]*k4)+ +k[b2+60>>2]*j4)*e4;k[d2+48>>2]=((- +k[b2+24>>2]*l4+ +k[b2+40>>2]*k4)- +k[b2+56>>2]*j4)*e4;k[d2+4>>2]=((- +k[b2+4>>2]*r4+ +k[b2+36>>2]*o4)- +k[b2+52>>2]*n4)*e4;k[d2+20>>2]=(( +k[b2+0>>2]*r4- +k[b2+32>>2]*o4)+ +k[b2+48>>2]*n4)*e4;k[d2+36>>2]=((- +k[b2+12>>2]*l4+ +k[b2+44>>2]*i4)- +k[b2+60>>2]*h4)*e4;k[d2+52>>2]=(( +k[b2+8>>2]*l4- +k[b2+40>>2]*i4)+ +k[b2+56>>2]*h4)*e4;k[d2+8>>2]=(( +k[b2+4>>2]*q4- +k[b2+20>>2]*o4)+ +k[b2+52>>2]*m4)*e4;k[d2+24>>2]=((- +k[b2+0>>2]*q4+ +k[b2+16>>2]*o4)- +k[b2+48>>2]*m4)*e4;k[d2+40>>2]=(( +k[b2+12>>2]*k4- +k[b2+28>>2]*i4)+ +k[b2+60>>2]*g4)*e4;k[d2+56>>2]=((- +k[b2+8>>2]*k4+ +k[b2+24>>2]*i4)- +k[b2+56>>2]*g4)*e4;k[d2+12>>2]=((- +k[b2+4>>2]*p4+ +k[b2+20>>2]*n4)- +k[b2+36>>2]*m4)*e4;k[d2+28>>2]=(( +k[b2+0>>2]*p4- +k[b2+16>>2]*n4)+ +k[b2+32>>2]*m4)*e4;k[d2+44>>2]=((- +k[b2+12>>2]*j4+ +k[b2+28>>2]*h4)- +k[b2+44>>2]*g4)*e4;k[d2+60>>2]=(( +k[b2+8>>2]*j4- +k[b2+24>>2]*h4)+ +k[b2+40>>2]*g4)*e4;return 1;}function c2(d2){d2=d2|0;var s4=m(0.0);d2=d2<<6;s4=m(k[d2+4>>2]);k[d2+4>>2]=m(k[d2+16>>2]);k[d2+16>>2]=m(s4);s4=m(k[d2+8>>2]);k[d2+8>>2]=m(k[d2+32>>2]);k[d2+32>>2]=m(s4);s4=m(k[d2+12>>2]);k[d2+12>>2]=m(k[d2+48>>2]);k[d2+48>>2]=m(s4);s4=m(k[d2+24>>2]);k[d2+24>>2]=m(k[d2+36>>2]);k[d2+36>>2]=m(s4);s4=m(k[d2+28>>2]);k[d2+28>>2]=m(k[d2+52>>2]);k[d2+52>>2]=m(s4);s4=m(k[d2+44>>2]);k[d2+44>>2]=m(k[d2+56>>2]);k[d2+56>>2]=m(s4);}function e2(f2,g2,h2,i2,j2){f2=f2|0;g2= +g2;h2= +h2;i2= +i2;j2= +j2;var t4=0.0,u4=0.0,v4=0.0,w4=0.0;f2=f2<<6;t4=((g2*  +k[f2+0>>2]+h2*  +k[f2+16>>2])+i2*  +k[f2+32>>2])+j2*  +k[f2+48>>2];u4=((g2*  +k[f2+4>>2]+h2*  +k[f2+20>>2])+i2*  +k[f2+36>>2])+j2*  +k[f2+52>>2];v4=((g2*  +k[f2+8>>2]+h2*  +k[f2+24>>2])+i2*  +k[f2+40>>2])+j2*  +k[f2+56>>2];w4=((g2*  +k[f2+12>>2]+h2*  +k[f2+28>>2])+i2*  +k[f2+44>>2])+j2*  +k[f2+60>>2];k[0>>2]=m(t4);k[4>>2]=m(u4);k[8>>2]=m(v4);k[12>>2]=m(w4);}return {identity:s,perspective:u,rotation:q1,translate:g1,scale:l1,lmul:d1,rmul:a1,copy:w1,invert:z1,transpose:c2,transform:e2};}function e(){var x4=65536;var y4=new ArrayBuffer(x4);var z4=new Float32Array(y4,0,x4>>4);var a5=new a(window,null,y4);var b5=1;a5.identity(1);this.identity=function(){a5.identity(b5);};this.perspective=function(fieldOfView,aspectRatio,near,far){a5.perspective(b5,((2*Math.PI)*fieldOfView)/360.0,aspectRatio,near,far);};this.translate=function(g,y,z){a5.translate(b5,g,y,z);};this.scale=function(g,y,z){a5.scale(b5,g,y,z);};this.rotate=function(deg,vector){a5.rotation(0,((2*Math.PI)*deg)/360.0,vector[0],vector[1],vector[2]);a5.rmul(b5,0);};this.push=function(){if(b5+1==x4>>6)throw {error:'too many matrices on stack'};a5.copy(b5+1,b5);b5++;};this.pop=function(){if(b5<2)throw {error:'nothing to pop'};b5--;};this.swap=function(){if(b5<2)throw {error:'nothing to swap'};a5.copy(0,b5);a5.copy(b5,b5-1);a5.copy(b5-1,0);};this.mul=function(){if(b5<2)throw {error:'too few matrices on stack to multiply'};a5.rmul(b5-1,b5);b5--;};this.lmul=function(){if(b5<2)throw {error:'too few matrices on stack to multiply'};a5.lmul(b5-1,b5);b5--;};this.det=function(){var c5=b5<<4;var d5=z4[c5+5]*z4[c5+10]-z4[c5+9]*z4[c5+6];var e5=z4[c5+1]*z4[c5+10]-z4[c5+2]*z4[c5+9];var f5=z4[c5+1]*z4[c5+6]-z4[c5+5]*z4[c5+2];return (d5*z4[c5+0]-e5*z4[c5+4])+f5*z4[c5+8];};this.transform=function(g,y,z,w){if((y==undefined&&z==undefined)&&w==undefined){var g5=1;if(g.length==4)g5=g[3];a5.transform(b5,g[0],g[1],g[2],g5);if(g.length==4)return [z4[0],z4[1],z4[2],z4[3]];return [z4[0]/z4[3],z4[1]/z4[3],z4[2]/z4[3]];} else {if(w!=undefined){a5.transform(b5,g,y,z,w);return [z4[0],z4[1],z4[2],z4[3]];} else {a5.transform(b5,g,y,z,1);return [z4[0]/z4[3],z4[1]/z4[3],z4[2]/z4[3]];}}return [z4[0],z4[1],z4[2]];};this.invert=function(){if(!a5.invert(0,b5))return false;a5.copy(b5,0);return true;};this.transpose=function(){a5.transpose(b5);};this.qrDecompose=function(){this.push();var h5=b5<<4;a5.identity(b5-1);var s5=z4[(h5+4*0)+0],t5=z4[(h5+4*0)+1],u5=z4[(h5+4*0)+2],v5=z4[(h5+4*0)+3];var w5=Math.sqrt(((s5*s5+t5*t5)+u5*u5)+v5*v5);if(w5>0){var x5=[s5,t5,u5,v5];if(s5>=0)x5[0]+=w5; else x5[0]-=w5;x5[1]/=x5[0];x5[2]/=x5[0];x5[3]/=x5[0];x5[0]=1;var y5=2/(((1+x5[1]*x5[1])+x5[2]*x5[2])+x5[3]*x5[3]);this.loadRowMajor([[1-(y5*x5[0])*x5[0],(-y5*x5[0])*x5[1],(-y5*x5[0])*x5[2],(-y5*x5[0])*x5[3]],[(-y5*x5[1])*x5[0],1-(y5*x5[1])*x5[1],(-y5*x5[1])*x5[2],(-y5*x5[1])*x5[3]],[(-y5*x5[2])*x5[0],(-y5*x5[2])*x5[1],1-(y5*x5[2])*x5[2],(-y5*x5[2])*x5[3]],[(-y5*x5[3])*x5[0],(-y5*x5[3])*x5[1],(-y5*x5[3])*x5[2],1-(y5*x5[3])*x5[3]]],b5);a5.lmul(b5,0);a5.rmul(b5-1,0);}var s5=0,t5=z4[(h5+4*1)+1],u5=z4[(h5+4*1)+2],v5=z4[(h5+4*1)+3];var w5=Math.sqrt((t5*t5+u5*u5)+v5*v5);if(w5>0){var z5=[0,t5,u5,v5];if(t5>=0)z5[1]+=w5; else z5[1]-=w5;z5[2]/=z5[1];z5[3]/=z5[1];z5[1]=1;var a6=2/(((0+1)+z5[2]*z5[2])+z5[3]*z5[3]);this.loadRowMajor([[1,0,0,0],[0,1-(a6*z5[1])*z5[1],(-a6*z5[1])*z5[2],(-a6*z5[1])*z5[3]],[0,(-a6*z5[2])*z5[1],1-(a6*z5[2])*z5[2],(-a6*z5[2])*z5[3]],[0,(-a6*z5[3])*z5[1],(-a6*z5[3])*z5[2],1-(a6*z5[3])*z5[3]]],b5);a5.lmul(b5,0);a5.rmul(b5-1,0);}var s5=0,t5=0,u5=z4[(h5+4*2)+2],v5=z4[(h5+4*2)+3];var w5=Math.sqrt(u5*u5+v5*v5);if(w5>0){var b6=[0,0,u5,v5];if(u5>=0)b6[2]+=w5; else b6[2]-=w5;b6[3]/=b6[2];b6[2]=1;var c6=2/(((0+0)+1)+b6[3]*b6[3]);this.loadRowMajor([[1,0,0,0],[0,1,0,0],[0,0,1-(c6*b6[2])*b6[2],(-c6*b6[2])*b6[3]],[0,0,(-c6*b6[3])*b6[2],1-(c6*b6[3])*b6[3]]],b5);a5.lmul(b5,0);a5.rmul(b5-1,0);}this.loadRowMajor([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,-1]],b5);a5.lmul(b5,0);a5.rmul(b5-1,0);};this.getBasisAndNullSpace=function(){this.push();this.transpose();this.qrDecompose();this.pop();var d6=this.getColMajor();this.pop();var e6=[];var f6=[];for(var g6=0;g6<d6.length;++g6){var h6=d6[g6];var i6=this.transform(h6[0],h6[1],h6[2],h6[3]);var j6=((i6[0]*i6[0]+i6[1]*i6[1])+i6[2]*i6[2])+i6[3]*i6[3];if(j6<2.38e-7)f6.push(h6); else e6.push(h6);}return {basis:e6,nulls:f6};};this.loadRowMajor=function(i,stackIndex){var k6=b5-(stackIndex|0)<<4;if(i instanceof e)i=i.getRowMajor();if(typeof i[0]=='undefined')i=arguments;if(typeof i[0][0]!='undefined'){z4[k6+0]=i[0][0];z4[k6+4]=i[0][1];z4[k6+8]=i[0][2];z4[k6+12]=i[0][3];z4[k6+1]=i[1][0];z4[k6+5]=i[1][1];z4[k6+9]=i[1][2];z4[k6+13]=i[1][3];z4[k6+2]=i[2][0];z4[k6+6]=i[2][1];z4[k6+10]=i[2][2];z4[k6+14]=i[2][3];z4[k6+3]=i[3][0];z4[k6+7]=i[3][1];z4[k6+11]=i[3][2];z4[k6+15]=i[3][3];} else {z4[k6+0]=i[0];z4[k6+4]=i[1];z4[k6+8]=i[2];z4[k6+12]=i[3];z4[k6+1]=i[4];z4[k6+5]=i[5];z4[k6+9]=i[6];z4[k6+13]=i[7];z4[k6+2]=i[8];z4[k6+6]=i[9];z4[k6+10]=i[10];z4[k6+14]=i[11];z4[k6+3]=i[12];z4[k6+7]=i[13];z4[k6+11]=i[14];z4[k6+15]=i[15];}};this.load=this.loadColMajor=function(i,stackIndex){var l6=b5-(stackIndex|0)<<4;if(i instanceof e)i=i.getData();if(typeof i[0]=='undefined')i=arguments;if(typeof i[0][0]!='undefined'){z4[l6+0]=i[0][0];z4[l6+4]=i[1][0];z4[l6+8]=i[2][0];z4[l6+12]=i[3][0];z4[l6+1]=i[0][1];z4[l6+5]=i[1][1];z4[l6+9]=i[2][1];z4[l6+13]=i[3][1];z4[l6+2]=i[0][2];z4[l6+6]=i[1][2];z4[l6+10]=i[2][2];z4[l6+14]=i[3][2];z4[l6+3]=i[0][3];z4[l6+7]=i[1][3];z4[l6+11]=i[2][3];z4[l6+15]=i[3][3];} else {z4[l6+0]=i[0];z4[l6+4]=i[4];z4[l6+8]=i[8];z4[l6+12]=i[12];z4[l6+1]=i[1];z4[l6+5]=i[5];z4[l6+9]=i[9];z4[l6+13]=i[13];z4[l6+2]=i[2];z4[l6+6]=i[6];z4[l6+10]=i[10];z4[l6+14]=i[14];z4[l6+3]=i[3];z4[l6+7]=i[7];z4[l6+11]=i[11];z4[l6+15]=i[15];}};this.getData=function(stackIndex){stackIndex=stackIndex|0;return new Float32Array(y4,b5-stackIndex<<6,64>>2);};this.getRowMajor=function(stackIndex){var m6=b5-(stackIndex|0)<<4;return [[z4[m6+0],z4[m6+4],z4[m6+8],z4[m6+12]],[z4[m6+1],z4[m6+5],z4[m6+9],z4[m6+13]],[z4[m6+2],z4[m6+6],z4[m6+10],z4[m6+14]],[z4[m6+3],z4[m6+7],z4[m6+11],z4[m6+15]]];};this.getColMajor=function(stackIndex){var n6=b5-(stackIndex|0)<<4;return [[z4[n6+0],z4[n6+1],z4[n6+2],z4[n6+3]],[z4[n6+4],z4[n6+5],z4[n6+6],z4[n6+7]],[z4[n6+8],z4[n6+9],z4[n6+10],z4[n6+11]],[z4[n6+12],z4[n6+13],z4[n6+14],z4[n6+15]]];};Object.defineProperty(this,'length',{get:function(){return b5;}});}function f(g){var o6=g.toFixed(2);if(g>0)return ' '+o6;return o6;}function h(i,j){console.log(Array.from(i.getData(j)).map(f).join(', '));}e.debugDumpMatrix=h;if(typeof window!='undefined'&&typeof window.Math.fround=='undefined')window.Math.fround=function(g){return g;};if(typeof window!='undefined'&&typeof window.Math.imul=='undefined')window.Math.imul=function(g,y){return g*y;};return e;})();renderjs.MatrixStack=MatrixStack;var Bezier=(function(){var p6=400;var q6=function(duration){return 1.0/(200.0*duration);};var r6=function(p1x,p1y,p2x,p2y){var s6=3.0*p1x;var t6=3.0*(p2x-p1x)-s6;var u6=(1.0-s6)-t6;var v6=3.0*p1y;var w6=3.0*(p2y-p1y)-v6;var x6=(1.0-v6)-w6;var y6=function(t){return ((u6*t+t6)*t+s6)*t;};var z6=function(t){return ((x6*t+w6)*t+v6)*t;};var a7=function(t){return ((3.0*u6)*t+2.0*t6)*t+s6;};var b7=function(x,epsilon){var d7;var e7;var f7;var g7;var h7;var i7;for(f7=x,i7=0;i7<8;i7++){g7=y6(f7)-x;if(Math.abs(g7)<epsilon){return f7;}h7=a7(f7);if(Math.abs(h7)<1e-6){break;}f7=f7-g7/h7;}d7=0.0;e7=1.0;f7=x;if(f7<d7){return d7;}if(f7>e7){return e7;}while(d7<e7){g7=y6(f7);if(Math.abs(g7-x)<epsilon){return f7;}if(x>g7){d7=f7;} else {e7=f7;}f7=(e7-d7)*0.5+d7;}return f7;};var c7=function(x,epsilon){return z6(b7(x,epsilon));};return function(x,duration){return c7(x,q6( +duration||p6));};};return {linear:r6(0.0,0.0,1.0,1.0),ease:r6(0.25,0.1,0.25,1.0),easeIn:r6(0.42,0,1.0,1.0),easeOut:r6(0,0,0.58,1.0),easeInOut:r6(0.42,0,0.58,1.0),cubicBezier:function(p1x,p1y,p2x,p2y,x,duration){return r6(p1x,p1y,p2x,p2y)(x,duration);}};})();renderjs.Bezier=Bezier;var Geometry=(function(){function j7(k7,l7,m7){if((k7!=undefined&&l7==undefined)&&m7==undefined){this.x=k7.x||k7[0];this.y=k7.y||k7[1];this.z=k7.z||k7[2];} else {this.x= +(k7||0);this.y= +(l7||0);this.z= +(m7||0);}}Object.defineProperty(j7.prototype,0,{get:function(){return this.x;},set:function(k7){this.x=k7;}});Object.defineProperty(j7.prototype,1,{get:function(){return this.y;},set:function(l7){this.y=l7;}});Object.defineProperty(j7.prototype,2,{get:function(){return this.z;},set:function(m7){this.z=m7;}});Object.defineProperty(j7.prototype,'length',{get:function(){return Math.sqrt((this.x*this.x+this.y*this.y)+this.z*this.z);},set:function(newLength){var c9=this.length;this.x*=newLength/c9;this.y*=newLength/c9;this.z*=newLength/c9;}});Object.defineProperty(j7.prototype,'direction',{get:function(){var d9=this.length;return new j7(this.x/d9,this.y/d9,this.z/d9);},set:function(newDirection){var e9=this.length;var f9=newDirection.length;this.x=(newDirection.x*e9)/f9;this.y=(newDirection.y*e9)/f9;this.z=(newDirection.z*e9)/f9;}});Object.defineProperty(j7.prototype,'reverse',{get:function(){return new j7(-this.x,-this.y,-this.z);}});j7.prototype.multiply=function(s){this.x*=s;this.y*=s;this.z*=s;return this;};j7.prototype.dot=function(other){return (this.x*other.x+this.y*other.y)+this.z*other.z;};j7.dot=function(v1,v2){return (v1.x*v2.x+v1.y*v2.y)+v1.z*v2.z;};j7.prototype.colinearWith=function(that){var g9=j7.dot(this,this);var h9=j7.dot(that,that);var i9=g9*h9;var j9=j7.dot(this,that);return j9*j9-i9<2.38e-7;};j7.prototype.add=function(other){this.x+=other.x;this.y+=other.y;this.z+=other.z;return this;};j7.add=function(v1,v2){return new j7(v1.x+v2.x,v1.y+v2.y,v1.z+v2.z);};j7.prototype.subtract=function(other){this.x-=other.x;this.y-=other.y;this.z-=other.z;return this;};j7.subtract=function(v1,v2){return new j7(v1.x-v2.x,v1.y-v2.y,v1.z-v2.z);};j7.prototype.cross=function(other){return new j7(this.y*other.z-this.z*other.y,this.z*other.x-this.x*other.y,this.x*other.y-this.y*other.x);};function n7(o7,p7){if(typeof o7!='undefined'&&(o7 instanceof n7 || o7.length==2)){this.re=o7[0];this.im=o7[1];} else {this.re= +(o7||0);this.im= +(p7||0);}}Object.defineProperty(n7.prototype,'0',{get:function(){return this.re;}});Object.defineProperty(n7.prototype,'1',{get:function(){return this.im;}});n7.add=function(a,b){if(a instanceof n7){if(b instanceof n7)return new n7(a.re+b.re,a.im+b.im); else return new n7(a.re+b,a.im);} else {if(b instanceof n7)return new n7(a+b.re,b.im); else return new n7(a+b,0);}};n7.sub=function(a,b){if(a instanceof n7){if(b instanceof n7)return new n7(a.re-b.re,a.im-b.im); else return new n7(a.re-b,a.im);} else {if(b instanceof n7)return new n7(a-b.re,b.im); else return new n7(a-b,0);}};n7.mul=function(a,b){if(a instanceof n7){if(b instanceof n7)return new n7(a.re*b.re-a.im*b.im,a.re*b.im+a.im*b.re); else return new n7(a.re*b,a.im*b);} else {if(b instanceof n7)return new n7(a*b.re,a*b.im); else return new n7(a*b,0);}};n7.div=function(a,b){if(a instanceof n7){if(b instanceof n7){var k9=1.0/(b.re*b.re+b.im*b.im);return new n7((a.re*b.re+a.im*b.im)*k9,(a.im*b.re-a.re*b.im)*k9);} else {return new n7(a.re/b,a.im/b);}} else {if(b instanceof n7){var l9=1.0/(b.re*b.re+b.im*b.im);return new n7((a*b.re)*l9,(-a*b.im)*l9);} else {return new n7(a/b,0);}}};function q7(){var m9=arguments[0]<0?-1:arguments[0]==0?0:1;for(var n9=1;n9<arguments.length;++n9)if((arguments[n9]<0?-1:arguments[n9]==0?0:1)!=m9)return false;return true;}var r7={Polar:{project:function(k7,l7,m7){if(l7==undefined&&m7==undefined){l7=k7[1];m7=k7[2];k7=k7[0];}var o9=Math.sqrt((k7*k7+l7*l7)+m7*m7);var p9=Math.acos(l7/o9)/Math.PI;var q9=Math.atan2(k7,m7)/(2*Math.PI)+0.5;return [q9,p9];},getTextureCoordinates:function(v1,v2,v3){var r9=[r7.Polar.project(v1),r7.Polar.project(v2),r7.Polar.project(v3)];if(((v1[2]<0||v2[2]<0)||v3[2]<0)&&!q7(v1[0],v2[0],v3[0])){if(v1[0]<0)r9[0][0]+=1;if(v2[0]<0)r9[1][0]+=1;if(v3[0]<0)r9[2][0]+=1;}if(v1[1]==1||v1[1]== -1){r9[0][0]=(r9[1][0]+r9[2][0])/2;r9[0][1]=v1[1]==1?0:1;} else if(v2[1]==1||v2[1]== -1){r9[1][0]=(r9[0][0]+r9[2][0])/2;r9[1][1]=v2[1]==1?0:1;} else if(v3[1]==1||v3[1]== -1){r9[2][0]=(r9[0][0]+r9[1][0])/2;r9[2][1]=v3[1]==1?0:1;}return r9;}},Mercator:{project:function(k7,l7,m7){if(l7==undefined&&m7==undefined){l7=k7[1];m7=k7[2];k7=k7[0];}var s9=Math.sqrt((k7*k7+l7*l7)+m7*m7);var t9,u9;t9=Math.asin(l7/s9);u9=Math.atan2(k7,m7);var v9=u9/(2*Math.PI)+0.5;var w9=0.5-Math.log(Math.tan((t9+Math.PI/2)/2))/(2*Math.PI);return [v9,w9];},getTextureCoordinates:function(v1,v2,v3){var x9=[r7.Mercator.project(v1),r7.Mercator.project(v2),r7.Mercator.project(v3)];if(((v1[2]<0||v2[2]<0)||v3[2]<0)&&!q7(v1[0],v2[0],v3[0])){if(v1[0]<0)x9[0][0]+=1;if(v2[0]<0)x9[1][0]+=1;if(v3[0]<0)x9[2][0]+=1;}if(v1[1]==1||v1[1]== -1){x9[0][0]=(x9[1][0]+x9[2][0])/2;x9[0][1]=v1[1]==1?0:1;} else if(v2[1]==1||v2[1]== -1){x9[1][0]=(x9[0][0]+x9[2][0])/2;x9[1][1]=v2[1]==1?0:1;} else if(v3[1]==1||v3[1]== -1){x9[2][0]=(x9[0][0]+x9[1][0])/2;x9[2][1]=v3[1]==1?0:1;}return x9;}},HammerAitoff:{project:function(k7,l7,m7,outer){if(l7==undefined&&m7==undefined){l7=k7[1];m7=k7[2];k7=k7[0];}var y9=Math.sqrt((k7*k7+l7*l7)+m7*m7);var z9,a10;z9=Math.asin(l7/y9);a10=Math.atan2(k7,m7);if(outer&&a10<0){a10=a10+2*Math.PI;}var b10=Math.sqrt(1+Math.cos(z9)*Math.cos(a10/2));var c10=(Math.cos(z9)*Math.sin(a10/2))/b10;var d10=Math.sin(z9)/b10;return [(c10+1)/2,(1-d10)/2];},getTextureCoordinates:function(v1,v2,v3){var e10=[r7.HammerAitoff.project(v1),r7.HammerAitoff.project(v2),r7.HammerAitoff.project(v3)];if(!q7(v1[0],v2[0],v3[0])){var i10=v1[0]*(v2[2]-v1[2])-v1[2]*(v2[0]-v1[0]);var j10=v2[0]*(v3[2]-v2[2])-v2[2]*(v3[0]-v2[0]);var k10=v3[0]*(v1[2]-v3[2])-v3[2]*(v1[0]-v3[0]);var l10=((((i10<0&&j10<0)&&k10<0||(i10>=0&&j10>=0)&&k10>=0)||v1[0]==0&&v1[2]==0)||v2[0]==0&&v2[2]==0)||v3[0]==0&&v3[2]==0;if(l10){} else if((v1[2]<0||v2[2]<0)||v3[2]<0){if(v1[0]==0){if(v2[0]<0)e10[1]=r7.HammerAitoff.project(v2[0],v2[1],v2[2],true);if(v3[0]<0)e10[2]=r7.HammerAitoff.project(v3[0],v3[1],v3[2],true);}if(v2[0]==0){if(v1[0]<0)e10[0]=r7.HammerAitoff.project(v1[0],v1[1],v1[2],true);if(v3[0]<0)e10[2]=r7.HammerAitoff.project(v3[0],v3[1],v3[2],true);}if(v3[0]==0){if(v1[0]<0)e10[0]=r7.HammerAitoff.project(v1[0],v1[1],v1[2],true);if(v2[0]<0)e10[1]=r7.HammerAitoff.project(v2[0],v2[1],v2[2],true);}}}var f10=Math.sqrt((e10[1][0]-e10[2][0])*(e10[1][0]-e10[2][0])+(e10[1][1]-e10[2][1])*(e10[1][1]-e10[2][1]));var g10=Math.sqrt((e10[0][0]-e10[2][0])*(e10[0][0]-e10[2][0])+(e10[0][1]-e10[2][1])*(e10[0][1]-e10[2][1]));var h10=Math.sqrt((e10[0][0]-e10[1][0])*(e10[0][0]-e10[1][0])+(e10[0][1]-e10[1][1])*(e10[0][1]-e10[1][1]));if((f10>0.5||g10>0.5)||h10>0.5){console.log((((f10+',')+g10)+',')+h10);}return e10;}}};function s7(z8){var m10=[];for(var o10=0;o10<z8.vertices.length;++o10)m10.push([]);for(var o10=0;o10<z8.faces.length;++o10){if(m10[z8.faces[o10][0]].indexOf(z8.faces[o10][1])<0)m10[z8.faces[o10][0]].push(z8.faces[o10][1]);if(m10[z8.faces[o10][1]].indexOf(z8.faces[o10][2])<0)m10[z8.faces[o10][1]].push(z8.faces[o10][2]);if(m10[z8.faces[o10][2]].indexOf(z8.faces[o10][0])<0)m10[z8.faces[o10][2]].push(z8.faces[o10][0]);if(m10[z8.faces[o10][1]].indexOf(z8.faces[o10][0])<0)m10[z8.faces[o10][1]].push(z8.faces[o10][0]);if(m10[z8.faces[o10][0]].indexOf(z8.faces[o10][2])<0)m10[z8.faces[o10][0]].push(z8.faces[o10][2]);if(m10[z8.faces[o10][2]].indexOf(z8.faces[o10][1])<0)m10[z8.faces[o10][2]].push(z8.faces[o10][1]);}return m10;}function u7(a9){var p10=0;var q10=0;var r10=0;for(var s10=0;s10<a9.length;++s10){p10=p10+a9[s10][0];q10=q10+a9[s10][1];r10=r10+a9[s10][2];}var t10=Math.sqrt((p10*p10+q10*q10)+r10*r10);if(t10==0)return [0,0,1];return [p10/t10,q10/t10,r10/t10];}function w7(z8){var u10=[];for(var x10=0;x10<z8.vertices.length;++x10)u10.push([]);for(var x10=0;x10<z8.faces.length;++x10){var y10=z8.vertices[z8.faces[x10][0]];var z10=z8.vertices[z8.faces[x10][1]];var a11=z8.vertices[z8.faces[x10][2]];var b11=z10[0]-y10[0],c11=z10[1]-y10[1],d11=z10[2]-y10[2];var e11=a11[0]-z10[0],f11=a11[1]-z10[1],g11=a11[2]-z10[2];var h11=c11*g11-d11*f11;var i11=d11*e11-b11*g11;var j11=b11*f11-c11*e11;var k11=Math.sqrt((h11*h11+i11*i11)+j11*j11);var l11=[h11/k11,i11/k11,j11/k11];u10[z8.faces[x10][0]].push(l11);u10[z8.faces[x10][1]].push(l11);u10[z8.faces[x10][2]].push(l11);}for(var x10=0;x10<u10.length;++x10){if(u10[x10].length==0)u10[x10]=[0,0,1]; else if(u10[x10].length==1)u10[x10]=u10[x10][0]; else u10[x10]=u7(u10[x10]);}return u10;}function y7(w8,p8,b8){var m11=(p8[0]*w8[0]+p8[1]*w8[1])+p8[2]*w8[2];var n11=Math.sqrt(b8[0]*b8[0]+b8[1]*b8[1]);var o11=[p8[0]/n11-w8[0]*m11,p8[1]/n11-w8[1]*m11,p8[2]/n11-w8[2]*m11];var p11=Math.atan2(b8[1],b8[0]);var q11=Math.cos(-p11);var r11=Math.sin(-p11);var s11=[-w8[0],-w8[1],-w8[2]];var t11=s11[0]*s11[1],u11=s11[0]*s11[2],v11=s11[1]*s11[2];var w11=new j7((o11[0]+((((o11[0]*s11[0])*s11[0]+o11[1]*t11)+o11[2]*u11)-o11[0])*(1-q11))+(o11[2]*s11[1]-o11[1]*s11[2])*r11,(o11[1]+((((o11[1]*s11[1])*s11[1]+o11[0]*t11)+o11[2]*v11)-o11[1])*(1-q11))+(o11[0]*s11[2]-o11[2]*s11[0])*r11,(o11[1]+((((o11[2]*s11[2])*s11[2]+o11[0]*u11)+o11[1]*v11)-o11[2])*(1-q11))+(o11[0]*s11[1]-o11[1]*s11[0])*r11);var x11=w8.cross(w11).multiply(b8[0]==0?b8[1]:Math.abs(b8[1]/b8[0]));return [w11,x11];}function c8(w8,e8,f8,g8,h8,i8,j8){var y11=f8*j8-i8*g8;if(y11==0){return y7(w8,e8,[f8,g8]);}y11=1/y11;var z11=[y11*(j8*e8[0]-g8*h8[0]),y11*(j8*e8[1]-g8*h8[1]),y11*(j8*e8[2]-g8*h8[2])];var a12=[y11*(f8*h8[0]-i8*e8[0]),y11*(f8*h8[1]-i8*e8[1]),y11*(f8*h8[2]-i8*e8[2])];return [z11,a12];}function k8(u8,r8){var b12=null;var c12=null;var d12=null;for(var e12=0;e12<r8.length;++e12){var f12=r8[e12][0]-u8[0];var g12=r8[e12][1]-u8[1];var h12=r8[e12][2]-u8[2];var i12=(f12*f12+g12*g12)+h12*h12;if(b12===null||i12<c12){b12=e12;c12=i12;d12=[f12,g12,h12];}}return {index:b12,vertex:r8[e12],dx:d12,lendXSq:c12};}function n8(o8,p8){var j12=null;var k12=null;var l12=0;for(var n12=0;n12<o8.length;++n12)l12+=o8[n12]*o8[n12];for(var n12=0;n12<p8.length;++n12){var o12=0;var p12=0;for(var q12=0;q12<o8.length;++q12){o12+=p8[n12][q12]*o8[q12];p12+=p8[n12][q12]*p8[n12][q12];}var r12=o12/Math.sqrt(p12*l12);if(j12===null||Math.abs(r12)<Math.abs(k12)){j12=n12;k12=r12;}}return {index:j12,dx:p8[j12],cosT:k12};}function q8(r8,s8,t8,u8,v8,w8,x8){if(t8.length<3)throw {error:'require at least 3 neighbours to use least-squares'};if(t8.length==3){var e13=new j7(r8[t8[0]]).subtract(u8);var f13=new j7(r8[t8[1]]).subtract(u8);var g13=new j7(r8[t8[2]]).subtract(u8);var h13=[s8[t8[0]][0]-v8[0],s8[t8[0]][1]-v8[1]];var i13=[s8[t8[1]][0]-v8[0],s8[t8[1]][1]-v8[1]];var j13=[s8[t8[2]][0]-v8[0],s8[t8[2]][1]-v8[1]];if(new j7(e13).add(f13).colinearWith(g13))return c8(w8,e13,h13[0],h13[1],f13,i13[0],i13[1]);if(new j7(f13).add(g13).colinearWith(e13))return c8(w8,f13,i13[0],i13[1],g13,j13[0],j13[1]);if(new j7(g13).add(e13).colinearWith(f13))return c8(w8,g13,j13[0],j13[1],e13,h13[0],h13[1]);}if(t8.length==4){var k13=new j7(r8[t8[0]]).subtract(u8);var l13=new j7(r8[t8[1]]).subtract(u8);var m13=new j7(r8[t8[2]]).subtract(u8);var n13=new j7(r8[t8[3]]).subtract(u8);var o13=[s8[t8[0]][0]-v8[0],s8[t8[0]][1]-v8[1]];var p13=[s8[t8[1]][0]-v8[0],s8[t8[1]][1]-v8[1]];var q13=[s8[t8[2]][0]-v8[0],s8[t8[2]][1]-v8[1]];var r13=[s8[t8[3]][0]-v8[0],s8[t8[3]][1]-v8[1]];if(k13.colinearWith(l13)&&m13.colinearWith(n13))return c8(w8,k13,o13[0],o13[1],m13,q13[0],q13[1]);if(k13.colinearWith(m13)&&l13.colinearWith(n13)||k13.colinearWith(n13)&&l13.colinearWith(m13))return c8(w8,k13,o13[0],o13[1],l13,p13[0],p13[1]);}var s12=x8||new MatrixStack();var t12=0,u12=0,v12=0,w12=0,x12=0,y12=0;var z12=[0,0,0],a13=[0,0,0];for(var b13=0;b13<t8.length;++b13){var s13=r8[t8[b13]];var t13=[s13[0]-u8[0],s13[1]-u8[1],s13[2]-u8[2]];var u13=1/Math.sqrt((t13[0]*t13[0]+t13[1]*t13[1])+t13[2]*t13[2]);t12+=(t13[0]*t13[0])*u13;u12+=(t13[1]*t13[1])*u13;v12+=(t13[2]*t13[2])*u13;w12+=(t13[0]*t13[1])*u13;x12+=(t13[0]*t13[2])*u13;y12+=(t13[1]*t13[2])*u13;var v13=s8[t8[b13]];z12[0]+=(v13[0]*t13[0])*u13;z12[1]+=(v13[0]*t13[1])*u13;z12[2]+=(v13[0]*t13[2])*u13;a13[0]+=(v13[1]*t13[0])*u13;a13[1]+=(v13[1]*t13[1])*u13;a13[2]+=(v13[1]*t13[2])*u13;}s12.loadRowMajor([[t12,w12,x12,0],[w12,u12,y12,0],[x12,y12,v12,0],[0,0,0,1]]);if(s12.invert()){z12=s12.transform(z12);a13=s12.transform(a13);} else {var w13=s12.getBasisAndNullSpace();if(w13.nulls.length==3){z12=[0,0,0];a13=[0,0,0];} else if(w13.nulls.length==2){var x13=k8(u8,t8.map(function(i){return r8[i];}));var y13=[s8[t8[x13.index]][0]-v8[0],s8[t8[x13.index]][1]-v8[1]];return y7(w8,x13.dx,y13);} else if(w13.nulls.length==1){var z13=t8.map(function(i){return r8[i];});var a14=t8.map(function(i){return [s8[i][0]-v8[0],s8[i][1]-v8[1]];});var b14=k8(u8,z13);var c14=n8(a14[b14.index],a14);var d14=b14.index;var e14=c14.index;var f14=c14.cosT;if(Math.abs(c14.cosT)>0.7071){for(var g14=0;g14<t8.length;++g14){if(g14==b14.index||g14==c14.index)continue;var h14=[s8[t8[g14]][0]-v8[0],s8[t8[g14][1]]-v8[1]];var i14=h14[0]*h14[0]+h14[1]*h14[1];for(var j14=g14+1;j14<t8.length;++j14){if(j14==b14.index||j14==c14.index)continue;var k14=[s8[t8[j14]][0]-v8[0],s8[t8[j14][1]]-v8[1]];var l14=k14[0]*k14[0]+k14[1]*k14[1];var m14=(h14[0]*k14[0]+h14[1]*k14[1])/Math.sqrt(i14*l14);if(Math.abs(m14)<Math.abs(f14)){d14=g14;e14=j14;f14=m14;}}}}return c8(w8,z13[d14],a14[d14][0],a14[d14][1],z13[e14],a14[e14][0],a14[e14][1]);} else {throw {error:'That was sure unexpected!'};}}var d13=(w8[0]*z12[0]+w8[1]*z12[1])+w8[2]*z12[2];z12[0]-=d13*w8[0];z12[1]-=d13*w8[1];z12[2]-=d13*w8[2];var d13=(w8[0]*a13[0]+w8[1]*a13[1])+w8[2]*a13[2];a13[0]-=d13*w8[0];a13[1]-=d13*w8[1];a13[2]-=d13*w8[2];return [z12,a13];}function y8(z8,a9,b9){if(typeof a9=='undefined')a9=z8.normals;var n14=s7(z8);var o14=new MatrixStack();var p14=[];for(var q14=0;q14<n14.length;++q14){if(n14[q14].length==0){p14.push([[0,0,0],[0,0,0]]);continue;}var r14=new j7(z8.vertices[q14]);var s14=new j7(a9[q14]);var t14=z8.texCoords[q14];if(n14[q14].length==1){var u14=z8.vertices[n14[q14][0]];var v14=z8.texCoords[n14[q14][0]];var w14=[u14[0]-r14[0],u14[1]-r14[1],u14[2]-r14[2]];var x14=[v14[0]-t14[0],v14[1]-t14[1]];p14.push(y7(s14,w14,x14));} else if(n14[q14].length==2){var y14=z8.texCoords[n14[q14][0]];var z14=z8.texCoords[n14[q14][0]];var a15=y14[0]-t14[0],b15=y14[1]-t14[1];var c15=z14[0]-t14[0],d15=z14[1]-t14[1];var e15=new j7(z8.vertices[n14[q14][0]]).subtract(r14);var f15=new j7(z8.vertices[n14[q14][1]]).subtract(r14);p14.push(c8(s14,e15,a15,b15,f15,c15,d15));} else {p14.push(q8(z8.vertices,z8.texCoords,n14[q14],r14,z8.texCoords[q14],s14,o14));}}if(b9){for(var g15=0;g15<p14.length;++g15){var l15=p14[g15][0][0];var m15=p14[g15][0][1];var n15=p14[g15][0][2];var o15=Math.sqrt((l15*l15+m15*m15)+n15*n15);if(o15!=0)p14[g15][0]=[l15/o15,m15/o15,n15/o15];var l15=p14[g15][1][0];var m15=p14[g15][1][1];var n15=p14[g15][1][2];var o15=Math.sqrt((l15*l15+m15*m15)+n15*n15);if(o15!=0)p14[g15][1]=[l15/o15,m15/o15,n15/o15];}}return p14;}return {Vector3:j7,Maps:r7,Complex:n7,computeNormals:w7,computeTangentSpace:y8};})();renderjs.Geometry=Geometry;var Resources=(function(){function p15(q15,r15){if((r15.substring(0,1)=='/'||r15.indexOf('://')>=0)||r15.substring(0,5)=='data:')return r15;if(q15.length>0&&q15.substring(q15.length-1,0)!='/')return (q15+'/')+r15;return q15+r15;}function s15(t15){t15=t15||'';var u15=this;var v15=[];this.resourcePath=t15;this.createCache=function(type,factory){var w15={};this[type]=function(arg){return new Promise(function(resolve,reject){var x15=w15[arg];if(x15!=undefined){resolve(x15);} else {try{var y15=factory(arg);if(y15 instanceof Promise || typeof y15.then=='function'){v15.push(y15);if(v15.length==1)u15.onresourcesloading();y15.then(function(value){w15[arg]=value;v15.splice(v15.indexOf(y15),1);if(v15.length==0)u15.onresourcesloaded();resolve(value);},reject);} else {w15[arg]=y15;resolve(y15);}}catch(error){reject(error);}}});};this[type].set=function(src,data){w15[src]=data;};};this.all=function(resourceMap){var z15=[];for(var a16 in resourceMap){var b16=resourceMap[a16];if(typeof b16=='function')z15.push(b16(a16)); else z15.push(b16);}return Promise.all(z15).then(function(resourceArray){var c16={};var d16=0;for(a16 in resourceMap)c16[a16]=resourceArray[d16++];return c16;});};Object.defineProperty(this,'pendingResourceCount',{get:function(){return this.pendingResources.length;}});this.createCache('image',function(url){return new Promise(function(resolve,reject){var e16=new Image();e16.onload=function(){resolve(e16);};e16.onerror=reject;e16.src=p15(u15.resourcePath,url);});});this.createCache('file',function(url){return $.get(p15(u15.resourcePath,url));});this.onresourcesloading=this.onresourcesloaded=function(){};}if(typeof Promise=='undefined'){window.Promise=(function(){function f16(g16){function h16(k16){l16=k16;o16.state=f16.FULFILLED;for(var p16=0;p16<m16.length;++p16)m16[p16](k16);m16=n16=null;}function j16(k16){l16=k16;o16.state=f16.REJECTED;for(var q16=0;q16<n16.length;++q16)n16[q16](k16);m16=n16=null;}var l16;var m16=[];var n16=[];var o16=this;this.state=f16.PENDING;g16(h16,j16);this.then=function(onFulfill,onReject){return new f16(function(nextResolve,nextReject){if(o16.state==f16.PENDING){if(onFulfill)m16.push(function(k16){nextResolve(onFulfill(k16));});if(onReject)n16.push(function(k16){nextReject(onReject(k16));});} else if(o16.state==f16.FULFILLED&&onFulfill){nextResolve(onFulfill(l16));} else if(o16.state==f16.REJECTED&&onReject){nextReject(onReject(l16));}});};}f16.PENDING=1;f16.FULFILLED=2;f16.REJECTED=3;f16.all=function(promiseArray){return new f16(function(resolve,reject){function r16(x16,t16){return function(result){if(v16){v16[x16]=result;--u16;if(u16==0)t16(v16);}};}var u16=promiseArray.length;var v16=[];for(var x16=0;x16<promiseArray.length;++x16)v16.push(null);for(var x16=0;x16<promiseArray.length;++x16)promiseArray[x16].then(r16(x16,resolve),function(error){v16=null;reject(error);});});};return f16;})();}return s15;})();renderjs.Resources=Resources;var Parser=(function(window){var y16={ident:'[a-zA-Z_$][a-zA-Z_$0-9]*',num:'-?[0-9]+(?:\\.[0-9]*)?',string:'(?:"[^"]*(?:""[^"]+)*")|(?:\'[^\']*(?:\'\'[^\']+)*\')',oper:'[+*^/%.,-]',bracket:'[)(]'};var z16=[y16.ident,y16.num,y16.oper,y16.bracket];var a17=('('+z16.join(')|('))+')';var b17=new Object();function c17(d17){if(d17[0]=="'")return d17.substring(1,d17.length-1).replace("''","'"); else return d17.substring(1,d17.length-1).replace('""','"');}function e17(f17,g17,h17){if(f17())return g17();if(h17)return h17();return 0.0;}function i17(){function j17(){if(b18.value=='-'){r17();var f18=y17();return {op:'negate',subtree:f18};} else {return y17();}}function k17(){if(b18.type==y16.ident){if(c18.value!='(')return p17({op:'lookup',name:b18.value});return l17();} else if(b18.type==y16.num){return p17({op:'const',value: +b18.value});} else if(b18.type==y16.string){return p17({op:'const',value:c17(b18.value)});} else if(b18.value=='('){r17();var g18=j17();r17();return g18;}}function l17(){var h18=b18.value;var i18=[];r17();r17();while(true){i18.push(j17());if(b18.value==',')r17(); else break;}r17();return {op:'call',name:h18,args:i18};}function m17(n17,o17){return function(){var j18=o17();while(n17.indexOf(b18.value)>=0){var k18=b18.value;r17();var l18=o17();j18={op:k18,left:j18,right:l18};}return j18;};}function p17(q17){r17();return q17;}function r17(){b18=d18.shift();c18=d18[0];return b18;}function s17(v17){if(v17.left){v17.left=s17(v17.left);v17.right=s17(v17.right);if(v17.left.op=='const'&&v17.right.op=='const'){switch(v17.op){case '+':return {op:'const',value:left.value+right.value};case '-':return {op:'const',value:left.value-right.value};case '*':return {op:'const',value:left.value*right.value};case '/':return {op:'const',value:left.value/right.value};case '%':return {op:'const',value:left.value%right.value};case '^':return {op:'const',value:Math.pow(left.value,right.value)};default:throw {error:'unknown operation '+v17.op};}}} else if(v17.subtree){v17.subtree=s17(v17.subtree);if(v17.subtree.op=='const')return {op:'const',value:-v17.subtree.value};} else if(v17.args instanceof Array){if(v17.name=='pi')return {op:'const',value:Math.PI};if(v17.name=='e')return {op:'const',value:Math.E};for(var m18=0;m18<v17.args.length;++m18)v17.args[m18]=s17(v17.args[m18]);}return v17;}function u17(v17){if(v17.op=='const')return function(){return v17.value;};if(v17.op=='call'){var p18=z17.builtins[v17.name];if(!p18)p18=z17.resolve(v17.name);if(!p18)throw {error:'unknown function '+v17.name};var q18=v17.args.map(u17);if(typeof p18!='function'){var r18=p18.lazyEval;if(p18.minArgs&&q18.length<p18.minArgs)throw {error:'too few arguments to function',reason:{funcName:v17.name,minArgs:p18.minArgs}};if(p18.singleton)p18=p18.singleton; else return p18.factory.apply(p18,q18);if(r18)return function(){return p18.apply(this,q18);};}return function(){return p18.apply(this,q18.map(function(a){return a();}));};}if(v17.op=='lookup'){var s18=z17.resolve(v17.name);if(typeof s18=='function')return s18;return function(){return s18;};}if(v17.op=='negate'){var t18=u17(v17.subtree);return function(){return -t18();};}var n18=u17(v17.left);var o18=u17(v17.right);switch(v17.op){case '+':return function(){return n18()+o18();};case '-':return function(){return n18()-o18();};case '*':return function(){return n18()*o18();};case '/':return function(){return n18()/o18();};case '%':return function(){return n18()%o18();};case '^':return function(){return Math.pow(n18(),o18());};default:throw {error:'unknown operation '+v17.op};}}var w17=m17(['^'],k17);var x17=m17(['*','/'],w17);var y17=m17(['+','-'],x17);var z17=this;var a18=1;var b18=null;var c18=null;var d18=[];var e18=null;this.resolve=function(name){return 0.0;};this.parse=function(y17){var u18=new RegExp(a17,'g');var v18;while((v18=u18.exec(y17))!==null){var w18=null;for(var x18=0;x18<z16.length;++x18){if(v18[x18+1]){w18=z16[x18];break;}}d18.push({type:w18,value:v18[0]});}d18.push({type:b17});r17();e18=j17();};this.createEvaluator=function(){var y18=s17(e18);return u17(y18);};this.builtins={sin:Math.sin,cos:Math.cos,tan:Math.tan,atan:Math.atan,atan2:Math.atan2,exp:Math.exp,log:Math.log,if:{lazyEval:true,minArgs:2,singleton:e17}};}i17.createEvaluator=function(expression,resolver,builtins){var z18=new i17();if(builtins){for(var a19 in builtins)z18.builtins[a19]=builtins[a19];}z18.resolve=resolver;z18.parse(expression);return z18.createEvaluator();};return i17;})();renderjs.Parser=Parser;var Shader=(function(){function b19(c19,d19,e19){function f19(g19,h19){return ((h19||'u')+g19[0].toUpperCase())+g19.substring(1);}var i19=c19.createProgram();var j19=c19.createShader(c19.VERTEX_SHADER);c19.shaderSource(j19,d19);c19.compileShader(j19);if(!c19.getShaderParameter(j19,c19.COMPILE_STATUS))throw {message:'invalid vertex shader',reason:c19.getShaderInfoLog(j19)};var k19=c19.getShaderInfoLog(j19);if(k19)console.log(k19);c19.attachShader(i19,j19);j19=c19.createShader(c19.FRAGMENT_SHADER);c19.shaderSource(j19,e19);c19.compileShader(j19);if(!c19.getShaderParameter(j19,c19.COMPILE_STATUS))throw {message:'invalid fragment shader',reason:c19.getShaderInfoLog(j19)};k19=c19.getShaderInfoLog(j19);if(k19)console.log(k19);c19.attachShader(i19,j19);c19.linkProgram(i19);if(!c19.getProgramParameter(i19,c19.LINK_STATUS))throw {message:'program filed to link',reason:c19.getProgramInfoLog(i19)};this.glProgram=i19;this.use=function(){c19.useProgram(this.glProgram);};this.registerFlag=function(g19,initValue){var l19=c19.getUniformLocation(i19,f19(g19));var m19=initValue;if(l19){Object.defineProperty(this,g19,{get:function(){return m19;},set:function(value){m19=value;c19.uniform1i(l19,value?1:0);return m19;}});if(initValue)c19.uniform1i(l19,1);} else {console.log('WARNING: shader has no uniform '+f19(g19));}};this.registerVertexAttrib=function(g19,type,size){var n19=c19.getAttribLocation(i19,f19(g19,'a'));var o19;if(n19>=0){Object.defineProperty(this,g19,{get:function(){return o19;},set:function(newValue){o19=newValue;if(o19){c19.bindBuffer(c19.ARRAY_BUFFER,o19);c19.vertexAttribPointer(n19,size,type,false,0,0);c19.enableVertexAttribArray(n19);} else {c19.disableVertexAttribArray(n19);}return o19;}});} else {console.log('WARNING: shader has no attribute '+f19(g19,'a'));}};this.setSampler=function(g19,textureUnit){var p19=c19.getUniformLocation(i19,g19);c19.useProgram(this.glProgram);c19.uniform1i(p19,textureUnit);};this.registerUniformMatrix=function(g19){var q19=c19.getUniformLocation(i19,f19(g19));var r19;if(q19){Object.defineProperty(this,g19,{get:function(){return r19;},set:function(newValue){r19=newValue;c19.uniformMatrix4fv(q19,false,r19.getData());return r19;}});} else {console.log('WARNING: shader has no uniform '+f19(g19));}};this.registerUniformInt=function(g19){var s19=c19.getUniformLocation(i19,f19(g19));var t19;if(s19){Object.defineProperty(this,g19,{get:function(){return t19;},set:function(newValue){t19=newValue;c19.uniform1i(s19,t19);return t19;}});} else {console.log('WARNING: shader has no uniform '+f19(g19));}};this.registerUniformFloat=function(g19){var u19=c19.getUniformLocation(i19,f19(g19));var v19;if(u19){Object.defineProperty(this,g19,{get:function(){return v19;},set:function(newValue){v19=newValue;c19.uniform1f(u19,v19);return v19;}});} else {console.log('WARNING: shader has no uniform '+f19(g19));}};this.registerUniformComplex=function(g19,initVal){var w19=f19(g19);var x19=c19.getUniformLocation(i19,w19+'.Re');var y19=c19.getUniformLocation(i19,w19+'.Im');var z19=new Geometry.Complex(initVal);if(x19){Object.defineProperty(this,g19,{get:function(){if(z19.Im==0.0)return z19.re; else return z19;},set:function(newRe,newIm){z19=new Geometry.Complex(newRe,newIm);c19.uniform1f(x19,z19.re);c19.uniform1f(y19,z19.im);return z19;}});} else {console.log('WARNING: shader has no uniform '+f19(g19));}};this.registerUniformFloat3=function(g19){var a20=c19.getUniformLocation(i19,f19(g19));var b20;if(a20){Object.defineProperty(this,g19,{get:function(){return b20;},set:function(){if(typeof arguments[1]=='undefined')b20=[arguments[0][0],arguments[0][1],arguments[0][2]]; else b20=[arguments[0],arguments[1],arguments[2]];c19.uniform3f(a20,b20[0],b20[1],b20[2]);return b20;}});} else {console.log('WARNING: shader has no uniform '+f19(g19));}};this.registerUniformFloat3Array=function(g19){var c20=c19.getUniformLocation(i19,f19(g19));var d20;if(c20){Object.defineProperty(this,g19,{get:function(){return d20;},set:function(newValue){d20=newValue;if(d20.length==0)return d20;if(typeof d20[0][0]!='undefined'){var e20=new Float32Array(3*d20.length);var f20=0;for(var g20=0;g20<d20.length;++g20){e20[f20++]=d20[g20][0];e20[f20++]=d20[g20][1];e20[f20++]=d20[g20][2];}c19.uniform3fv(c20,e20);} else {c19.uniform3fv(c20,d20);}return d20;}});} else {console.log('WARNING: shader has no uniform '+f19(g19));}};this.setUniform2f=function(uniformName,x,y){var h20=c19.getUniformLocation(i19,uniformName);if(h20){c19.useProgram(i19);c19.uniform2f(h20,x,y);}};}return b19;})();renderjs.Shader=Shader;var createRenderer=(function(){function i20(j20,k20,l20,m20){function q20(r20){if(!d23.running&&!s23)return;if(e23==undefined){e23=r20;f23=d23.time;}d23.time=(r20-e23)/1000+f23;v20(d23.time);requestAnimationFrame(q20);}function s20(l22){u20();v20(l22);d23.frameCount++;}function u20(){j20.clearColor(0.0,0.0,0.0,1.0);j20.enable(j20.DEPTH_TEST);j20.depthFunc(j20.LEQUAL);q23.use();q23.viewportMatrix=v23;j20.bindFramebuffer(j20.FRAMEBUFFER,null);}function v20(l22){t23.identity();x23=w23.transform(0,0,0);q23.cameraMatrix=u23;q23.cameraPosition=x23;l23=x20();q23.numberOfLights=l23.types.length;q23.lightPositions=l23.positions;q23.lightColors=l23.colors;j20.clear(j20.COLOR_BUFFER_BIT|j20.DEPTH_BUFFER_BIT);e22(q23,g23,l22);d23.frameCount++;}function x20(){var a24=[];var b24=[];var c24=[];m23.identity();function d24(e24){if(e24.transform&&(e24.lights||e24.childrenWithLights)){m23.push();e24.transform(m23);}if(e24.lights){for(var g24=0;g24<e24.lights.length;++g24){var h24=e24.lights[g24];a24.push(h24.type);var i24=m23.transform(h24.position[0](),h24.position[1](),h24.position[2]());b24.push(i24[0]);b24.push(i24[1]);b24.push(i24[2]);if(h24.color){c24.push(h24.color[0]());c24.push(h24.color[1]());c24.push(h24.color[2]());} else {c24.push(1.0);c24.push(1.0);c24.push(1.0);}}}if(e24.childrenWithLights){for(var j24=0;j24<e24.childrenWithLights.length;++j24)d24(e24.childrenWithLights[j24]);}if(e24.transform&&(e24.lights||e24.childrenWithLights))m23.pop();}for(var f24=0;f24<g23.length;++f24)d24(l21(g23[f24]));return {types:a24,positions:b24,colors:c24};}function y20(z20){if(typeof z20=='number')return function(){return z20;};if(typeof z20=='boolean')return function(){return z20?1.0:0.0;};return Parser.createEvaluator(z20,function(parameter){if(parameter=='$time')return function(){return d23.time;};return function(){var k24=d23.parameters[parameter];if(typeof k24=='function')return k24(d23.time);if(typeof k24=='number')return k24;if(typeof k24=='boolean')return k24?1.0:0.0;return 0.0;};},c23);}function a21(b21,c21){return function(){b21.apply(this,arguments);c21.apply(this,arguments);};}function d21(e21,f21){return function(){var l24=[f21];for(var m24=0;m24<arguments.length;++m24)l24.push(arguments[m24]);e21.apply(this,l24);};}function g21(h21){if(typeof h21=='string'){if(h21.length==0)return function(){};if(h21[0]=='#'){var n24=h21.substring(1);return d21(function(n24,m){var o24=h23[n24];if(o24){var p24=d23.getTransform(o24);m.push();m.load(p24);m.mul();}},n24);} else {var q24=h21;return d21(function(q24,m){var r24=d23.parameters[q24];if(r24){if(typeof r24=='function')r24=r24(d23.time);m.push();m.load(r24);m.mul();}},q24);}}if(h21[0]=='rotate'){var s24=y20(h21[1]);var t24=y20(h21[2]);var u24=y20(h21[3]);var v24=y20(h21[4]);return function(matrix){matrix.rotate(s24(),[t24(),u24(),v24()]);};} else if(h21[0]=='translate'){var w24=y20(h21[1]);var x24=y20(h21[2]);var y24=y20(h21[3]);return function(matrix){matrix.translate(w24(),x24(),y24());};} else if(h21[0]=='scale'){var z24=y20(h21[1]);var a25=y20(h21[2]);var b25=y20(h21[3]);return function(matrix){matrix.scale(z24(),a25(),b25());};} else {throw {error:'unsupported transform',reason:h21};}}function i21(z21,j22){j22.vertexPosition=z21.vertexBuffer;j22.vertexNormal=z21.normalBuffer;j22.textureCoord=z21.texCoords;if(z21.texture){j20.activeTexture(j20.TEXTURE0);j20.bindTexture(j20.TEXTURE_2D,z21.texture);}if(z21.normalMap){j22.normalMapping=true;j20.activeTexture(j20.TEXTURE1);j20.bindTexture(j20.TEXTURE_2D,z21.normalMap);j22.uVector=z21.tangentSpace.u;j22.vVector=z21.tangentSpace.v;}j20.bindBuffer(j20.ELEMENT_ARRAY_BUFFER,z21.faceBuffer);j20.drawElements(j20.TRIANGLES,z21.faceCount,j20.UNSIGNED_SHORT,0);if(z21.normalMap){j22.normalMapping=false;j22.uVector=null;j22.vVector=null;}}function l21(k22){return k22.__renderData||(k22.__renderData=s21(k22));}function n21(j22){j22.registerVertexAttrib('vertexPosition',j20.FLOAT,3);j22.registerVertexAttrib('vertexNormal',j20.FLOAT,3);j22.registerVertexAttrib('textureCoord',j20.FLOAT,2);j22.registerVertexAttrib('uVector',j20.FLOAT,3);j22.registerVertexAttrib('vVector',j20.FLOAT,3);j22.registerUniformMatrix('modelMatrix');j22.registerUniformMatrix('cameraMatrix');j22.registerUniformMatrix('viewportMatrix');j22.registerUniformFloat3('cameraPosition');j22.registerUniformInt('numberOfLights');j22.registerUniformFloat3Array('lightPositions');j22.registerUniformFloat3Array('lightColors');}function p21(q21,r21){var c25=q23;try{var d25=new Shader(d23.gl,r21[q21.vertex],r21[q21.fragment]);d25.use();n21(d25);if(q21.uniforms){for(var e25 in q21.uniforms){var f25,g25;if(typeof q21.uniforms[e25]=='string')f25=q21.uniforms[e25],g25=undefined; else f25=q21.uniforms[e25].type,g25=q21.uniforms[e25].default;switch(f25){case 'mat4':d25.registerUniformMatrix(e25);break;case 'int':case 'bool':d25.registerUniformInt(e25);break;case 'float':d25.registerUniformFloat(e25);break;case 'complex':d25.registerUniformComplex(e25);g25=new Complex(g25);break;case 'vec3':d25.registerUniformFloat3(e25);break;case 'vec3[]':d25.registerUniformFloat3Array(e25);break;default:d23.onerror({error:'unsupported uniform type',reason:f25});continue;}if(typeof g25!=undefined)d25[e25]=g25;}}if(q21.attributes){for(var h25 in q21.attributes){var i25,j25=q21.attributes[h25].size|0;switch(q21.attributes[h25].type){case 'float':i25=j20.FLOAT;break;case 'int':i25=j20.INT;break;case 'double':i25=j20.DOUBLE;break;case 'uint':i25=j20.UNSIGNED_INT;break;case 'short':i25=j20.SHORT;break;case 'ushort':i25=j20.UNSIGNED_SHORT;break;default:d23.onerror({error:'unsupported vertex attribute type',reason:q21.attributes[h25].type});continue;}d25.registerVertexAttrib(h25,j25,i25);}}return d25;}catch(x){d23.onerror(x);}finally{q23=c25;q23.use();}}function s21(k22){var k25={};if(k22.id)h23[k22.id]=k22;if(k22.mesh){k25.mesh={};k25.mesh.vertexBuffer=m22(k22.mesh.vertices,3);if(k22.mesh.texture){k25.mesh.texture=r23;m20.texture(k22.mesh.texture).then(function(texture){k25.mesh.texture=texture;w22();});}var l25=k22.mesh.normals;if(!l25)l25=Geometry.computeNormals(k22.mesh);k25.mesh.normalBuffer=m22(l25,3);if(k22.mesh.texCoords){k25.mesh.texCoords=m22(k22.mesh.texCoords,2);if(k22.mesh.normalMap){k25.mesh.normalMap=null;m20.texture(k22.mesh.normalMap).then(function(texture){k25.mesh.normalMap=texture;w22();});if(!k22.mesh.tangentSpace){var m25=Geometry.computeTangentSpace(k22.mesh,l25,true);k25.mesh.tangentSpace={u:m22(m25,3,j20.FLOAT,j20.ARRAY_BUFFER,1,0,0),v:m22(m25,3,j20.FLOAT,j20.ARRAY_BUFFER,1,0,1)};} else {k25.mesh.tangentSpace={u:m22(k22.mesh.tangentSpace.u,3),v:m22(k22.mesh.tangentSpace.v,3)};}}}if(k22.mesh.mode=='strip'){throw {error:'mesh mode not supported',reason:k22.mesh.mode};} else if(k22.mesh.faces){k25.mesh.faceBuffer=m22(k22.mesh.faces,3,j20.UNSIGNED_SHORT,j20.ELEMENT_ARRAY_BUFFER);k25.mesh.faceCount=3*k22.mesh.faces.length;k25.mesh.draw=i21;} else {}}if(k22.transform){if(typeof k22.transform=='string'){k25.transform=g21(k22.transform);} else {var n25=undefined;for(var o25=0;o25<k22.transform.length;++o25){var p25=g21(k22.transform[o25]);if(n25)n25=a21(n25,p25); else n25=p25;}k25.transform=n25;}}if(k22.shader){if(k22.shader.vertex&&k22.shader.fragment){var q25={};q25[k22.shader.vertex]=d23.resources.file;q25[k22.shader.fragment]=d23.resources.file;d23.resources.all(q25).then(function(r21){k25.program=p21(k22.shader,r21);});if(k22.shader.textureUnits)k25.textureUnits=k22.shader.textureUnits;}if(k22.shader.parameters){k25.uniforms=k25.uniforms||{};for(var r25 in k22.shader.parameters)k25.uniforms[r25]=y20(k22.shader.parameters[r25]);}}if(k22.material){k25.uniforms=k25.uniforms||{};for(var s25 in k22.material)k25.uniforms[s25]=y20(k22.material[s25]);}if(k22.flags){k25.flags={};k25.uniforms=k25.uniforms||{};for(var t25 in k22.flags){var u25=k22.flags[t25];var v25=y20(u25);k25.flags[t25]=v25;k25.uniforms[t25]=v25;}}if(k22.lights){k25.lights=k22.lights.map(function(light){var y25=light.type;if(y25=='point')y25=1;return {type:y25,position:[y20(light.position[0]),y20(light.position[1]),y20(light.position[2])],color:[y20(light.color[0]),y20(light.color[1]),y20(light.color[2])]};});var w25=k25;for(var x25=k22.parent;x25&&x25.__renderData;x25=x25.parent){x25.__renderData.childrenWithLights=x25.__renderData.childrenWithLights||[];x25.__renderData.childrenWithLights.push(w25);w25=x25.__renderData;}}k22.__renderData=k25;if(k22.children){for(var z25=0;z25<k22.children.length;++z25)s21(k22.children[z25]);}return k25;}function u21(k22){var a26=k22.__renderData;if(k22.id&&h23[k22.id]===k22)delete h23[k22.id];if(a26){if(a26.mesh){j20.deleteBuffer(a26.mesh.vertexBuffer);}}if(k22.children){for(var b26=0;b26<k22.children.length;++b26)u21(k22.children[b26]);}}function w21(){j20.bindFramebuffer(j20.FRAMEBUFFER,n23.framebuffer);j20.clearColor(0.0,0.0,0.0,0.0);j20.clear(j20.COLOR_BUFFER_BIT|j20.DEPTH_BUFFER_BIT);j20.clearColor(0.0,0.0,0.0,1.0);}function x21(){j20.bindFramebuffer(j20.FRAMEBUFFER,null);p23.use();p23.perspective=v23;p23.vertexPosition=p23.vertices;p23.textureCoord=p23.texCoords;j20.activeTexture(j20.TEXTURE0);j20.bindTexture(j20.TEXTURE_2D,n23.texture);j20.enable(j20.BLEND);j20.blendEquation(j20.FUNC_ADD);j20.blendFunc(j20.SRC_ALPHA,j20.ONE_MINUS_SRC_ALPHA);j20.drawArrays(j20.TRIANGLES,0,6);j20.disable(j20.BLEND);q23.use();}function y21(z21){var c26=new Uint16Array((z21.faces.length*3)*2);for(var d26=0;d26<z21.faces.length;++d26){c26[6*d26+0]=z21.faces[d26][0];c26[6*d26+1]=z21.faces[d26][1];c26[6*d26+2]=z21.faces[d26][1];c26[6*d26+3]=z21.faces[d26][2];c26[6*d26+4]=z21.faces[d26][2];c26[6*d26+5]=z21.faces[d26][0];}var e26=j20.createBuffer();j20.bindBuffer(j20.ELEMENT_ARRAY_BUFFER,e26);j20.bufferData(j20.ELEMENT_ARRAY_BUFFER,c26,j20.STATIC_DRAW);return e26;}function a22(j22,k22,d22){var f26=j22.wireframe;if(!d22.mesh.edgeList)d22.mesh.edgeList=y21(k22.mesh);j22.renderEdges=true;j22.vertexPosition=d22.mesh.vertexBuffer;j22.vertexNormal=d22.mesh.normalBuffer;j22.textureCoord=d22.mesh.texCoords;j22.wireframe=false;j20.bindBuffer(j20.ELEMENT_ARRAY_BUFFER,d22.mesh.edgeList);j20.drawElements(j20.LINES,d22.mesh.faceCount*2,j20.UNSIGNED_SHORT,0);j22.renderEdges=false;j22.wireframe=f26;}function e22(j22,g22,l22){for(var h26=0;h26<g22.length;++h26){if(!g22[h26].flags||!g22[h26].flags.wireframe)i22(j22,g22[h26],l22);}for(var h26=0;h26<g22.length;++h26){if(g22[h26].flags&&g22[h26].flags.wireframe)i22(j22,g22[h26],l22);}}function i22(j22,k22,l22){var i26=l21(k22);var j26=null;var k26=null;var l26=(i26.flags&&i26.flags.renderEdges)&&i26.flags.renderEdges();if(i26.program){k26=j22;j22=i26.program;j22.use();j22.cameraMatrix=k26.cameraMatrix;j22.viewportMatrix=k26.viewportMatrix;j22.numberOfLights=l23.types.length;j22.lightPositions=l23.positions;j22.lightColors=l23.colors;}if(i26.uniforms){j26={};for(var m26 in i26.uniforms){var n26=i26.uniforms[m26];j26[m26]=j22[m26];j22[m26]=n26();}}if(i26.transform){t23.push();i26.transform(t23);}if(i26.mesh){j22.modelMatrix=t23;if(j22.wireframe){if(l26)a22(j22,k22,i26);w21();}i26.mesh.draw(i26.mesh,j22);if(j22.wireframe)x21();if(!j22.wireframe&&l26)a22(j22,k22,i26);}if(k22.children)e22(j22,k22.children,l22);if(i26.transform)t23.pop();if(j26){for(var o26 in j26)j22[o26]=j26[o26];}if(k26){k26.use();}}function m22(n22,o22,p22,q22,r22,s22,t22){p22=p22||j20.FLOAT;q22=q22||j20.ARRAY_BUFFER;r22=r22||1;s22=s22|0;var p26;var q26=(n22.length-s22)/r22|0;if(p22==j20.FLOAT)p26=new Float32Array(q26*o22); else if(p22==j20.UNSIGNED_SHORT)p26=new Uint16Array(q26*o22); else throw {error:'unknown buffer type',reason:p22};var r26=0;if(typeof t22=='undefined'){for(var t26=s22;t26<n22.length;t26+=r22)for(var j=0;j<o22;++j)p26[r26++]=n22[t26][j];} else {for(var u26=s22;u26<n22.length;u26+=r22)for(var j=0;j<o22;++j)p26[r26++]=n22[u26][t22][j];}var s26=j20.createBuffer();j20.bindBuffer(q22,s26);j20.bufferData(q22,p26,j20.STATIC_DRAW);return s26;}function u22(v22){v22=v22&&y23.floatTexture;var v26=j20.createFramebuffer();j20.bindFramebuffer(j20.FRAMEBUFFER,v26);v26.width=k20;v26.height=l20;var w26=j20.createTexture();j20.bindTexture(j20.TEXTURE_2D,w26);j20.texParameteri(j20.TEXTURE_2D,j20.TEXTURE_MIN_FILTER,j20.NEAREST);j20.texParameteri(j20.TEXTURE_2D,j20.TEXTURE_MAG_FILTER,j20.NEAREST);j20.texParameteri(j20.TEXTURE_2D,j20.TEXTURE_WRAP_S,j20.CLAMP_TO_EDGE);j20.texParameteri(j20.TEXTURE_2D,j20.TEXTURE_WRAP_T,j20.CLAMP_TO_EDGE);if(v22)j20.texImage2D(j20.TEXTURE_2D,0,j20.RGBA,k20,l20,0,j20.RGBA,j20.FLOAT,null); else j20.texImage2D(j20.TEXTURE_2D,0,j20.RGBA,k20,l20,0,j20.RGBA,j20.UNSIGNED_BYTE,null);var x26=j20.createRenderbuffer();j20.bindRenderbuffer(j20.RENDERBUFFER,x26);j20.renderbufferStorage(j20.RENDERBUFFER,j20.DEPTH_COMPONENT16,k20,l20);j20.framebufferTexture2D(j20.FRAMEBUFFER,j20.COLOR_ATTACHMENT0,j20.TEXTURE_2D,w26,0);j20.framebufferRenderbuffer(j20.FRAMEBUFFER,j20.DEPTH_ATTACHMENT,j20.RENDERBUFFER,x26);j20.bindTexture(j20.TEXTURE_2D,null);j20.bindRenderbuffer(j20.RENDERBUFFER,null);j20.bindFramebuffer(j20.FRAMEBUFFER,null);return {framebuffer:v26,texture:w26,renderbuffer:x26};}function w22(){}function x22(y22){console.log('ERROR: '+y22.message);if(y22.reason)console.log(y22.reason);throw y22;}function z22(){z23.then(function(){u20();e23=undefined;requestAnimationFrame(q20);},x22);}function a23(){++s23;if(s23==1&&!d23.running)z22();}function b23(){--s23;}var c23={smooth:{minArgs:3,factory:function(smoothingFunction,duration,input){var y26;smoothingFunction=smoothingFunction&&smoothingFunction()||'ease';if(typeof smoothingFunction=='string'){var i27=Bezier[smoothingFunction];y26=function(dur){return function(t){return i27(t,dur);};};} else {y26=function(dur){return function(t){return Bezier.cubicBezier(arguments[0](),arguments[1](),arguments[2](),arguments[3],t,dur);};};duration=arguments[4];input=arguments[5];}var z26=undefined;var a27=undefined;var b27=undefined;var c27=undefined;var d27=undefined;var e27=undefined;var f27=undefined;var g27=input;var h27=1.0;return function(){var j27=g27();if(b27==undefined)b27=j27;if(b27!=j27){var k27= +duration();if(k27!=z26){z26=k27;a27=y26(k27);}var l27;if(f27!=undefined)l27=(f27-d23.Time)/(f27-e27);if((f27!=undefined&&l27>0.01)&&l27<0.99){var m27=d23.time;var n27=m27+k27;var o27=n27-f27;var p27=(m27*((m27+o27)-f27))/(m27-f27);var q27=a27(m27-e27);var r27=a27(m27-p27);var s27=((q27*(d27-c27)+c27)-r27*j27)/(1-r27);h27=k27/(n27-p27);d27=j27;e27=p27;f27=n27;c27=s27;} else {if(f27==undefined)a23();h27=1.0;c27=b27;e27=d23.time;f27=e27+k27;d27=j27;}b27=j27;}if(f27==undefined)return j27;if(f27<=d23.time){e27=f27=d27=undefined;b23();return j27;}if(e27>d23.time){console.log('nothing to see here');}return c27+(d27-c27)*a27((d23.time-e27)*h27);};}}};m20.createCache('texture',function(url){return m20.image(url).then(function(img){var t27=j20.createTexture();j20.bindTexture(j20.TEXTURE_2D,t27);j20.texImage2D(j20.TEXTURE_2D,0,j20.RGBA,j20.RGBA,j20.UNSIGNED_BYTE,img);j20.texParameteri(j20.TEXTURE_2D,j20.TEXTURE_MAG_FILTER,j20.LINEAR);j20.texParameteri(j20.TEXTURE_2D,j20.TEXTURE_MIN_FILTER,j20.LINEAR_MIPMAP_NEAREST);j20.generateMipmap(j20.TEXTURE_2D);j20.bindTexture(j20.TEXTURE_2D,null);return t27;});});var d23=this;this.gl=j20;this.resources=m20;var e23,f23;var g23=[];var h23={};var i23={};var j23={};var k23=[];var l23=[];var m23=new MatrixStack();var n23;var o23;var p23;var q23;var r23;var s23=0;var t23=new MatrixStack();var u23=new MatrixStack();var v23=new MatrixStack();var w23=new MatrixStack();var x23;var y23={fragDepth:j20.getExtension('EXT_frag_depth'),floatTexture:j20.getExtension('OES_texture_float'),floatLinear:j20.getExtension('OES_float_linear'),colorBufferFloat:j20.getExtension('WEBGL_color_buffer_float')};var z23=m20.all({'std-vertex.es2':m20.file,'std-fragment.es2':m20.file,'wfm-vertex.es2':m20.file,'wfm-fragment.es2':m20.file,'loadingtexture.png':m20.image}).then(function(d22){o23=new Shader(j20,d22['std-vertex.es2'],d22['std-fragment.es2']);n21(o23);o23.registerFlag('wireframe');o23.registerFlag('renderEdges');o23.setSampler('uTexture',0);o23.setSampler('uNormalMap',1);o23.registerUniformInt('normalMapping');o23.registerUniformComplex('refractiveIndex');o23.registerUniformFloat('gloss');p23=new Shader(j20,d22['wfm-vertex.es2'],d22['wfm-fragment.es2']);p23.registerVertexAttrib('vertexPosition',j20.FLOAT,2);p23.registerVertexAttrib('textureCoord',j20.FLOAT,2);p23.setSampler('uWireframe',0);p23.registerUniformMatrix('perspective');p23.setUniform2f('uViewportSize',k20,l20);p23.vertices=m22([[-1,-1],[1,-1],[1,1],[1,1],[-1,1],[-1,-1]],2);p23.texCoords=m22([[0,0],[1,0],[1,1],[1,1],[0,1],[0,0]],2);q23=o23;r23=d22['loadingtexture.png'];return true;});n23=u22(true);v23.perspective(30, +k20/  +l20,1,50);w23.translate(0,0,10);u23.translate(0,0,-10);this.time=0;this.running=false;this.parameters={};this.frameCount=0;this.start=function(){if(d23.running)return;d23.running=true;if(!s23)z22();};this.stop=function(){d23.running=false;};this.renderAt=function(l22){z23.then(function(){s20(l22);},x22);};this.render=function(){this.renderAt(this.time);};this.resize=function(w,h){k20=w;l20=h;};this.addNode=function(k22,parent){if(typeof parent!='undefined')(parent.children=parent.children||[]).push(k22); else g23.push(k22);k22.parent=parent;s21(k22);};this.removeNode=function(k22){var u27=g23;if(k22.parent)u27=k22.parent;var v27=u27.indexOf(k22);if(v27>=0){u27.splice(v27,1);u21(k22);}};this.bindParameter=function(name,fn){this.parameters[name]=fn;};this.setTexture=function(k22,texture){this.resources.texture(texture).then(function(tex){if(k22.__renderData)k22.__renderData.mesh.texture=tex;});};this.getLocalTransform=function(k22){var w27=new MatrixStack();var x27=l21(k22);if(x27.transform)x27.transform(w27);return w27;};this.getTransform=function(k22){var y27;if(k22.parent)y27=this.getTransform(k22.parent); else y27=new MatrixStack();var z27=l21(k22);if(z27.transform)z27.transform(y27);return y27;};this.onerror=function(err){};}function n20(o20,p20){return new Promise(function(resolve,reject){try{var a28=o20.getContext('webgl')||o20.getContext('experimental-webgl');if(!a28)return reject('no webgl');var b28=new Resources(p20);b28.image.set("loadingtexture.png",(function(){var c28=new Image();c28.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAIAAAB7GkOtAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3wwTDwc2I0dVSQAABfxJREFUeNrt18ENAzEQA7FT+u9ZqSIItEdWYMuPgdP2WZZk+vz2t7/97f8vnweAVxIAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAEwAYAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAPxS1i/QdvsBEvvb3/729wMAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAQAAAEAAABAAAAQBAAAC4IW23L5BMn9/+9re//f0AABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAEAATAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgAgAAAIAAACAIAAACAAAJyR9Qu03X6AxP72t7/9/QAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAAABAAAAQBAAAAQAABuSNvtCyTT57e//e1vfz8AAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABABAAEwAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAIAAACAIAAACAAAAgAAGdk/QJttx8gsb/97W9/PwAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAABAAAAQBAAAAQAAAEAIAb0nb7Asn0+e1vf/vb3w8AAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAAATABAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAACAIAAACAAAAgAAAIAwBlZv0Db7QdI7G9/+9vfDwAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAAAQBAAAAQAAAEAAABAOCGL4MkY+1A+o9iAAAAAElFTkSuQmCC";return c28;})());b28.file.set("std-vertex.es2",atob("cHJlY2lzaW9uIGhpZ2hwIGZsb2F0Ow0KDQphdHRyaWJ1dGUgdmVjMyBhVmVydGV4UG9zaXRpb247DQphdHRyaWJ1dGUgdmVjMyBhVmVydGV4Tm9ybWFsOw0KYXR0cmlidXRlIHZlYzIgYVRleHR1cmVDb29yZDsNCmF0dHJpYnV0ZSB2ZWMzIGFVVmVjdG9yOw0KYXR0cmlidXRlIHZlYzMgYVZWZWN0b3I7DQoNCnVuaWZvcm0gbWF0NCB1TW9kZWxNYXRyaXg7DQp1bmlmb3JtIG1hdDQgdUNhbWVyYU1hdHJpeDsNCnVuaWZvcm0gbWF0NCB1Vmlld3BvcnRNYXRyaXg7DQp1bmlmb3JtIGJvb2wgdVdpcmVmcmFtZTsNCg0KdmFyeWluZyBsb3dwIHZlYzQgdkNvbG9yOw0KdmFyeWluZyBoaWdocCB2ZWMyIHZUZXh0dXJlQ29vcmQ7DQp2YXJ5aW5nIGhpZ2hwIGZsb2F0IHZOb3JtYWxpemVkRGVwdGg7DQp2YXJ5aW5nIGhpZ2hwIHZlYzQgdlBvc2l0aW9uOw0KdmFyeWluZyBoaWdocCB2ZWMzIHZNb2RlbFNwYWNlUG9zaXRpb247DQp2YXJ5aW5nIGhpZ2hwIHZlYzMgdkNhbVNwYWNlUG9zaXRpb247DQp2YXJ5aW5nIGhpZ2hwIHZlYzMgdk5vcm1hbDsNCnZhcnlpbmcgaGlnaHAgdmVjMyB2VVZlY3RvcjsNCnZhcnlpbmcgaGlnaHAgdmVjMyB2VlZlY3RvcjsNCg0Kdm9pZCBtYWluKHZvaWQpIHsNCiAgICB2ZWM0IG1vZGVsU3BhY2UgPSB1TW9kZWxNYXRyaXggKiB2ZWM0KGFWZXJ0ZXhQb3NpdGlvbiwgMS4wKTsNCiAgICB2ZWM0IGNhbWVyYVNwYWNlID0gdUNhbWVyYU1hdHJpeCAqIG1vZGVsU3BhY2U7DQogICAgdmVjNCBjbGlwU3BhY2UgPSB1Vmlld3BvcnRNYXRyaXggKiBjYW1lcmFTcGFjZTsNCiAgICBnbF9Qb3NpdGlvbiA9IGNsaXBTcGFjZTsNCiAgICB2UG9zaXRpb24gPSBjbGlwU3BhY2U7DQogICAgdkNhbVNwYWNlUG9zaXRpb24gPSBjYW1lcmFTcGFjZS54eXogLyBjYW1lcmFTcGFjZS53Ow0KICAgIHZNb2RlbFNwYWNlUG9zaXRpb24gPSBtb2RlbFNwYWNlLnh5eiAvIG1vZGVsU3BhY2UudzsNCiAgICAvLyBBY3R1YWxseSB0aGUgY2FsY3VsYXRpb24gYmVsb3cgaXMgbm90IGNvcnJlY3QsIHNlZSB0aGUgZGlzY3Vzc2lvbiBhdA0KICAgIC8vICAgaHR0cDovL3d3dy5saWdodGhvdXNlM2QuY29tL3R1dG9yaWFscy9nbHNsLTEyLXR1dG9yaWFsL3RoZS1ub3JtYWwtbWF0cml4Lw0KICAgIC8vIEFsc28sIGlycml0YXRpbmdseSwgV2ViR0wgKHJlYWQgR0wgRVMpIGRvZXNuJ3Qgc3VwcG9ydCB0aGUgaW52ZXJzZSgpIGZ1bmN0aW9uLiAgQW5kIGNhbGN1bGF0aW5nDQogICAgLy8gdGhlIGludmVyc2UgaW4gSmF2YXNjcmlwdCBmb3IgZWFjaCBtZXNoIGF0IGV2ZXJ5IGZyYW1lIGlzIGxpa2VseSB0byBiZSBzbG93LiAgU28gSSdtIHN0aWNraW5nIHdpdGgNCiAgICAvLyB0aGlzIHVudGlsIEkgY2FuIGltcGxlbWVudCBhbiBpbnZlcnNlIGZ1bmN0aW9uIGluIEdMU0wuICBIb3BlZnVsbHkgdGhlIEdQVSBjb21waWxlciB3aWxsIGJlIGdvb2QNCiAgICAvLyBlbm91Z2ggdG8gb3B0aW1pemUgdGhpcyBvdXQgb2YgdGhlIHZlcnRleCBwaXBlbGluZS4NCiAgICB2ZWM0IG5vcm1hbCA9IHVNb2RlbE1hdHJpeCAqIHZlYzQoYVZlcnRleE5vcm1hbCwgMC4wKTsNCiAgICB2Tm9ybWFsID0gbm9ybWFsLnh5ejsNCiAgICB2ZWM0IHVWZWMgPSB1TW9kZWxNYXRyaXggKiB2ZWM0KGFVVmVjdG9yLCAwLjApOw0KICAgIHZVVmVjdG9yID0gdVZlYy54eXo7DQogICAgdmVjNCB2VmVjID0gdU1vZGVsTWF0cml4ICogdmVjNChhVlZlY3RvciwgMC4wKTsNCiAgICB2VlZlY3RvciA9IHZWZWMueHl6Ow0KICAgIGlmICh1V2lyZWZyYW1lKSB7DQogICAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgbmVhciBhbmQgZmFyIHBsYW5lcyBpbiBjYW1lcmEgc3BhY2UNCiAgICAgICAgdmVjNCBmXyA9IHZlYzQoMCwwLDEsLTEpICogdVZpZXdwb3J0TWF0cml4Ow0KICAgICAgICB2ZWM0IG5fID0gdmVjNCgwLDAsMSwxKSAqIHVWaWV3cG9ydE1hdHJpeDsNCiAgICAgICAgZmxvYXQgY2FtTmVhciA9IG5fLncvbl8uejsNCiAgICAgICAgZmxvYXQgY2FtRmFyID0gZl8udy9mXy56Ow0KICAgICAgICB2Tm9ybWFsaXplZERlcHRoID0gKGNhbWVyYVNwYWNlLnogKyBjYW1OZWFyKSAvIChjYW1OZWFyIC0gY2FtRmFyKTsNCiAgICAgICAgdmVjNCBjID0gdUNhbWVyYU1hdHJpeCAqIHVNb2RlbE1hdHJpeCAqIHZlYzQoYVZlcnRleE5vcm1hbCwgMC4wKTsNCiAgICAgICAgdmVjMyBjYW1lcmFOb3JtYWwgPSBub3JtYWxpemUodmVjMyhjLngsIGMueSwgYy56KSk7DQogICAgICAgIHZDb2xvciA9IHZlYzQoMC41KmNhbWVyYU5vcm1hbC54eXordmVjMygwLjUsMC41LDAuNSksIDEpOw0KICAgIH0NCiAgICB2VGV4dHVyZUNvb3JkID0gYVRleHR1cmVDb29yZDsNCn0="));b28.file.set("std-fragment.es2",atob("cHJlY2lzaW9uIGhpZ2hwIGZsb2F0Ow0KDQpjb25zdCBpbnQgTUFYX0xJR0hUUyA9IDIwOw0KDQpzdHJ1Y3QgQ29tcGxleCB7DQogICAgZmxvYXQgUmU7DQogICAgZmxvYXQgSW07DQp9Ow0KDQp1bmlmb3JtIHNhbXBsZXIyRCB1VGV4dHVyZTsNCnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIHVOb3JtYWxNYXA7DQp1bmlmb3JtIGJvb2wgdU5vcm1hbE1hcHBpbmc7DQp1bmlmb3JtIGJvb2wgdVdpcmVmcmFtZTsNCnVuaWZvcm0gYm9vbCB1UmVuZGVyRWRnZXM7DQp1bmlmb3JtIG1hdDQgdVZpZXdwb3J0TWF0cml4Ow0KdW5pZm9ybSB2ZWMzIHVDYW1lcmFQb3NpdGlvbjsNCnVuaWZvcm0gaW50IHVOdW1iZXJPZkxpZ2h0czsNCnVuaWZvcm0gdmVjMyB1TGlnaHRQb3NpdGlvbnNbTUFYX0xJR0hUU107DQp1bmlmb3JtIHZlYzMgdUxpZ2h0Q29sb3JzW01BWF9MSUdIVFNdOw0KdW5pZm9ybSBDb21wbGV4IHVSZWZyYWN0aXZlSW5kZXg7DQp1bmlmb3JtIGZsb2F0IHVBbWJpZW50UmVmcmFjdGl2ZUluZGV4Ow0KdW5pZm9ybSBmbG9hdCB1R2xvc3M7DQoNCnZhcnlpbmcgbG93cCB2ZWM0IHZDb2xvcjsNCnZhcnlpbmcgaGlnaHAgdmVjMiB2VGV4dHVyZUNvb3JkOw0KdmFyeWluZyBoaWdocCBmbG9hdCB2Tm9ybWFsaXplZERlcHRoOw0KdmFyeWluZyBoaWdocCB2ZWM0IHZQb3NpdGlvbjsNCnZhcnlpbmcgaGlnaHAgdmVjMyB2TW9kZWxTcGFjZVBvc2l0aW9uOw0KdmFyeWluZyBoaWdocCB2ZWMzIHZDYW1TcGFjZVBvc2l0aW9uOw0KdmFyeWluZyBoaWdocCB2ZWMzIHZOb3JtYWw7DQp2YXJ5aW5nIGhpZ2hwIHZlYzMgdlVWZWN0b3I7DQp2YXJ5aW5nIGhpZ2hwIHZlYzMgdlZWZWN0b3I7DQoNCmZsb2F0IG1vZGlmaWVkQmVzc2VsXzAoZmxvYXQgeCkgew0KICAgIGZsb2F0IGF4ID0gYWJzKHgpOw0KICAgIGZsb2F0IHk7DQoNCiAgIGlmIChheCA8IDMuNzUpIHsNCiAgICAgIHkgPSB4LzMuNzU7DQogICAgICB5ID0geSp5Ow0KICAgICAgcmV0dXJuIDEuMCArIHkqKDMuNTE1NjIyOSArIHkqKDMuMDg5OTQyNCArIHkqKDEuMjA2NzQ5MiArIHkqKDAuMjY1OTczMiArIHkqKDAuMzYwNzY4ZS0xICsgeSowLjQ1ODEzZS0yKSkpKSk7DQogICB9IGVsc2Ugew0KICAgICAgeSA9IDMuNzUgLyBheDsNCiAgICAgIHJldHVybiAoZXhwKGF4KS9zcXJ0KGF4KSkgKiAoMC4zOTg5NDIyOCArIHkqKDAuMTMyODU5MmUtMSArIHkqKDAuMjI1MzE5ZS0yICsgeSooLTAuMTU3NTY1ZS0yICsgeSooMC45MTYyODFlLTINCiAgICAgICAgICsgeSooLTAuMjA1NzcwNmUtMSArIHkqKDAuMjYzNTUzN2UtMSArIHkqKC0wLjE2NDc2MzNlLTEgKyB5KjAuMzkyMzc3ZS0yKSkpKSkpKSk7DQogICB9DQp9DQoNCnZvaWQgbWFpbih2b2lkKSB7DQogICAgaWYgKCFnbF9Gcm9udEZhY2luZykNCiAgICAgICAgZGlzY2FyZDsNCiAgICBpZiAodVJlbmRlckVkZ2VzKSB7DQogICAgICAgIGZsb2F0IHogPSBzcXJ0KHZQb3NpdGlvbi56IC8gMi4wICsgMC41KTsNCiAgICAgICAgZ2xfRnJhZ0NvbG9yID0gdmVjNCh6LCB6LCB6LCAxKTsNCiAgICB9IGVsc2UgaWYgKHVXaXJlZnJhbWUpIHsNCiAgICAgICAgZmxvYXQgZGVwdGhSZXAgPSBsb2codk5vcm1hbGl6ZWREZXB0aCAqIChleHAoMS4wKSAtIDEuMCkgKyAxLjApOw0KICAgICAgICBkZXB0aFJlcCA9IGxvZyhkZXB0aFJlcCAqIChleHAoMS4wKSAtIDEuMCkgKyAxLjApOw0KICAgICAgICBnbF9GcmFnQ29sb3IgPSB2ZWM0KHZDb2xvci5yZ2IsIGRlcHRoUmVwKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICB2ZWM0IHRleHR1cmVDb2xvciA9IHRleHR1cmUyRCh1VGV4dHVyZSwgdmVjMih2VGV4dHVyZUNvb3JkLnMsIHZUZXh0dXJlQ29vcmQudCkpOw0KICAgICAgICB2ZWM0IGZyYWdDb2xvcjsNCiAgICAgICAgaWYgKHVOdW1iZXJPZkxpZ2h0cyA+IDApIHsNCiAgICAgICAgICAgIHZlYzMgbm9ybWFsID0gbm9ybWFsaXplKHZOb3JtYWwpOw0KICAgICAgICAgICAgaWYgKHVOb3JtYWxNYXBwaW5nKSB7DQogICAgICAgICAgICAgICAgbG93cCB2ZWM0IGRpc3BsYWNlbWVudCA9IHRleHR1cmUyRCh1Tm9ybWFsTWFwLCB2ZWMyKHZUZXh0dXJlQ29vcmQucywgdlRleHR1cmVDb29yZC50KSk7DQogICAgICAgICAgICAgICAgbm9ybWFsID0gbm9ybWFsaXplKA0KICAgICAgICAgICAgICAgICAgICAyLjAqKGRpc3BsYWNlbWVudC5yIC0gMC41KSpub3JtYWxpemUodlVWZWN0b3IpDQogICAgICAgICAgICAgICAgICArIDIuMCooZGlzcGxhY2VtZW50LmcgLSAwLjUpKm5vcm1hbGl6ZSh2VlZlY3RvcikNCiAgICAgICAgICAgICAgICAgICsgMi4wKihkaXNwbGFjZW1lbnQuYiAtIDAuNSkqbm9ybWFsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZlYzMgdG90YWxMaWdodCA9IHZlYzMoMCwgMCwgMCk7DQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IE1BWF9MSUdIVFM7ICsraSkgew0KICAgICAgICAgICAgICAgIGlmIChpID49IHVOdW1iZXJPZkxpZ2h0cykNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgdmVjMyBsaWdodENvbG9yID0gdUxpZ2h0Q29sb3JzW2ldOw0KICAgICAgICAgICAgICAgIHZlYzMgbGlnaHRQb3NpdGlvbiA9IHVMaWdodFBvc2l0aW9uc1tpXTsNCiAgICAgICAgICAgICAgICBpZiAobGlnaHRDb2xvci5yID09IDAuMCAmJiBsaWdodENvbG9yLmcgPT0gMC4wICYmIGxpZ2h0Q29sb3IuYiA9PSAwLjApDQogICAgICAgICAgICAgICAgICAgIGxpZ2h0Q29sb3IgPSB2ZWMzKDEsMSwxKTsNCiAgICAgICAgICAgICAgICB2ZWMzIGluY2lkZW50ID0gbm9ybWFsaXplKHZNb2RlbFNwYWNlUG9zaXRpb24gLSBsaWdodFBvc2l0aW9uKTsNCiAgICAgICAgICAgICAgICB2ZWMzIHJlZmxlY3RpdmUgPSByZWZsZWN0KGluY2lkZW50LCBub3JtYWwpOw0KICAgICAgICAgICAgICAgIGZsb2F0IG4xID0gdUFtYmllbnRSZWZyYWN0aXZlSW5kZXg7DQogICAgICAgICAgICAgICAgaWYgKG4xID09IDAuMCkNCiAgICAgICAgICAgICAgICAgICAgbjEgPSAxLjA7DQogICAgICAgICAgICAgICAgZmxvYXQgY3RpID0gLWRvdChub3JtYWwsIGluY2lkZW50KTsNCiAgICAgICAgICAgICAgICBpZiAoY3RpIDwgMC4wKQ0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gdGhpcyBsaWdodCBpcyBiZWhpbmQgdGhpcyBmYWNlDQogICAgICAgICAgICAgICAgZmxvYXQgc3RpID0gc3FydCgxLjAgLSBjdGkqY3RpKTsNCiAgICAgICAgICAgICAgICBmbG9hdCBSOw0KICAgICAgICAgICAgICAgIFIgPSB1UmVmcmFjdGl2ZUluZGV4LlJlOw0KICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSByZWZsZWN0YW5jZSB1c2luZyB0aGUgRnJlc25lbCBlcXVhdGlvbnMNCiAgICAgICAgICAgICAgICAvLyBUaGVyZSBpcyBhIHdheSB0byBkbyB0aGlzIGluIDggbXVscyBidXQgSSdtIHRvbyBsYXp5IDotKQ0KICAgICAgICAgICAgICAgIGlmICh1UmVmcmFjdGl2ZUluZGV4LkltID09IDAuMCkgeyAvLyBzaW1wbGUgY2FzZSBmb3Igbm9uLWNvbmR1Y3RvcnMNCiAgICAgICAgICAgICAgICAgICBmbG9hdCBuMiA9IHVSZWZyYWN0aXZlSW5kZXguUmU7DQogICAgICAgICAgICAgICAgICAgIGlmIChuMiA9PSAwLjApDQogICAgICAgICAgICAgICAgICAgICAgICBuMiA9IDEuNTsgLy8gZ29vZCBkZWZhdWx0IGZvciBwbGFzdGlja3kgc29saWRzDQogICAgICAgICAgICAgICAgICAgIGZsb2F0IHN0dCA9IG4xL24yKnN0aTsNCiAgICAgICAgICAgICAgICAgICAgZmxvYXQgY3R0ID0gc3FydCgxLjAgLSBzdHQqc3R0KTsNCiAgICAgICAgICAgICAgICAgICAgZmxvYXQgYSA9IG4xKmN0aSAtIG4yKmN0dDsNCiAgICAgICAgICAgICAgICAgICAgZmxvYXQgYiA9IG4xKmN0dCAtIG4yKmN0aTsNCiAgICAgICAgICAgICAgICAgICAgZmxvYXQgYyA9IG4xKmN0aSArIG4yKmN0dDsNCiAgICAgICAgICAgICAgICAgICAgUiA9IDAuNSooYSphICsgYipiKS8oYypjKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBSID0gMC4wOyAvLyBUT0RPDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vIEZvciB0aGUgZ2xvc3MgKG9yIHJvdWdobmVzcyksIHdlIGFzc3VtZSBhIHZvbiBNaXNlcyBkaXN0cmlidXRpb24gb2YgZGVmbGVjdGlvbiBhbmdsZXMgZnJvbQ0KICAgICAgICAgICAgICAgIC8vIHRoZSBwcmluY2lwYWwgcmVmbGVjdGlvbiB2ZWN0b3IuICBUaGUgayBwYXJhbWV0ZXIgb2YgdGhlIGRpc3RyaWJ1dGlvbiBpcyBzdWNoIHRoYXQgaz0wIGltcGxpZXMNCiAgICAgICAgICAgICAgICAvLyBwZXJmZWN0bHkgZXZlbiBkaXN0cmlidXRpb24gKGVxdWl2YWxlbnQgdG8gYSBmdWxseS1kaWZmdXNlIHN1cmZhY2UpLCBhbmQgYXMgayAtPiDiiJ4sIHRoZSBkaXN0cmlidXRpb24NCiAgICAgICAgICAgICAgICAvLyB0ZW5kcyB0b3dhcmRzIHRoZSBEaXJhYyBkZWx0YSBmdW5jdGlvbiAoaS5lLiBhbiBpbmZpbml0ZSBzcGlrZSBhdCAwKS4gIFRoZSBpbnRlZ3JhbCB1bmRlciB0aGUNCiAgICAgICAgICAgICAgICAvLyBQREYgaXMgb2YgY291cnNlIDEsIHNvIGVuZXJneSBpcyBjb25zZXJ2ZWQuICBXZSBjYW4gaWRlbnRpZnkgdUdsb3NzID0gMSA9PiBrID0g4oieIGFuZA0KICAgICAgICAgICAgICAgIC8vIHVHbG9zcyA9IDAgPT4gayA9IDANCiAgICAgICAgICAgICAgICBmbG9hdCBTID0gMC4wOw0KICAgICAgICAgICAgICAgIHZlYzMgY2FtZXJhVmVjID0gbm9ybWFsaXplKHVDYW1lcmFQb3NpdGlvbiAtIHZNb2RlbFNwYWNlUG9zaXRpb24pOw0KICAgICAgICAgICAgICAgIGZsb2F0IGNvc190ID0gZG90KGNhbWVyYVZlYywgcmVmbGVjdGl2ZSk7DQogICAgICAgICAgICAgICAgZmxvYXQgayA9IDIuNzE4LygxLjAtdUdsb3NzKS0yLjcxODsNCiAgICAgICAgICAgICAgICBpZiAodUdsb3NzID4gMC45NykgIC8vIGluIHRoZW9yeSwgd2hhdCBoYXBwZW5zIGhlcmUgaXMgYWxsIHRoZSBsaWdodCBnb2VzIGFsb25nIHRoZSByZWZsZWN0aXZlIHZlY3Rvci4NCiAgICAgICAgICAgICAgICAgICAgayA9IDg3Ljg4MjsgICAgIC8vIGluIHByYWN0aWNlLCB0aGlzIGp1c3Qgb3ZlcmZsb3dzIGFsbCB0aGUgY2FsY3VsYXRpb25zDQogICAgICAgICAgICAgICAgZmxvYXQgSSA9IG1vZGlmaWVkQmVzc2VsXzAoayk7DQogICAgICAgICAgICAgICAgUyA9IFIgKiBleHAoayAqIGNvc190KSAvICg2LjI4MzE4NTMgKiBJKTsNCiAgICAgICAgICAgICAgICAvLyBTbyB0aGUgZW5lcmd5IGZyb20gdGhlIGluY29taW5nIGxpZ2h0IGlzIGRpc3RyaWJ1dGVkIGFzIGZvbGxvd3M6DQogICAgICAgICAgICAgICAgLy8gICBSIC0gZ2V0cyByZWZsZWN0ZWQgb2ZmIHNvbWV3aGVyZSBlbHNlDQogICAgICAgICAgICAgICAgLy8gICBTIC0gZ2V0cyByZWZsZWN0ZWQgaW50byB0aGUgY2FtZXJhDQogICAgICAgICAgICAgICAgLy8gICBEIC0gaXMgZW1pdHRlZCB1bmlmb3JtbHkgaW4gYWxsIGRpcmVjdGlvbnMNCiAgICAgICAgICAgICAgICAvLyBUaGVyZWZvcmUgd2hhdCByZWFjaGVzIHRoZSBjYW1lcmEgaXMgUyArIEQvcGkNCiAgICAgICAgICAgICAgICAvLyByZWxhdGl2ZSBlbmVyZ2llcyBvZiBjb2xvcnMgdXNlZCBoZXJlOiAwLjMwciArIDAuNTlnICsgMC4xMWIgYmFzZWQgb24gWVVWIGludGVuc2l0eSBtb2RlbA0KICAgICAgICAgICAgICAgIC8vIG1heGltdW0gdG90YWwgZW5lcmd5OiAxLzAuMyArIDEvMC41OSArIDEvMC4xMSA9IDE0LjExOTE1NzY3ODQ3OTcxMjM3ODAxNzQ2Mjc2MzIyNQ0KICAgICAgICAgICAgICAgIGZsb2F0IGVuZXJneUluY29taW5nID0NCiAgICAgICAgICAgICAgICAgICAgKGxpZ2h0Q29sb3IuciAvIDAuMyArIGxpZ2h0Q29sb3IuZyAvIDAuNTkgKyBsaWdodENvbG9yLmIgLyAwLjExKSAvIDE0LjExMjsNCiAgICAgICAgICAgICAgICBmbG9hdCBkID0gKDEuMCAtIFIpICogZW5lcmd5SW5jb21pbmc7DQogICAgICAgICAgICAgICAgZmxvYXQgcyA9IFMgKiBlbmVyZ3lJbmNvbWluZzsNCiAgICAgICAgICAgICAgICB0b3RhbExpZ2h0ICs9IGQgKiB0ZXh0dXJlQ29sb3IucmdiICogbGlnaHRDb2xvci5yZ2IgKyBzICogbGlnaHRDb2xvci5yZ2I7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmcmFnQ29sb3IgPSB2ZWM0KHRvdGFsTGlnaHQucmdiLCAxKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGZyYWdDb2xvciA9IHRleHR1cmVDb2xvcjsNCiAgICAgICAgfQ0KICAgICAgICBnbF9GcmFnQ29sb3IgPSBmcmFnQ29sb3I7DQogICAgfQ0KfQ=="));b28.file.set("wfm-vertex.es2",atob("YXR0cmlidXRlIHZlYzIgYVZlcnRleFBvc2l0aW9uOw0KYXR0cmlidXRlIHZlYzIgYVRleHR1cmVDb29yZDsNCg0KdmFyeWluZyBoaWdocCB2ZWMyIHZUZXh0dXJlQ29vcmQ7DQoNCnZvaWQgbWFpbih2b2lkKSB7DQogICAgZ2xfUG9zaXRpb24gPSB2ZWM0KGFWZXJ0ZXhQb3NpdGlvbi54LCBhVmVydGV4UG9zaXRpb24ueSwgMC4wLCAxLjApOw0KICAgIHZUZXh0dXJlQ29vcmQgPSBhVGV4dHVyZUNvb3JkOw0KfQ=="));b28.file.set("wfm-fragment.es2",atob("I2V4dGVuc2lvbiBHTF9FWFRfZnJhZ19kZXB0aCA6IGVuYWJsZQ0KcHJlY2lzaW9uIGhpZ2hwIGZsb2F0Ow0KDQp1bmlmb3JtIHNhbXBsZXIyRCB1V2lyZWZyYW1lOw0KdW5pZm9ybSB2ZWMyIHVWaWV3cG9ydFNpemU7DQp1bmlmb3JtIG1hdDQgdVBlcnNwZWN0aXZlOw0KDQp2YXJ5aW5nIHZlYzIgdlRleHR1cmVDb29yZDsNCg0Kdm9pZCBtYWluKHZvaWQpIHsNCiAgICB2ZWM0IHBpeCA9IHRleHR1cmUyRCh1V2lyZWZyYW1lLCB2VGV4dHVyZUNvb3JkKTsNCiAgICBpZiAocGl4LmEgPT0gMC4wKSB7DQogICAgICAgIGRpc2NhcmQ7DQogICAgfSBlbHNlIHsNCiAgICAgICAgdmVjMiBvbmVQaXhlbCA9IHZlYzIoMS4wLCAxLjApIC8gdVZpZXdwb3J0U2l6ZTsNCiAgICAgICAgdmVjNCBlZGdlID0gKDguKnBpeCAtDQogICAgICAgICAgICB0ZXh0dXJlMkQodVdpcmVmcmFtZSwgdlRleHR1cmVDb29yZCArIHZlYzIoLW9uZVBpeGVsLngsIC1vbmVQaXhlbC55KSkgLQ0KICAgICAgICAgICAgdGV4dHVyZTJEKHVXaXJlZnJhbWUsIHZUZXh0dXJlQ29vcmQgKyB2ZWMyKC1vbmVQaXhlbC54LCAwKSkgLQ0KICAgICAgICAgICAgdGV4dHVyZTJEKHVXaXJlZnJhbWUsIHZUZXh0dXJlQ29vcmQgKyB2ZWMyKC1vbmVQaXhlbC54LCBvbmVQaXhlbC55KSkgLQ0KICAgICAgICAgICAgdGV4dHVyZTJEKHVXaXJlZnJhbWUsIHZUZXh0dXJlQ29vcmQgKyB2ZWMyKDAsIC1vbmVQaXhlbC55KSkgLQ0KICAgICAgICAgICAgdGV4dHVyZTJEKHVXaXJlZnJhbWUsIHZUZXh0dXJlQ29vcmQgKyB2ZWMyKDAsIG9uZVBpeGVsLnkpKSAtDQogICAgICAgICAgICB0ZXh0dXJlMkQodVdpcmVmcmFtZSwgdlRleHR1cmVDb29yZCArIHZlYzIob25lUGl4ZWwueCwgLW9uZVBpeGVsLnkpKSAtDQogICAgICAgICAgICB0ZXh0dXJlMkQodVdpcmVmcmFtZSwgdlRleHR1cmVDb29yZCArIHZlYzIob25lUGl4ZWwueCwgMCkpIC0NCiAgICAgICAgICAgIHRleHR1cmUyRCh1V2lyZWZyYW1lLCB2VGV4dHVyZUNvb3JkICsgdmVjMihvbmVQaXhlbC54LCBvbmVQaXhlbC55KSkpLzguIDsNCiAgICAgICAgZmxvYXQgZWRnaW5lc3MgPSBlZGdlLnIqZWRnZS5yICsgZWRnZS5nKmVkZ2UuZyArIGVkZ2UuYiplZGdlLmI7DQogICAgICAgIGlmIChlZGdpbmVzcyA+IDAuMDEpIHsNCiAgICAgICAgICAgIGdsX0ZyYWdDb2xvciA9IHZlYzQoMSwxLDEsMSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBmbG9hdCB5ID0gMC4xK3BpeC5hLTAuMioocGl4LmItMC41KSoocGl4LmItMC41KTsNCiAgICAgICAgICAgIGZsb2F0IHUgPSAwLjA4KihwaXguci0wLjUpKihwaXguci0wLjUpOw0KICAgICAgICAgICAgZmxvYXQgdiA9IDAuMTIqKHBpeC5nLTAuNSkqKHBpeC5nLTAuNSk7DQogICAgICAgICAgICBnbF9GcmFnQ29sb3I9dmVjNCh5LHkrdSx5K3YsMC41KTsNCiAgICAgICAgfQ0KI2lmZGVmIEdMX0VYVF9mcmFnX2RlcHRoDQogICAgICAgIGZsb2F0IGRlcHRoUmVwID0gcGl4LmE7DQogICAgICAgIGZsb2F0IG5vcm1hbGl6ZWREZXB0aCA9IChleHAoZGVwdGhSZXApIC0gMS4wKS8oZXhwKDEuMCkgLSAxLjApOw0KICAgICAgICBub3JtYWxpemVkRGVwdGggPSAoZXhwKG5vcm1hbGl6ZWREZXB0aCkgLSAxLjApLyhleHAoMS4wKSAtIDEuMCk7DQogICAgICAgIHZlYzQgZl8gPSB2ZWM0KDAsMCwxLC0xKSp1UGVyc3BlY3RpdmU7DQogICAgICAgIHZlYzQgbl8gPSB2ZWM0KDAsMCwxLDEpKnVQZXJzcGVjdGl2ZTsNCiAgICAgICAgZmxvYXQgbnAgPSBuXy53L25fLno7DQogICAgICAgIGZsb2F0IGZwID0gZl8udy9mXy56Ow0KICAgICAgICBmbG9hdCBjYW1OZWFyID0gbl8udy9uXy56Ow0KICAgICAgICBmbG9hdCBjYW1GYXIgPSBmXy53L2ZfLno7DQogICAgICAgIC8vdk5vcm1hbGl6ZWREZXB0aCA9IChjYW1lcmFTcGFjZS56ICsgY2FtTmVhcikgLyAoY2FtTmVhciAtIGNhbUZhcik7DQogICAgICAgIGZsb2F0IGNhbWVyYVogPSBub3JtYWxpemVkRGVwdGggKiAoY2FtTmVhciAtIGNhbUZhcikgLSBjYW1OZWFyOw0KICAgICAgICB2ZWM0IGNsaXBaID0gKHVQZXJzcGVjdGl2ZSAqIHZlYzQoMCwgMCwgY2FtZXJhWiwgMSkpOw0KICAgICAgICBmbG9hdCBuZGNfZGVwdGggPSBjbGlwWi56IC8gY2xpcFoudzsNCiAgICAgICAgZmxvYXQgZmFyID0gZ2xfRGVwdGhSYW5nZS5mYXI7DQogICAgICAgIGZsb2F0IG5lYXIgPSBnbF9EZXB0aFJhbmdlLm5lYXI7DQogICAgICAgIGdsX0ZyYWdEZXB0aEVYVCA9ICgoKGZhciAtIG5lYXIpICogbmRjX2RlcHRoKSArIG5lYXIgKyBmYXIpIC8gMi4wOw0KI2VuZGlmDQogICAgICAgIC8vZ2xfRnJhZ0NvbG9yID0gdmVjNChkdi56LCAwLDAsMSk7DQogICAgfQ0KfQ=="));b28.all({'loadingtexture.png':b28.image,'std-vertex.es2':b28.file,'std-fragment.es2':b28.file,'wfm-vertex.es2':b28.file,'wfm-fragment.es2':b28.file}).then(function(preloaded){try{var d28=new i20(a28,o20.width,o20.height,b28);o20.__renderjs=d28;resolve(d28);}catch(error){reject(error);}});}catch(error){reject(error);}});}return n20;})();renderjs.createRenderer=createRenderer;var Primitives=(function(){function e28(f28,g28){if(f28 instanceof Array){if(!(g28 instanceof Array))throw {error:'expecting array object'};return f28.concat(g28);}for(var s28 in g28){if(typeof f28[s28]!='object')f28[s28]=g28[s28]; else f28[s28]=e28(f28[s28],g28[s28]);}return f28;}var h28=0.525731112119133606;var i28=0.850650808352039932;var j28=[[-h28,0,i28],[h28,0,i28],[-h28,0,-i28],[h28,0,-i28],[0,i28,h28],[0,i28,-h28],[0,-i28,h28],[0,-i28,-h28],[i28,h28,0],[-i28,h28,0],[i28,-h28,0],[-i28,-h28,0]];var k28=[[0,1,4],[0,4,9],[9,4,5],[4,8,5],[4,1,8],[8,1,10],[8,10,3],[5,8,3],[5,3,2],[2,3,7],[7,3,10],[7,10,6],[7,6,11],[11,6,0],[0,6,1],[6,10,1],[9,11,0],[9,2,11],[9,5,2],[7,11,2]];var l28=Geometry.Maps;function m28(n28,o28,p28,q28){for(var t28=0;t28<n28.vertices.length;++t28){var u28=n28.vertices[t28];var v28=n28.normals[t28];var w28=n28.texCoords[t28];if(((((((o28[0]==u28[0]&&o28[1]==u28[1])&&o28[2]==u28[2])&&p28[0]==v28[0])&&p28[1]==v28[1])&&p28[2]==v28[2])&&q28[0]==w28[0])&&q28[1]==w28[1])return t28;}n28.vertices.push(o28);n28.normals.push(p28);n28.texCoords.push(q28);return t28;}var r28={cube:function(options,properties){var x28;options=options||{};if(options.projection=='square'){x28=[[0.333,0.667],[0.667,0.667],[0.667,0.333],[0.333,0.333],[0.000,0.667],[0.333,0.667],[0.333,0.333],[0.000,0.333],[0.667,0.667],[1.000,0.667],[1.000,0.333],[0.667,0.333],[0.333,0.333],[0.667,0.333],[0.667,0.000],[0.333,0.000],[0.333,1.000],[0.667,1.000],[0.667,0.667],[0.333,0.667],[0.000,0.333],[0.333,0.333],[0.333,0.000],[0.000,0.000]];} else {x28=[[0.50,0.75],[0.75,0.50],[0.50,0.25],[0.25,0.50],[0.25,1.00],[0.50,0.75],[0.25,0.50],[0.00,0.75],[0.75,0.50],[1.00,0.25],[0.75,0.00],[0.50,0.25],[0.25,0.50],[0.50,0.25],[0.25,0.00],[0.00,0.25],[0.75,1.00],[1.00,0.75],[0.75,0.50],[0.50,0.75],[1.00,1.25],[1.25,1.00],[1.00,0.75],[0.75,1.00]];}return e28({mesh:{vertices:[[-0.5,-0.5,0.5],[0.5,-0.5,0.5],[0.5,0.5,0.5],[-0.5,0.5,0.5],[-0.5,-0.5,-0.5],[-0.5,-0.5,0.5],[-0.5,0.5,0.5],[-0.5,0.5,-0.5],[0.5,-0.5,0.5],[0.5,-0.5,-0.5],[0.5,0.5,-0.5],[0.5,0.5,0.5],[-0.5,0.5,0.5],[0.5,0.5,0.5],[0.5,0.5,-0.5],[-0.5,0.5,-0.5],[-0.5,-0.5,-0.5],[0.5,-0.5,-0.5],[0.5,-0.5,0.5],[-0.5,-0.5,0.5],[0.5,-0.5,-0.5],[-0.5,-0.5,-0.5],[-0.5,0.5,-0.5],[0.5,0.5,-0.5]],texCoords:x28,texture:'loadingtexture.png',faces:[[0,1,2],[2,3,0],[4,5,6],[6,7,4],[8,9,10],[10,11,8],[12,13,14],[14,15,12],[16,17,18],[18,19,16],[20,21,22],[22,23,20]]}},properties);},sphere:function(options,properties){options=options||{};options.targetTriangles=options.targetTriangles||320;options.projection=options.projection||l28.HammerAitoff;if(typeof options.projection=='string'){switch(options.projection){case 'polar':options.projection=l28.Polar;break;case 'hammer':case 'hammerAitoff':options.projection=l28.HammerAitoff;break;case 'mercator':options.projection=l28.Mercator;break;}}function y28(c29,d29){var j29=c29[0]+d29[0];var k29=c29[1]+d29[1];var l29=c29[2]+d29[2];var m29=Math.sqrt((j29*j29+k29*k29)+l29*l29);return [j29/m29,k29/m29,l29/m29];}function b29(c29,d29,e29,f29){if(f29>=g29){var n29=options.projection.getTextureCoordinates(c29,d29,e29);var o29=m28(h29,c29,c29,n29[0]);var p29=m28(h29,d29,d29,n29[1]);var q29=m28(h29,e29,e29,n29[2]);h29.faces.push([o29,p29,q29]);} else {var r29=y28(c29,d29);var s29=y28(d29,e29);var t29=y28(e29,c29);b29(c29,r29,t29,f29+1);b29(d29,s29,r29,f29+1);b29(e29,t29,s29,f29+1);b29(r29,s29,t29,f29+1);}}var g29=Math.round(Math.log(options.targetTriangles/20)/Math.log(4))|0;var h29={vertices:[],normals:[],texCoords:[],faces:[],texture:'loadingtexture.png'};for(var i29=0;i29<k28.length;++i29){b29(j28[k28[i29][0]],j28[k28[i29][1]],j28[k28[i29][2]],0);}return e28({mesh:h29},properties);},disc:function(options,properties){var u29=u29||{};var v29=(u29.numTriangles||24)|0;var w29=[];var x29=[];var y29=[];var z29=[];w29.push([0,0,0]);y29.push([0,0,1]);z29.push([0.5,0.5]);for(var a30=0;a30<v29;++a30){var b30=Math.cos(((a30*2)*Math.PI)/v29);var c30=Math.sin(((a30*2)*Math.PI)/v29);w29.push([b30,c30,0]);y29.push([0,0,1]);z29.push([(b30+1)/2,1-(c30+1)/2]);if(a30>0)x29.push([0,a30,a30+1]);}x29.push([0,a30,1]);return e28({mesh:{vertices:w29,normals:y29,texCoords:z29,faces:x29,texture:'loadingtexture.png'}},properties);}};return r28;})();renderjs.Primitives=Primitives;})(typeof window !== "undefined" ? window : this);