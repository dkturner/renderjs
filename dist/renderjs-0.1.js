(function(exports){exports.renderjs={};var MatrixStack=(function(){function a(b,c,d){'use asm';var k=new b.Float32Array(d);var l=b.Math.imul;var m=b.Math.fround;var n=b.Math.floor;var o=b.Math.sin;var p=b.Math.cos;var q=b.Math.tan;var r=b.Math.sqrt;function s(f2){f2=f2|0;f2=f2<<6;k[f2+0>>2]=m(1.0);k[f2+4>>2]=m(0.0);k[f2+8>>2]=m(0.0);k[f2+12>>2]=m(0.0);k[f2+16>>2]=m(0.0);k[f2+20>>2]=m(1.0);k[f2+24>>2]=m(0.0);k[f2+28>>2]=m(0.0);k[f2+32>>2]=m(0.0);k[f2+36>>2]=m(0.0);k[f2+40>>2]=m(1.0);k[f2+44>>2]=m(0.0);k[f2+48>>2]=m(0.0);k[f2+52>>2]=m(0.0);k[f2+56>>2]=m(0.0);k[f2+60>>2]=m(1.0);}function u(f2,w,x,y,z){f2=f2|0;w= +w;x= +x;y= +y;z= +z;var k2=0.0;var l2=0.0;f2=f2<<6;k2=1.0/q(w/2.0);l2=1.0/(y-z);k[f2+0>>2]=m(k2/x);k[f2+4>>2]=m(0.0);k[f2+8>>2]=m(0.0);k[f2+12>>2]=m(0.0);k[f2+16>>2]=m(0.0);k[f2+20>>2]=m(k2);k[f2+24>>2]=m(0.0);k[f2+28>>2]=m(0.0);k[f2+32>>2]=m(0.0);k[f2+36>>2]=m(0.0);k[f2+40>>2]=m((y+z)*l2);k[f2+44>>2]=m(-1.0);k[f2+48>>2]=m(0.0);k[f2+52>>2]=m(0.0);k[f2+56>>2]=m(((y*z)*l2)*2.0);k[f2+60>>2]=m(0.0);}function a1(d2,b2){d2=d2|0;b2=b2|0;var m2=m(0.0),n2=m(0.0),o2=m(0.0),p2=m(0.0),q2=m(0.0),r2=m(0.0),s2=m(0.0),t2=m(0.0),u2=m(0.0),v2=m(0.0),w2=m(0.0),x2=m(0.0),y2=m(0.0),z2=m(0.0),a3=m(0.0),b3=m(0.0);d2=d2<<6;b2=b2<<6;m2=m(m(m(m(k[b2+0>>2])*m(k[d2+0>>2]))+m(m(k[b2+4>>2])*m(k[d2+16>>2])))+m(m(m(k[b2+8>>2])*m(k[d2+32>>2]))+m(m(k[b2+12>>2])*m(k[d2+48>>2]))));n2=m(m(m(m(k[b2+0>>2])*m(k[d2+4>>2]))+m(m(k[b2+4>>2])*m(k[d2+20>>2])))+m(m(m(k[b2+8>>2])*m(k[d2+36>>2]))+m(m(k[b2+12>>2])*m(k[d2+52>>2]))));o2=m(m(m(m(k[b2+0>>2])*m(k[d2+8>>2]))+m(m(k[b2+4>>2])*m(k[d2+24>>2])))+m(m(m(k[b2+8>>2])*m(k[d2+40>>2]))+m(m(k[b2+12>>2])*m(k[d2+56>>2]))));p2=m(m(m(m(k[b2+0>>2])*m(k[d2+12>>2]))+m(m(k[b2+4>>2])*m(k[d2+28>>2])))+m(m(m(k[b2+8>>2])*m(k[d2+44>>2]))+m(m(k[b2+12>>2])*m(k[d2+60>>2]))));q2=m(m(m(m(k[b2+16>>2])*m(k[d2+0>>2]))+m(m(k[b2+20>>2])*m(k[d2+16>>2])))+m(m(m(k[b2+24>>2])*m(k[d2+32>>2]))+m(m(k[b2+28>>2])*m(k[d2+48>>2]))));r2=m(m(m(m(k[b2+16>>2])*m(k[d2+4>>2]))+m(m(k[b2+20>>2])*m(k[d2+20>>2])))+m(m(m(k[b2+24>>2])*m(k[d2+36>>2]))+m(m(k[b2+28>>2])*m(k[d2+52>>2]))));s2=m(m(m(m(k[b2+16>>2])*m(k[d2+8>>2]))+m(m(k[b2+20>>2])*m(k[d2+24>>2])))+m(m(m(k[b2+24>>2])*m(k[d2+40>>2]))+m(m(k[b2+28>>2])*m(k[d2+56>>2]))));t2=m(m(m(m(k[b2+16>>2])*m(k[d2+12>>2]))+m(m(k[b2+20>>2])*m(k[d2+28>>2])))+m(m(m(k[b2+24>>2])*m(k[d2+44>>2]))+m(m(k[b2+28>>2])*m(k[d2+60>>2]))));u2=m(m(m(m(k[b2+32>>2])*m(k[d2+0>>2]))+m(m(k[b2+36>>2])*m(k[d2+16>>2])))+m(m(m(k[b2+40>>2])*m(k[d2+32>>2]))+m(m(k[b2+44>>2])*m(k[d2+48>>2]))));v2=m(m(m(m(k[b2+32>>2])*m(k[d2+4>>2]))+m(m(k[b2+36>>2])*m(k[d2+20>>2])))+m(m(m(k[b2+40>>2])*m(k[d2+36>>2]))+m(m(k[b2+44>>2])*m(k[d2+52>>2]))));w2=m(m(m(m(k[b2+32>>2])*m(k[d2+8>>2]))+m(m(k[b2+36>>2])*m(k[d2+24>>2])))+m(m(m(k[b2+40>>2])*m(k[d2+40>>2]))+m(m(k[b2+44>>2])*m(k[d2+56>>2]))));x2=m(m(m(m(k[b2+32>>2])*m(k[d2+12>>2]))+m(m(k[b2+36>>2])*m(k[d2+28>>2])))+m(m(m(k[b2+40>>2])*m(k[d2+44>>2]))+m(m(k[b2+44>>2])*m(k[d2+60>>2]))));y2=m(m(m(m(k[b2+48>>2])*m(k[d2+0>>2]))+m(m(k[b2+52>>2])*m(k[d2+16>>2])))+m(m(m(k[b2+56>>2])*m(k[d2+32>>2]))+m(m(k[b2+60>>2])*m(k[d2+48>>2]))));z2=m(m(m(m(k[b2+48>>2])*m(k[d2+4>>2]))+m(m(k[b2+52>>2])*m(k[d2+20>>2])))+m(m(m(k[b2+56>>2])*m(k[d2+36>>2]))+m(m(k[b2+60>>2])*m(k[d2+52>>2]))));a3=m(m(m(m(k[b2+48>>2])*m(k[d2+8>>2]))+m(m(k[b2+52>>2])*m(k[d2+24>>2])))+m(m(m(k[b2+56>>2])*m(k[d2+40>>2]))+m(m(k[b2+60>>2])*m(k[d2+56>>2]))));b3=m(m(m(m(k[b2+48>>2])*m(k[d2+12>>2]))+m(m(k[b2+52>>2])*m(k[d2+28>>2])))+m(m(m(k[b2+56>>2])*m(k[d2+44>>2]))+m(m(k[b2+60>>2])*m(k[d2+60>>2]))));k[d2+0>>2]=m2;k[d2+4>>2]=n2;k[d2+8>>2]=o2;k[d2+12>>2]=p2;k[d2+16>>2]=q2;k[d2+20>>2]=r2;k[d2+24>>2]=s2;k[d2+28>>2]=t2;k[d2+32>>2]=u2;k[d2+36>>2]=v2;k[d2+40>>2]=w2;k[d2+44>>2]=x2;k[d2+48>>2]=y2;k[d2+52>>2]=z2;k[d2+56>>2]=a3;k[d2+60>>2]=b3;}function d1(d2,b2){d2=d2|0;b2=b2|0;var c3=m(0.0),d3=m(0.0),e3=m(0.0),f3=m(0.0),g3=m(0.0),h3=m(0.0),i3=m(0.0),j3=m(0.0),k3=m(0.0),l3=m(0.0),m3=m(0.0),n3=m(0.0),o3=m(0.0),p3=m(0.0),q3=m(0.0),r3=m(0.0);d2=d2<<6;b2=b2<<6;c3=m(m(m(m(k[d2+0>>2])*m(k[b2+0>>2]))+m(m(k[d2+4>>2])*m(k[b2+16>>2])))+m(m(m(k[d2+8>>2])*m(k[b2+32>>2]))+m(m(k[d2+12>>2])*m(k[b2+48>>2]))));d3=m(m(m(m(k[d2+0>>2])*m(k[b2+4>>2]))+m(m(k[d2+4>>2])*m(k[b2+20>>2])))+m(m(m(k[d2+8>>2])*m(k[b2+36>>2]))+m(m(k[d2+12>>2])*m(k[b2+52>>2]))));e3=m(m(m(m(k[d2+0>>2])*m(k[b2+8>>2]))+m(m(k[d2+4>>2])*m(k[b2+24>>2])))+m(m(m(k[d2+8>>2])*m(k[b2+40>>2]))+m(m(k[d2+12>>2])*m(k[b2+56>>2]))));f3=m(m(m(m(k[d2+0>>2])*m(k[b2+12>>2]))+m(m(k[d2+4>>2])*m(k[b2+28>>2])))+m(m(m(k[d2+8>>2])*m(k[b2+44>>2]))+m(m(k[d2+12>>2])*m(k[b2+60>>2]))));g3=m(m(m(m(k[d2+16>>2])*m(k[b2+0>>2]))+m(m(k[d2+20>>2])*m(k[b2+16>>2])))+m(m(m(k[d2+24>>2])*m(k[b2+32>>2]))+m(m(k[d2+28>>2])*m(k[b2+48>>2]))));h3=m(m(m(m(k[d2+16>>2])*m(k[b2+4>>2]))+m(m(k[d2+20>>2])*m(k[b2+20>>2])))+m(m(m(k[d2+24>>2])*m(k[b2+36>>2]))+m(m(k[d2+28>>2])*m(k[b2+52>>2]))));i3=m(m(m(m(k[d2+16>>2])*m(k[b2+8>>2]))+m(m(k[d2+20>>2])*m(k[b2+24>>2])))+m(m(m(k[d2+24>>2])*m(k[b2+40>>2]))+m(m(k[d2+28>>2])*m(k[b2+56>>2]))));j3=m(m(m(m(k[d2+16>>2])*m(k[b2+12>>2]))+m(m(k[d2+20>>2])*m(k[b2+28>>2])))+m(m(m(k[d2+24>>2])*m(k[b2+44>>2]))+m(m(k[d2+28>>2])*m(k[b2+60>>2]))));k3=m(m(m(m(k[d2+32>>2])*m(k[b2+0>>2]))+m(m(k[d2+36>>2])*m(k[b2+16>>2])))+m(m(m(k[d2+40>>2])*m(k[b2+32>>2]))+m(m(k[d2+44>>2])*m(k[b2+48>>2]))));l3=m(m(m(m(k[d2+32>>2])*m(k[b2+4>>2]))+m(m(k[d2+36>>2])*m(k[b2+20>>2])))+m(m(m(k[d2+40>>2])*m(k[b2+36>>2]))+m(m(k[d2+44>>2])*m(k[b2+52>>2]))));m3=m(m(m(m(k[d2+32>>2])*m(k[b2+8>>2]))+m(m(k[d2+36>>2])*m(k[b2+24>>2])))+m(m(m(k[d2+40>>2])*m(k[b2+40>>2]))+m(m(k[d2+44>>2])*m(k[b2+56>>2]))));n3=m(m(m(m(k[d2+32>>2])*m(k[b2+12>>2]))+m(m(k[d2+36>>2])*m(k[b2+28>>2])))+m(m(m(k[d2+40>>2])*m(k[b2+44>>2]))+m(m(k[d2+44>>2])*m(k[b2+60>>2]))));o3=m(m(m(m(k[d2+48>>2])*m(k[b2+0>>2]))+m(m(k[d2+52>>2])*m(k[b2+16>>2])))+m(m(m(k[d2+56>>2])*m(k[b2+32>>2]))+m(m(k[d2+60>>2])*m(k[b2+48>>2]))));p3=m(m(m(m(k[d2+48>>2])*m(k[b2+4>>2]))+m(m(k[d2+52>>2])*m(k[b2+20>>2])))+m(m(m(k[d2+56>>2])*m(k[b2+36>>2]))+m(m(k[d2+60>>2])*m(k[b2+52>>2]))));q3=m(m(m(m(k[d2+48>>2])*m(k[b2+8>>2]))+m(m(k[d2+52>>2])*m(k[b2+24>>2])))+m(m(m(k[d2+56>>2])*m(k[b2+40>>2]))+m(m(k[d2+60>>2])*m(k[b2+56>>2]))));r3=m(m(m(m(k[d2+48>>2])*m(k[b2+12>>2]))+m(m(k[d2+52>>2])*m(k[b2+28>>2])))+m(m(m(k[d2+56>>2])*m(k[b2+44>>2]))+m(m(k[d2+60>>2])*m(k[b2+60>>2]))));k[d2+0>>2]=c3;k[d2+4>>2]=d3;k[d2+8>>2]=e3;k[d2+12>>2]=f3;k[d2+16>>2]=g3;k[d2+20>>2]=h3;k[d2+24>>2]=i3;k[d2+28>>2]=j3;k[d2+32>>2]=k3;k[d2+36>>2]=l3;k[d2+40>>2]=m3;k[d2+44>>2]=n3;k[d2+48>>2]=o3;k[d2+52>>2]=p3;k[d2+56>>2]=q3;k[d2+60>>2]=r3;}function g1(f2,g2,h2,i2){f2=f2|0;g2= +g2;h2= +h2;i2= +i2;var s3=0.0,t3=0.0,u3=0.0,v3=0.0;f2=f2<<6;s3=((g2*  +k[f2+0>>2]+h2*  +k[f2+16>>2])+i2*  +k[f2+32>>2])+  +k[f2+48>>2];t3=((g2*  +k[f2+4>>2]+h2*  +k[f2+20>>2])+i2*  +k[f2+36>>2])+  +k[f2+52>>2];u3=((g2*  +k[f2+8>>2]+h2*  +k[f2+24>>2])+i2*  +k[f2+40>>2])+  +k[f2+56>>2];v3=((g2*  +k[f2+12>>2]+h2*  +k[f2+28>>2])+i2*  +k[f2+44>>2])+  +k[f2+60>>2];k[f2+48>>2]=m(s3);k[f2+52>>2]=m(t3);k[f2+56>>2]=m(u3);k[f2+60>>2]=m(v3);}function l1(f2,g2,h2,i2){f2=f2|0;g2= +g2;h2= +h2;i2= +i2;f2=f2<<6;k[f2+0>>2]=m(g2*  +k[f2+0>>2]);k[f2+4>>2]=m(g2*  +k[f2+4>>2]);k[f2+8>>2]=m(g2*  +k[f2+8>>2]);k[f2+12>>2]=m(g2*  +k[f2+12>>2]);k[f2+16>>2]=m(h2*  +k[f2+16>>2]);k[f2+20>>2]=m(h2*  +k[f2+20>>2]);k[f2+24>>2]=m(h2*  +k[f2+24>>2]);k[f2+28>>2]=m(h2*  +k[f2+28>>2]);k[f2+32>>2]=m(i2*  +k[f2+32>>2]);k[f2+36>>2]=m(i2*  +k[f2+36>>2]);k[f2+40>>2]=m(i2*  +k[f2+40>>2]);k[f2+44>>2]=m(i2*  +k[f2+44>>2]);}function q1(d2,s1,g2,h2,i2){d2=d2|0;s1= +s1;g2= +g2;h2= +h2;i2= +i2;var w3=0.0,x3=0.0,y3=0.0,z3=0.0,a4=0.0,b4=0.0,c4=0.0;d2=d2<<6;x3=g2*g2;y3=h2*h2;z3=i2*i2;w3=r((x3+y3)+z3);a4=p(s1);b4=o(s1);c4=1.0-a4;g2=g2/w3;h2=h2/w3;i2=i2/w3;k[d2+0>>2]=m(a4+x3*c4);k[d2+4>>2]=m((g2*h2)*c4+i2*b4);k[d2+8>>2]=m((g2*i2)*c4-h2*b4);k[d2+12>>2]=m(0.0);k[d2+16>>2]=m((g2*h2)*c4-i2*b4);k[d2+20>>2]=m(a4+y3*c4);k[d2+24>>2]=m((h2*i2)*c4+g2*b4);k[d2+28>>2]=m(0.0);k[d2+32>>2]=m((g2*i2)*c4+h2*b4);k[d2+36>>2]=m((h2*i2)*c4-g2*b4);k[d2+40>>2]=m(a4+z3*c4);k[d2+44>>2]=m(0.0);k[d2+48>>2]=m(0.0);k[d2+52>>2]=m(0.0);k[d2+56>>2]=m(0.0);k[d2+60>>2]=m(1.0);}function w1(d2,b2){d2=d2|0;b2=b2|0;var d4=0;d2=d2<<6;b2=b2<<6;for(;(d4|0)<64;d4=(d4|0)+4|0)k[d2+d4>>2]=m(k[b2+d4>>2]);}function z1(d2,b2){d2=d2|0;b2=b2|0;var e4=0.0,f4=0.0;var g4=0.0,h4=0.0,i4=0.0,j4=0.0,k4=0.0,l4=0.0;var m4=0.0,n4=0.0,o4=0.0,p4=0.0,q4=0.0,r4=0.0;d2=d2<<6;b2=b2<<6;if( +k[b2+12>>2]==0.0)if( +k[b2+28>>2]==0.0)if( +k[b2+44>>2]==0.0){g4= +k[b2+20>>2]*  +k[b2+40>>2]- +k[b2+36>>2]*  +k[b2+24>>2];h4= +k[b2+36>>2]*  +k[b2+8>>2]- +k[b2+4>>2]*  +k[b2+40>>2];i4= +k[b2+4>>2]*  +k[b2+24>>2]- +k[b2+20>>2]*  +k[b2+8>>2];f4=(g4*  +k[b2+0>>2]+h4*  +k[b2+16>>2])+i4*  +k[b2+32>>2];if(-2.38e-7<=f4&&f4<=2.38e-7)return 0;e4= +1/f4;k[d2+0>>2]=m(g4*e4);k[d2+4>>2]=m(h4*e4);k[d2+8>>2]=m(i4*e4);k[d2+16>>2]=m(( +k[b2+32>>2]*  +k[b2+24>>2]- +k[b2+16>>2]*  +k[b2+40>>2])*e4);k[d2+20>>2]=m(( +k[b2+0>>2]*  +k[b2+40>>2]- +k[b2+32>>2]*  +k[b2+8>>2])*e4);k[d2+24>>2]=m(( +k[b2+16>>2]*  +k[b2+8>>2]- +k[b2+0>>2]*  +k[b2+24>>2])*e4);k[d2+32>>2]=m(( +k[b2+16>>2]*  +k[b2+36>>2]- +k[b2+32>>2]*  +k[b2+20>>2])*e4);k[d2+36>>2]=m(( +k[b2+32>>2]*  +k[b2+4>>2]- +k[b2+0>>2]*  +k[b2+36>>2])*e4);k[d2+40>>2]=m(( +k[b2+0>>2]*  +k[b2+20>>2]- +k[b2+16>>2]*  +k[b2+4>>2])*e4);k[d2+48>>2]=m(-(( +k[d2+0>>2]*  +k[b2+48>>2]+ +k[d2+16>>2]*  +k[b2+52>>2])+ +k[d2+32>>2]*  +k[b2+56>>2]));k[d2+52>>2]=m(-(( +k[d2+4>>2]*  +k[b2+48>>2]+ +k[d2+20>>2]*  +k[b2+52>>2])+ +k[d2+36>>2]*  +k[b2+56>>2]));k[d2+56>>2]=m(-(( +k[d2+8>>2]*  +k[b2+48>>2]+ +k[d2+24>>2]*  +k[b2+52>>2])+ +k[d2+40>>2]*  +k[b2+56>>2]));k[d2+12>>2]=m(0.0);k[d2+28>>2]=m(0.0);k[d2+44>>2]=m(0.0);k[d2+60>>2]=m(1.0);return 1;}g4= +k[b2+0>>2]*  +k[b2+20>>2]- +k[b2+4>>2]*  +k[b2+16>>2];h4= +k[b2+0>>2]*  +k[b2+36>>2]- +k[b2+4>>2]*  +k[b2+32>>2];i4= +k[b2+0>>2]*  +k[b2+52>>2]- +k[b2+4>>2]*  +k[b2+48>>2];j4= +k[b2+16>>2]*  +k[b2+36>>2]- +k[b2+20>>2]*  +k[b2+32>>2];k4= +k[b2+16>>2]*  +k[b2+52>>2]- +k[b2+20>>2]*  +k[b2+48>>2];l4= +k[b2+32>>2]*  +k[b2+52>>2]- +k[b2+36>>2]*  +k[b2+48>>2];r4= +k[b2+40>>2]*  +k[b2+60>>2]- +k[b2+44>>2]*  +k[b2+56>>2];q4= +k[b2+24>>2]*  +k[b2+60>>2]- +k[b2+28>>2]*  +k[b2+56>>2];p4= +k[b2+24>>2]*  +k[b2+44>>2]- +k[b2+28>>2]*  +k[b2+40>>2];o4= +k[b2+8>>2]*  +k[b2+60>>2]- +k[b2+12>>2]*  +k[b2+56>>2];n4= +k[b2+8>>2]*  +k[b2+44>>2]- +k[b2+12>>2]*  +k[b2+40>>2];m4= +k[b2+8>>2]*  +k[b2+28>>2]- +k[b2+12>>2]*  +k[b2+24>>2];f4=((((g4*r4-h4*q4)+i4*p4)+j4*o4)-k4*n4)+l4*m4;if(-2.38e-7<=f4&&f4<=2.38e-7)return 0;e4= +1/f4;k[d2+0>>2]=(( +k[b2+20>>2]*r4- +k[b2+36>>2]*q4)+ +k[b2+52>>2]*p4)*e4;k[d2+16>>2]=((- +k[b2+16>>2]*r4+ +k[b2+32>>2]*q4)- +k[b2+48>>2]*p4)*e4;k[d2+32>>2]=(( +k[b2+28>>2]*l4- +k[b2+44>>2]*k4)+ +k[b2+60>>2]*j4)*e4;k[d2+48>>2]=((- +k[b2+24>>2]*l4+ +k[b2+40>>2]*k4)- +k[b2+56>>2]*j4)*e4;k[d2+4>>2]=((- +k[b2+4>>2]*r4+ +k[b2+36>>2]*o4)- +k[b2+52>>2]*n4)*e4;k[d2+20>>2]=(( +k[b2+0>>2]*r4- +k[b2+32>>2]*o4)+ +k[b2+48>>2]*n4)*e4;k[d2+36>>2]=((- +k[b2+12>>2]*l4+ +k[b2+44>>2]*i4)- +k[b2+60>>2]*h4)*e4;k[d2+52>>2]=(( +k[b2+8>>2]*l4- +k[b2+40>>2]*i4)+ +k[b2+56>>2]*h4)*e4;k[d2+8>>2]=(( +k[b2+4>>2]*q4- +k[b2+20>>2]*o4)+ +k[b2+52>>2]*m4)*e4;k[d2+24>>2]=((- +k[b2+0>>2]*q4+ +k[b2+16>>2]*o4)- +k[b2+48>>2]*m4)*e4;k[d2+40>>2]=(( +k[b2+12>>2]*k4- +k[b2+28>>2]*i4)+ +k[b2+60>>2]*g4)*e4;k[d2+56>>2]=((- +k[b2+8>>2]*k4+ +k[b2+24>>2]*i4)- +k[b2+56>>2]*g4)*e4;k[d2+12>>2]=((- +k[b2+4>>2]*p4+ +k[b2+20>>2]*n4)- +k[b2+36>>2]*m4)*e4;k[d2+28>>2]=(( +k[b2+0>>2]*p4- +k[b2+16>>2]*n4)+ +k[b2+32>>2]*m4)*e4;k[d2+44>>2]=((- +k[b2+12>>2]*j4+ +k[b2+28>>2]*h4)- +k[b2+44>>2]*g4)*e4;k[d2+60>>2]=(( +k[b2+8>>2]*j4- +k[b2+24>>2]*h4)+ +k[b2+40>>2]*g4)*e4;return 1;}function c2(d2){d2=d2|0;var s4=m(0.0);d2=d2<<6;s4=m(k[d2+4>>2]);k[d2+4>>2]=m(k[d2+16>>2]);k[d2+16>>2]=m(s4);s4=m(k[d2+8>>2]);k[d2+8>>2]=m(k[d2+32>>2]);k[d2+32>>2]=m(s4);s4=m(k[d2+12>>2]);k[d2+12>>2]=m(k[d2+48>>2]);k[d2+48>>2]=m(s4);s4=m(k[d2+24>>2]);k[d2+24>>2]=m(k[d2+36>>2]);k[d2+36>>2]=m(s4);s4=m(k[d2+28>>2]);k[d2+28>>2]=m(k[d2+52>>2]);k[d2+52>>2]=m(s4);s4=m(k[d2+44>>2]);k[d2+44>>2]=m(k[d2+56>>2]);k[d2+56>>2]=m(s4);}function e2(f2,g2,h2,i2,j2){f2=f2|0;g2= +g2;h2= +h2;i2= +i2;j2= +j2;var t4=0.0,u4=0.0,v4=0.0,w4=0.0;f2=f2<<6;t4=((g2*  +k[f2+0>>2]+h2*  +k[f2+16>>2])+i2*  +k[f2+32>>2])+j2*  +k[f2+48>>2];u4=((g2*  +k[f2+4>>2]+h2*  +k[f2+20>>2])+i2*  +k[f2+36>>2])+j2*  +k[f2+52>>2];v4=((g2*  +k[f2+8>>2]+h2*  +k[f2+24>>2])+i2*  +k[f2+40>>2])+j2*  +k[f2+56>>2];w4=((g2*  +k[f2+12>>2]+h2*  +k[f2+28>>2])+i2*  +k[f2+44>>2])+j2*  +k[f2+60>>2];k[0>>2]=m(t4);k[4>>2]=m(u4);k[8>>2]=m(v4);k[12>>2]=m(w4);}return {identity:s,perspective:u,rotation:q1,translate:g1,scale:l1,lmul:d1,rmul:a1,copy:w1,invert:z1,transpose:c2,transform:e2};}function e(){var x4=65536;var y4=new ArrayBuffer(x4);var z4=new Float32Array(y4,0,x4>>4);var a5=new a(window,null,y4);var b5=1;a5.identity(1);this.identity=function(){a5.identity(b5);};this.perspective=function(fieldOfView,aspectRatio,near,far){a5.perspective(b5,((2*Math.PI)*fieldOfView)/360.0,aspectRatio,near,far);};this.translate=function(g,y,z){a5.translate(b5,g,y,z);};this.scale=function(g,y,z){a5.scale(b5,g,y,z);};this.rotate=function(deg,vector){a5.rotation(0,((2*Math.PI)*deg)/360.0,vector[0],vector[1],vector[2]);a5.rmul(b5,0);};this.push=function(){if(b5+1==x4>>6)throw {error:'too many matrices on stack'};a5.copy(b5+1,b5);b5++;};this.pop=function(){if(b5<2)throw {error:'nothing to pop'};b5--;};this.swap=function(){if(b5<2)throw {error:'nothing to swap'};a5.copy(0,b5);a5.copy(b5,b5-1);a5.copy(b5-1,0);};this.copyDown=function(){a5.copy(b5,b5-1);};this.mul=function(){if(b5<2)throw {error:'too few matrices on stack to multiply'};a5.rmul(b5-1,b5);b5--;};this.lmul=function(){if(b5<2)throw {error:'too few matrices on stack to multiply'};a5.lmul(b5-1,b5);b5--;};this.det=function(){var c5=b5<<4;var d5=z4[c5+5]*z4[c5+10]-z4[c5+9]*z4[c5+6];var e5=z4[c5+1]*z4[c5+10]-z4[c5+2]*z4[c5+9];var f5=z4[c5+1]*z4[c5+6]-z4[c5+5]*z4[c5+2];return (d5*z4[c5+0]-e5*z4[c5+4])+f5*z4[c5+8];};this.transform=function(g,y,z,w){if((y==undefined&&z==undefined)&&w==undefined){var g5=1;if(g.length==4)g5=g[3];a5.transform(b5,g[0],g[1],g[2],g5);if(g.length==4)return [z4[0],z4[1],z4[2],z4[3]];return [z4[0]/z4[3],z4[1]/z4[3],z4[2]/z4[3]];} else {if(w!=undefined){a5.transform(b5,g,y,z,w);return [z4[0],z4[1],z4[2],z4[3]];} else {a5.transform(b5,g,y,z,1);return [z4[0]/z4[3],z4[1]/z4[3],z4[2]/z4[3]];}}return [z4[0],z4[1],z4[2]];};this.invert=function(){if(!a5.invert(0,b5))return false;a5.copy(b5,0);return true;};this.transpose=function(){a5.transpose(b5);};this.qrDecompose=function(){this.push();var h5=b5<<4;a5.identity(b5-1);var s5=z4[(h5+4*0)+0],t5=z4[(h5+4*0)+1],u5=z4[(h5+4*0)+2],v5=z4[(h5+4*0)+3];var w5=Math.sqrt(((s5*s5+t5*t5)+u5*u5)+v5*v5);if(w5>0){var x5=[s5,t5,u5,v5];if(s5>=0)x5[0]+=w5; else x5[0]-=w5;x5[1]/=x5[0];x5[2]/=x5[0];x5[3]/=x5[0];x5[0]=1;var y5=2/(((1+x5[1]*x5[1])+x5[2]*x5[2])+x5[3]*x5[3]);this.loadRowMajor([[1-(y5*x5[0])*x5[0],(-y5*x5[0])*x5[1],(-y5*x5[0])*x5[2],(-y5*x5[0])*x5[3]],[(-y5*x5[1])*x5[0],1-(y5*x5[1])*x5[1],(-y5*x5[1])*x5[2],(-y5*x5[1])*x5[3]],[(-y5*x5[2])*x5[0],(-y5*x5[2])*x5[1],1-(y5*x5[2])*x5[2],(-y5*x5[2])*x5[3]],[(-y5*x5[3])*x5[0],(-y5*x5[3])*x5[1],(-y5*x5[3])*x5[2],1-(y5*x5[3])*x5[3]]],b5);a5.lmul(b5,0);a5.rmul(b5-1,0);}var s5=0,t5=z4[(h5+4*1)+1],u5=z4[(h5+4*1)+2],v5=z4[(h5+4*1)+3];var w5=Math.sqrt((t5*t5+u5*u5)+v5*v5);if(w5>0){var z5=[0,t5,u5,v5];if(t5>=0)z5[1]+=w5; else z5[1]-=w5;z5[2]/=z5[1];z5[3]/=z5[1];z5[1]=1;var a6=2/(((0+1)+z5[2]*z5[2])+z5[3]*z5[3]);this.loadRowMajor([[1,0,0,0],[0,1-(a6*z5[1])*z5[1],(-a6*z5[1])*z5[2],(-a6*z5[1])*z5[3]],[0,(-a6*z5[2])*z5[1],1-(a6*z5[2])*z5[2],(-a6*z5[2])*z5[3]],[0,(-a6*z5[3])*z5[1],(-a6*z5[3])*z5[2],1-(a6*z5[3])*z5[3]]],b5);a5.lmul(b5,0);a5.rmul(b5-1,0);}var s5=0,t5=0,u5=z4[(h5+4*2)+2],v5=z4[(h5+4*2)+3];var w5=Math.sqrt(u5*u5+v5*v5);if(w5>0){var b6=[0,0,u5,v5];if(u5>=0)b6[2]+=w5; else b6[2]-=w5;b6[3]/=b6[2];b6[2]=1;var c6=2/(((0+0)+1)+b6[3]*b6[3]);this.loadRowMajor([[1,0,0,0],[0,1,0,0],[0,0,1-(c6*b6[2])*b6[2],(-c6*b6[2])*b6[3]],[0,0,(-c6*b6[3])*b6[2],1-(c6*b6[3])*b6[3]]],b5);a5.lmul(b5,0);a5.rmul(b5-1,0);}this.loadRowMajor([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,-1]],b5);a5.lmul(b5,0);a5.rmul(b5-1,0);};this.getBasisAndNullSpace=function(){this.push();this.transpose();this.qrDecompose();this.pop();var d6=this.getColMajor();this.pop();var e6=[];var f6=[];for(var g6=0;g6<d6.length;++g6){var h6=d6[g6];var i6=this.transform(h6[0],h6[1],h6[2],h6[3]);var j6=((i6[0]*i6[0]+i6[1]*i6[1])+i6[2]*i6[2])+i6[3]*i6[3];if(j6<2.38e-7)f6.push(h6); else e6.push(h6);}return {basis:e6,nulls:f6};};this.loadQuaternion=function(w,g,y,z,stackIndex){if(typeof y=='undefined'&&typeof w[1]!='undefined'){g=w[1];y=w[2];z=w[3];w=w[0];stackIndex=g;}var k6=b5-(stackIndex|0)<<4;z4[k6+0]=(1-(2*y)*y)-(2*z)*z;z4[k6+4]=(2*g)*y-(2*z)*w;z4[k6+8]=(2*g)*z+(2*y)*w;z4[k6+1]=(2*g)*y+(2*z)*w;z4[k6+5]=(1-(2*g)*g)-(2*z)*z;z4[k6+9]=(2*y)*z-(2*g)*w;z4[k6+2]=(2*g)*z-(2*y)*w;z4[k6+6]=(2*y)*z+(2*g)*w;z4[k6+10]=(1-(2*g)*g)-(2*y)*y;z4[k6+3]=0;z4[k6+7]=0;z4[k6+11]=0;z4[k6+12]=0;z4[k6+13]=0;z4[k6+14]=0;z4[k6+15]=1;};this.loadRowMajor=function(i,stackIndex){var l6=b5-(stackIndex|0)<<4;if(i instanceof e){return this.load(i,stackIndex);}if(typeof i[0]=='undefined')i=arguments;if(typeof i[0][0]!='undefined'){z4[l6+0]=i[0][0];z4[l6+4]=i[0][1];z4[l6+8]=i[0][2];z4[l6+12]=i[0][3];z4[l6+1]=i[1][0];z4[l6+5]=i[1][1];z4[l6+9]=i[1][2];z4[l6+13]=i[1][3];z4[l6+2]=i[2][0];z4[l6+6]=i[2][1];z4[l6+10]=i[2][2];z4[l6+14]=i[2][3];z4[l6+3]=i[3][0];z4[l6+7]=i[3][1];z4[l6+11]=i[3][2];z4[l6+15]=i[3][3];} else {z4[l6+0]=i[0];z4[l6+4]=i[1];z4[l6+8]=i[2];z4[l6+12]=i[3];z4[l6+1]=i[4];z4[l6+5]=i[5];z4[l6+9]=i[6];z4[l6+13]=i[7];z4[l6+2]=i[8];z4[l6+6]=i[9];z4[l6+10]=i[10];z4[l6+14]=i[11];z4[l6+3]=i[12];z4[l6+7]=i[13];z4[l6+11]=i[14];z4[l6+15]=i[15];}};this.load=this.loadColMajor=function(i,stackIndex){var m6=b5-(stackIndex|0)<<4;if(i instanceof e)i=i.getData();if(typeof i[0]=='undefined')i=arguments;if(typeof i[0][0]!='undefined'){z4[m6+0]=i[0][0];z4[m6+4]=i[1][0];z4[m6+8]=i[2][0];z4[m6+12]=i[3][0];z4[m6+1]=i[0][1];z4[m6+5]=i[1][1];z4[m6+9]=i[2][1];z4[m6+13]=i[3][1];z4[m6+2]=i[0][2];z4[m6+6]=i[1][2];z4[m6+10]=i[2][2];z4[m6+14]=i[3][2];z4[m6+3]=i[0][3];z4[m6+7]=i[1][3];z4[m6+11]=i[2][3];z4[m6+15]=i[3][3];} else {z4[m6+0]=i[0];z4[m6+4]=i[4];z4[m6+8]=i[8];z4[m6+12]=i[12];z4[m6+1]=i[1];z4[m6+5]=i[5];z4[m6+9]=i[9];z4[m6+13]=i[13];z4[m6+2]=i[2];z4[m6+6]=i[6];z4[m6+10]=i[10];z4[m6+14]=i[14];z4[m6+3]=i[3];z4[m6+7]=i[7];z4[m6+11]=i[11];z4[m6+15]=i[15];}};this.getData=function(stackIndex){stackIndex=stackIndex|0;return new Float32Array(y4,b5-stackIndex<<6,64>>2);};this.getRowMajor=function(stackIndex){var n6=b5-(stackIndex|0)<<4;return [[z4[n6+0],z4[n6+4],z4[n6+8],z4[n6+12]],[z4[n6+1],z4[n6+5],z4[n6+9],z4[n6+13]],[z4[n6+2],z4[n6+6],z4[n6+10],z4[n6+14]],[z4[n6+3],z4[n6+7],z4[n6+11],z4[n6+15]]];};this.getColMajor=function(stackIndex){var o6=b5-(stackIndex|0)<<4;return [[z4[o6+0],z4[o6+1],z4[o6+2],z4[o6+3]],[z4[o6+4],z4[o6+5],z4[o6+6],z4[o6+7]],[z4[o6+8],z4[o6+9],z4[o6+10],z4[o6+11]],[z4[o6+12],z4[o6+13],z4[o6+14],z4[o6+15]]];};this.reset=function(){b5=1;this.identity();};Object.defineProperty(this,'length',{get:function(){return b5;}});}function f(g){var p6=g.toFixed(2);if(g>0)return ' '+p6;return p6;}function h(i,j){console.log(Array.from(i.getData(j)).map(f).join(', '));}e.debugDumpMatrix=h;if(typeof window!='undefined'&&typeof window.Math.fround=='undefined')window.Math.fround=function(g){return g;};if(typeof window!='undefined'&&typeof window.Math.imul=='undefined')window.Math.imul=function(g,y){return g*y;};return e;})();renderjs.MatrixStack=MatrixStack;var Bezier=(function(){var q6=400;var r6=function(duration){return 1.0/(200.0*duration);};var s6=function(p1x,p1y,p2x,p2y){var t6=3.0*p1x;var u6=3.0*(p2x-p1x)-t6;var v6=(1.0-t6)-u6;var w6=3.0*p1y;var x6=3.0*(p2y-p1y)-w6;var y6=(1.0-w6)-x6;var z6=function(t){return ((v6*t+u6)*t+t6)*t;};var a7=function(t){return ((y6*t+x6)*t+w6)*t;};var b7=function(t){return ((3.0*v6)*t+2.0*u6)*t+t6;};var c7=function(x,epsilon){var e7;var f7;var g7;var h7;var i7;var j7;for(g7=x,j7=0;j7<8;j7++){h7=z6(g7)-x;if(Math.abs(h7)<epsilon){return g7;}i7=b7(g7);if(Math.abs(i7)<1e-6){break;}g7=g7-h7/i7;}e7=0.0;f7=1.0;g7=x;if(g7<e7){return e7;}if(g7>f7){return f7;}while(e7<f7){h7=z6(g7);if(Math.abs(h7-x)<epsilon){return g7;}if(x>h7){e7=g7;} else {f7=g7;}g7=(f7-e7)*0.5+e7;}return g7;};var d7=function(x,epsilon){return a7(c7(x,epsilon));};return function(x,duration){return d7(x,r6( +duration||q6));};};return {linear:s6(0.0,0.0,1.0,1.0),ease:s6(0.25,0.1,0.25,1.0),easeIn:s6(0.42,0,1.0,1.0),easeOut:s6(0,0,0.58,1.0),easeInOut:s6(0.42,0,0.58,1.0),cubicBezier:function(p1x,p1y,p2x,p2y,x,duration){return s6(p1x,p1y,p2x,p2y)(x,duration);}};})();renderjs.Bezier=Bezier;var Geometry=(function(){function k7(l7,m7,n7){if((l7!=undefined&&m7==undefined)&&n7==undefined){this.x=l7.x||l7[0];this.y=l7.y||l7[1];this.z=l7.z||l7[2];} else {this.x= +(l7||0);this.y= +(m7||0);this.z= +(n7||0);}}Object.defineProperty(k7.prototype,0,{get:function(){return this.x;},set:function(l7){this.x=l7;}});Object.defineProperty(k7.prototype,1,{get:function(){return this.y;},set:function(m7){this.y=m7;}});Object.defineProperty(k7.prototype,2,{get:function(){return this.z;},set:function(n7){this.z=n7;}});Object.defineProperty(k7.prototype,'length',{get:function(){return Math.sqrt((this.x*this.x+this.y*this.y)+this.z*this.z);},set:function(newLength){var d9=this.length;this.x*=newLength/d9;this.y*=newLength/d9;this.z*=newLength/d9;}});Object.defineProperty(k7.prototype,'direction',{get:function(){var e9=this.length;return new k7(this.x/e9,this.y/e9,this.z/e9);},set:function(newDirection){var f9=this.length;var g9=newDirection.length;this.x=(newDirection.x*f9)/g9;this.y=(newDirection.y*f9)/g9;this.z=(newDirection.z*f9)/g9;}});Object.defineProperty(k7.prototype,'reverse',{get:function(){return new k7(-this.x,-this.y,-this.z);}});k7.prototype.multiply=function(s){this.x*=s;this.y*=s;this.z*=s;return this;};k7.prototype.dot=function(other){return (this.x*other.x+this.y*other.y)+this.z*other.z;};k7.dot=function(v1,v2){return (v1.x*v2.x+v1.y*v2.y)+v1.z*v2.z;};k7.prototype.colinearWith=function(that){var h9=k7.dot(this,this);var i9=k7.dot(that,that);var j9=h9*i9;var k9=k7.dot(this,that);return k9*k9-j9<2.38e-7;};k7.prototype.add=function(other){this.x+=other.x;this.y+=other.y;this.z+=other.z;return this;};k7.add=function(v1,v2){return new k7(v1.x+v2.x,v1.y+v2.y,v1.z+v2.z);};k7.prototype.subtract=function(other){this.x-=other.x;this.y-=other.y;this.z-=other.z;return this;};k7.subtract=function(v1,v2){return new k7(v1.x-v2.x,v1.y-v2.y,v1.z-v2.z);};k7.prototype.cross=function(other){return new k7(this.y*other.z-this.z*other.y,this.z*other.x-this.x*other.y,this.x*other.y-this.y*other.x);};function o7(p7,q7){if(typeof p7!='undefined'&&(p7 instanceof o7 || p7.length==2)){this.re=p7[0];this.im=p7[1];} else {this.re= +(p7||0);this.im= +(q7||0);}}Object.defineProperty(o7.prototype,'0',{get:function(){return this.re;}});Object.defineProperty(o7.prototype,'1',{get:function(){return this.im;}});o7.add=function(a,b){if(a instanceof o7){if(b instanceof o7)return new o7(a.re+b.re,a.im+b.im); else return new o7(a.re+b,a.im);} else {if(b instanceof o7)return new o7(a+b.re,b.im); else return new o7(a+b,0);}};o7.sub=function(a,b){if(a instanceof o7){if(b instanceof o7)return new o7(a.re-b.re,a.im-b.im); else return new o7(a.re-b,a.im);} else {if(b instanceof o7)return new o7(a-b.re,b.im); else return new o7(a-b,0);}};o7.mul=function(a,b){if(a instanceof o7){if(b instanceof o7)return new o7(a.re*b.re-a.im*b.im,a.re*b.im+a.im*b.re); else return new o7(a.re*b,a.im*b);} else {if(b instanceof o7)return new o7(a*b.re,a*b.im); else return new o7(a*b,0);}};o7.div=function(a,b){if(a instanceof o7){if(b instanceof o7){var l9=1.0/(b.re*b.re+b.im*b.im);return new o7((a.re*b.re+a.im*b.im)*l9,(a.im*b.re-a.re*b.im)*l9);} else {return new o7(a.re/b,a.im/b);}} else {if(b instanceof o7){var m9=1.0/(b.re*b.re+b.im*b.im);return new o7((a*b.re)*m9,(-a*b.im)*m9);} else {return new o7(a/b,0);}}};function r7(){var n9=arguments[0]<0?-1:arguments[0]==0?0:1;for(var o9=1;o9<arguments.length;++o9)if((arguments[o9]<0?-1:arguments[o9]==0?0:1)!=n9)return false;return true;}var s7={Polar:{project:function(l7,m7,n7){if(m7==undefined&&n7==undefined){m7=l7[1];n7=l7[2];l7=l7[0];}var p9=Math.sqrt((l7*l7+m7*m7)+n7*n7);var q9=Math.acos(m7/p9)/Math.PI;var r9=Math.atan2(l7,n7)/(2*Math.PI)+0.5;return [r9,q9];},getTextureCoordinates:function(v1,v2,v3){var s9=[s7.Polar.project(v1),s7.Polar.project(v2),s7.Polar.project(v3)];if(((v1[2]<0||v2[2]<0)||v3[2]<0)&&!r7(v1[0],v2[0],v3[0])){if(v1[0]<0)s9[0][0]+=1;if(v2[0]<0)s9[1][0]+=1;if(v3[0]<0)s9[2][0]+=1;}if(v1[1]==1||v1[1]== -1){s9[0][0]=(s9[1][0]+s9[2][0])/2;s9[0][1]=v1[1]==1?0:1;} else if(v2[1]==1||v2[1]== -1){s9[1][0]=(s9[0][0]+s9[2][0])/2;s9[1][1]=v2[1]==1?0:1;} else if(v3[1]==1||v3[1]== -1){s9[2][0]=(s9[0][0]+s9[1][0])/2;s9[2][1]=v3[1]==1?0:1;}return s9;}},Mercator:{project:function(l7,m7,n7){if(m7==undefined&&n7==undefined){m7=l7[1];n7=l7[2];l7=l7[0];}var t9=Math.sqrt((l7*l7+m7*m7)+n7*n7);var u9,v9;u9=Math.asin(m7/t9);v9=Math.atan2(l7,n7);var w9=v9/(2*Math.PI)+0.5;var x9=0.5-Math.log(Math.tan((u9+Math.PI/2)/2))/(2*Math.PI);return [w9,x9];},getTextureCoordinates:function(v1,v2,v3){var y9=[s7.Mercator.project(v1),s7.Mercator.project(v2),s7.Mercator.project(v3)];if(((v1[2]<0||v2[2]<0)||v3[2]<0)&&!r7(v1[0],v2[0],v3[0])){if(v1[0]<0)y9[0][0]+=1;if(v2[0]<0)y9[1][0]+=1;if(v3[0]<0)y9[2][0]+=1;}if(v1[1]==1||v1[1]== -1){y9[0][0]=(y9[1][0]+y9[2][0])/2;y9[0][1]=v1[1]==1?0:1;} else if(v2[1]==1||v2[1]== -1){y9[1][0]=(y9[0][0]+y9[2][0])/2;y9[1][1]=v2[1]==1?0:1;} else if(v3[1]==1||v3[1]== -1){y9[2][0]=(y9[0][0]+y9[1][0])/2;y9[2][1]=v3[1]==1?0:1;}return y9;}},HammerAitoff:{project:function(l7,m7,n7,outer){if(m7==undefined&&n7==undefined){m7=l7[1];n7=l7[2];l7=l7[0];}var z9=Math.sqrt((l7*l7+m7*m7)+n7*n7);var a10,b10;a10=Math.asin(m7/z9);b10=Math.atan2(l7,n7);if(outer&&b10<0){b10=b10+2*Math.PI;}var c10=Math.sqrt(1+Math.cos(a10)*Math.cos(b10/2));var d10=(Math.cos(a10)*Math.sin(b10/2))/c10;var e10=Math.sin(a10)/c10;return [(d10+1)/2,(1-e10)/2];},getTextureCoordinates:function(v1,v2,v3){var f10=[s7.HammerAitoff.project(v1),s7.HammerAitoff.project(v2),s7.HammerAitoff.project(v3)];if(!r7(v1[0],v2[0],v3[0])){var j10=v1[0]*(v2[2]-v1[2])-v1[2]*(v2[0]-v1[0]);var k10=v2[0]*(v3[2]-v2[2])-v2[2]*(v3[0]-v2[0]);var l10=v3[0]*(v1[2]-v3[2])-v3[2]*(v1[0]-v3[0]);var m10=((((j10<0&&k10<0)&&l10<0||(j10>=0&&k10>=0)&&l10>=0)||v1[0]==0&&v1[2]==0)||v2[0]==0&&v2[2]==0)||v3[0]==0&&v3[2]==0;if(m10){} else if((v1[2]<0||v2[2]<0)||v3[2]<0){if(v1[0]==0){if(v2[0]<0)f10[1]=s7.HammerAitoff.project(v2[0],v2[1],v2[2],true);if(v3[0]<0)f10[2]=s7.HammerAitoff.project(v3[0],v3[1],v3[2],true);}if(v2[0]==0){if(v1[0]<0)f10[0]=s7.HammerAitoff.project(v1[0],v1[1],v1[2],true);if(v3[0]<0)f10[2]=s7.HammerAitoff.project(v3[0],v3[1],v3[2],true);}if(v3[0]==0){if(v1[0]<0)f10[0]=s7.HammerAitoff.project(v1[0],v1[1],v1[2],true);if(v2[0]<0)f10[1]=s7.HammerAitoff.project(v2[0],v2[1],v2[2],true);}}}var g10=Math.sqrt((f10[1][0]-f10[2][0])*(f10[1][0]-f10[2][0])+(f10[1][1]-f10[2][1])*(f10[1][1]-f10[2][1]));var h10=Math.sqrt((f10[0][0]-f10[2][0])*(f10[0][0]-f10[2][0])+(f10[0][1]-f10[2][1])*(f10[0][1]-f10[2][1]));var i10=Math.sqrt((f10[0][0]-f10[1][0])*(f10[0][0]-f10[1][0])+(f10[0][1]-f10[1][1])*(f10[0][1]-f10[1][1]));if((g10>0.5||h10>0.5)||i10>0.5){console.log((((g10+',')+h10)+',')+i10);}return f10;}}};function t7(a9){var n10=[];for(var p10=0;p10<a9.vertices.length;++p10)n10.push([]);for(var p10=0;p10<a9.faces.length;++p10){if(n10[a9.faces[p10][0]].indexOf(a9.faces[p10][1])<0)n10[a9.faces[p10][0]].push(a9.faces[p10][1]);if(n10[a9.faces[p10][1]].indexOf(a9.faces[p10][2])<0)n10[a9.faces[p10][1]].push(a9.faces[p10][2]);if(n10[a9.faces[p10][2]].indexOf(a9.faces[p10][0])<0)n10[a9.faces[p10][2]].push(a9.faces[p10][0]);if(n10[a9.faces[p10][1]].indexOf(a9.faces[p10][0])<0)n10[a9.faces[p10][1]].push(a9.faces[p10][0]);if(n10[a9.faces[p10][0]].indexOf(a9.faces[p10][2])<0)n10[a9.faces[p10][0]].push(a9.faces[p10][2]);if(n10[a9.faces[p10][2]].indexOf(a9.faces[p10][1])<0)n10[a9.faces[p10][2]].push(a9.faces[p10][1]);}return n10;}function v7(b9){var q10=0;var r10=0;var s10=0;for(var t10=0;t10<b9.length;++t10){q10=q10+b9[t10][0];r10=r10+b9[t10][1];s10=s10+b9[t10][2];}var u10=Math.sqrt((q10*q10+r10*r10)+s10*s10);if(u10==0)return [0,0,1];return [q10/u10,r10/u10,s10/u10];}function x7(a9){var v10=[];for(var y10=0;y10<a9.vertices.length;++y10)v10.push([]);for(var y10=0;y10<a9.faces.length;++y10){var z10=a9.vertices[a9.faces[y10][0]];var a11=a9.vertices[a9.faces[y10][1]];var b11=a9.vertices[a9.faces[y10][2]];var c11=a11[0]-z10[0],d11=a11[1]-z10[1],e11=a11[2]-z10[2];var f11=b11[0]-a11[0],g11=b11[1]-a11[1],h11=b11[2]-a11[2];var i11=d11*h11-e11*g11;var j11=e11*f11-c11*h11;var k11=c11*g11-d11*f11;var l11=Math.sqrt((i11*i11+j11*j11)+k11*k11);var m11=[i11/l11,j11/l11,k11/l11];v10[a9.faces[y10][0]].push(m11);v10[a9.faces[y10][1]].push(m11);v10[a9.faces[y10][2]].push(m11);}for(var y10=0;y10<v10.length;++y10){if(v10[y10].length==0)v10[y10]=[0,0,1]; else if(v10[y10].length==1)v10[y10]=v10[y10][0]; else v10[y10]=v7(v10[y10]);}return v10;}function z7(x8,q8,c8){var n11=(q8[0]*x8[0]+q8[1]*x8[1])+q8[2]*x8[2];var o11=Math.sqrt(c8[0]*c8[0]+c8[1]*c8[1]);var p11=[q8[0]/o11-x8[0]*n11,q8[1]/o11-x8[1]*n11,q8[2]/o11-x8[2]*n11];var q11=Math.atan2(c8[1],c8[0]);var r11=Math.cos(-q11);var s11=Math.sin(-q11);var t11=[-x8[0],-x8[1],-x8[2]];var u11=t11[0]*t11[1],v11=t11[0]*t11[2],w11=t11[1]*t11[2];var x11=new k7((p11[0]+((((p11[0]*t11[0])*t11[0]+p11[1]*u11)+p11[2]*v11)-p11[0])*(1-r11))+(p11[2]*t11[1]-p11[1]*t11[2])*s11,(p11[1]+((((p11[1]*t11[1])*t11[1]+p11[0]*u11)+p11[2]*w11)-p11[1])*(1-r11))+(p11[0]*t11[2]-p11[2]*t11[0])*s11,(p11[1]+((((p11[2]*t11[2])*t11[2]+p11[0]*v11)+p11[1]*w11)-p11[2])*(1-r11))+(p11[0]*t11[1]-p11[1]*t11[0])*s11);var y11=x8.cross(x11).multiply(c8[0]==0?c8[1]:Math.abs(c8[1]/c8[0]));return [x11,y11];}function d8(x8,f8,g8,h8,i8,j8,k8){var z11=g8*k8-j8*h8;if(z11==0){return z7(x8,f8,[g8,h8]);}z11=1/z11;var a12=[z11*(k8*f8[0]-h8*i8[0]),z11*(k8*f8[1]-h8*i8[1]),z11*(k8*f8[2]-h8*i8[2])];var b12=[z11*(g8*i8[0]-j8*f8[0]),z11*(g8*i8[1]-j8*f8[1]),z11*(g8*i8[2]-j8*f8[2])];return [a12,b12];}function l8(v8,s8){var c12=null;var d12=null;var e12=null;for(var f12=0;f12<s8.length;++f12){var g12=s8[f12][0]-v8[0];var h12=s8[f12][1]-v8[1];var i12=s8[f12][2]-v8[2];var j12=(g12*g12+h12*h12)+i12*i12;if(c12===null||j12<d12){c12=f12;d12=j12;e12=[g12,h12,i12];}}return {index:c12,vertex:s8[f12],dx:e12,lendXSq:d12};}function o8(p8,q8){var k12=null;var l12=null;var m12=0;for(var o12=0;o12<p8.length;++o12)m12+=p8[o12]*p8[o12];for(var o12=0;o12<q8.length;++o12){var p12=0;var q12=0;for(var r12=0;r12<p8.length;++r12){p12+=q8[o12][r12]*p8[r12];q12+=q8[o12][r12]*q8[o12][r12];}var s12=p12/Math.sqrt(q12*m12);if(k12===null||Math.abs(s12)<Math.abs(l12)){k12=o12;l12=s12;}}return {index:k12,dx:q8[k12],cosT:l12};}function r8(s8,t8,u8,v8,w8,x8,y8){if(u8.length<3)throw {error:'require at least 3 neighbours to use least-squares'};if(u8.length==3){var f13=new k7(s8[u8[0]]).subtract(v8);var g13=new k7(s8[u8[1]]).subtract(v8);var h13=new k7(s8[u8[2]]).subtract(v8);var i13=[t8[u8[0]][0]-w8[0],t8[u8[0]][1]-w8[1]];var j13=[t8[u8[1]][0]-w8[0],t8[u8[1]][1]-w8[1]];var k13=[t8[u8[2]][0]-w8[0],t8[u8[2]][1]-w8[1]];if(new k7(f13).add(g13).colinearWith(h13))return d8(x8,f13,i13[0],i13[1],g13,j13[0],j13[1]);if(new k7(g13).add(h13).colinearWith(f13))return d8(x8,g13,j13[0],j13[1],h13,k13[0],k13[1]);if(new k7(h13).add(f13).colinearWith(g13))return d8(x8,h13,k13[0],k13[1],f13,i13[0],i13[1]);}if(u8.length==4){var l13=new k7(s8[u8[0]]).subtract(v8);var m13=new k7(s8[u8[1]]).subtract(v8);var n13=new k7(s8[u8[2]]).subtract(v8);var o13=new k7(s8[u8[3]]).subtract(v8);var p13=[t8[u8[0]][0]-w8[0],t8[u8[0]][1]-w8[1]];var q13=[t8[u8[1]][0]-w8[0],t8[u8[1]][1]-w8[1]];var r13=[t8[u8[2]][0]-w8[0],t8[u8[2]][1]-w8[1]];var s13=[t8[u8[3]][0]-w8[0],t8[u8[3]][1]-w8[1]];if(l13.colinearWith(m13)&&n13.colinearWith(o13))return d8(x8,l13,p13[0],p13[1],n13,r13[0],r13[1]);if(l13.colinearWith(n13)&&m13.colinearWith(o13)||l13.colinearWith(o13)&&m13.colinearWith(n13))return d8(x8,l13,p13[0],p13[1],m13,q13[0],q13[1]);}var t12=y8||new MatrixStack();var u12=0,v12=0,w12=0,x12=0,y12=0,z12=0;var a13=[0,0,0],b13=[0,0,0];for(var c13=0;c13<u8.length;++c13){var t13=s8[u8[c13]];var u13=[t13[0]-v8[0],t13[1]-v8[1],t13[2]-v8[2]];var v13=1/Math.sqrt((u13[0]*u13[0]+u13[1]*u13[1])+u13[2]*u13[2]);u12+=(u13[0]*u13[0])*v13;v12+=(u13[1]*u13[1])*v13;w12+=(u13[2]*u13[2])*v13;x12+=(u13[0]*u13[1])*v13;y12+=(u13[0]*u13[2])*v13;z12+=(u13[1]*u13[2])*v13;var w13=t8[u8[c13]];a13[0]+=(w13[0]*u13[0])*v13;a13[1]+=(w13[0]*u13[1])*v13;a13[2]+=(w13[0]*u13[2])*v13;b13[0]+=(w13[1]*u13[0])*v13;b13[1]+=(w13[1]*u13[1])*v13;b13[2]+=(w13[1]*u13[2])*v13;}t12.loadRowMajor([[u12,x12,y12,0],[x12,v12,z12,0],[y12,z12,w12,0],[0,0,0,1]]);if(t12.invert()){a13=t12.transform(a13);b13=t12.transform(b13);} else {var x13=t12.getBasisAndNullSpace();if(x13.nulls.length==3){a13=[0,0,0];b13=[0,0,0];} else if(x13.nulls.length==2){var y13=l8(v8,u8.map(function(i){return s8[i];}));var z13=[t8[u8[y13.index]][0]-w8[0],t8[u8[y13.index]][1]-w8[1]];return z7(x8,y13.dx,z13);} else if(x13.nulls.length==1){var a14=u8.map(function(i){return s8[i];});var b14=u8.map(function(i){return [t8[i][0]-w8[0],t8[i][1]-w8[1]];});var c14=l8(v8,a14);var d14=o8(b14[c14.index],b14);var e14=c14.index;var f14=d14.index;var g14=d14.cosT;if(Math.abs(d14.cosT)>0.7071){for(var h14=0;h14<u8.length;++h14){if(h14==c14.index||h14==d14.index)continue;var i14=[t8[u8[h14]][0]-w8[0],t8[u8[h14][1]]-w8[1]];var j14=i14[0]*i14[0]+i14[1]*i14[1];for(var k14=h14+1;k14<u8.length;++k14){if(k14==c14.index||k14==d14.index)continue;var l14=[t8[u8[k14]][0]-w8[0],t8[u8[k14][1]]-w8[1]];var m14=l14[0]*l14[0]+l14[1]*l14[1];var n14=(i14[0]*l14[0]+i14[1]*l14[1])/Math.sqrt(j14*m14);if(Math.abs(n14)<Math.abs(g14)){e14=h14;f14=k14;g14=n14;}}}}return d8(x8,a14[e14],b14[e14][0],b14[e14][1],a14[f14],b14[f14][0],b14[f14][1]);} else {throw {error:'That was sure unexpected!'};}}var e13=(x8[0]*a13[0]+x8[1]*a13[1])+x8[2]*a13[2];a13[0]-=e13*x8[0];a13[1]-=e13*x8[1];a13[2]-=e13*x8[2];var e13=(x8[0]*b13[0]+x8[1]*b13[1])+x8[2]*b13[2];b13[0]-=e13*x8[0];b13[1]-=e13*x8[1];b13[2]-=e13*x8[2];return [a13,b13];}function z8(a9,b9,c9){if(typeof b9=='undefined')b9=a9.normals;var o14=t7(a9);var p14=new MatrixStack();var q14=[];for(var r14=0;r14<o14.length;++r14){if(o14[r14].length==0){q14.push([[0,0,0],[0,0,0]]);continue;}var s14=new k7(a9.vertices[r14]);var t14=new k7(b9[r14]);var u14=a9.texCoords[r14];if(o14[r14].length==1){var v14=a9.vertices[o14[r14][0]];var w14=a9.texCoords[o14[r14][0]];var x14=[v14[0]-s14[0],v14[1]-s14[1],v14[2]-s14[2]];var y14=[w14[0]-u14[0],w14[1]-u14[1]];q14.push(z7(t14,x14,y14));} else if(o14[r14].length==2){var z14=a9.texCoords[o14[r14][0]];var a15=a9.texCoords[o14[r14][0]];var b15=z14[0]-u14[0],c15=z14[1]-u14[1];var d15=a15[0]-u14[0],e15=a15[1]-u14[1];var f15=new k7(a9.vertices[o14[r14][0]]).subtract(s14);var g15=new k7(a9.vertices[o14[r14][1]]).subtract(s14);q14.push(d8(t14,f15,b15,c15,g15,d15,e15));} else {q14.push(r8(a9.vertices,a9.texCoords,o14[r14],s14,a9.texCoords[r14],t14,p14));}}if(c9){for(var h15=0;h15<q14.length;++h15){var m15=q14[h15][0][0];var n15=q14[h15][0][1];var o15=q14[h15][0][2];var p15=Math.sqrt((m15*m15+n15*n15)+o15*o15);if(p15!=0)q14[h15][0]=[m15/p15,n15/p15,o15/p15];var m15=q14[h15][1][0];var n15=q14[h15][1][1];var o15=q14[h15][1][2];var p15=Math.sqrt((m15*m15+n15*n15)+o15*o15);if(p15!=0)q14[h15][1]=[m15/p15,n15/p15,o15/p15];}}return q14;}return {Vector3:k7,Maps:s7,Complex:o7,computeNormals:x7,computeTangentSpace:z8};})();renderjs.Geometry=Geometry;var Resources=(function(){function q15(r15,s15){if((s15.substring(0,1)=='/'||s15.indexOf('://')>=0)||s15.substring(0,5)=='data:')return s15;if(r15.length>0&&r15.substring(r15.length-1,0)!='/')return (r15+'/')+s15;return r15+s15;}function t15(u15,v15){return new Promise(function(resolve,reject){function y15(d16){if(typeof v15=='function')v15({completed:true});reject(d16);}function a16(d16){if(typeof v15=='function')v15({completed:true});resolve(e16.responseText);}function c16(d16){v15({completed:false,loaded:d16.loaded,total:d16.total});}var e16=new XMLHttpRequest();e16.addEventListener('abort',y15);e16.addEventListener('error',y15);e16.addEventListener('load',a16);if(typeof v15=='function')e16.addEventListener('progress',c16);e16.open('GET',u15);e16.send();});}function w15(x15){x15=x15||'';var f16=this;var g16=[];this.resourcePath=x15;this.createCache=function(type,factory){var h16={};this[type]=function(arg){return new Promise(function(resolve,reject){var i16=h16[arg];if(i16!=undefined){resolve(i16);} else {try{var j16=factory(arg);if(j16 instanceof Promise || typeof j16.then=='function'){g16.push(j16);if(g16.length==1)f16.onresourcesloading();j16.then(function(value){h16[arg]=value;g16.splice(g16.indexOf(j16),1);if(g16.length==0)f16.onresourcesloaded();resolve(value);},reject);} else {h16[arg]=j16;resolve(j16);}}catch(error){reject(error);}}});};this[type].set=function(src,data){h16[src]=data;};this[type].forget=function(data){for(var k16 in h16){if(h16[k16]===data){delete h16[k16];return;}}};};this.all=function(resourceMap){var l16=[];for(var m16 in resourceMap){var n16=resourceMap[m16];if(typeof n16=='function')l16.push(n16(m16)); else l16.push(n16);}return Promise.all(l16).then(function(resourceArray){var o16={};var p16=0;for(m16 in resourceMap)o16[m16]=resourceArray[p16++];return o16;});};Object.defineProperty(this,'pendingResourceCount',{get:function(){return this.pendingResources.length;}});this.createCache('image',function(u15){return new Promise(function(resolve,reject){var q16=new Image();q16.onload=function(){resolve(q16);};q16.onerror=reject;q16.src=q15(f16.resourcePath,u15);});});this.createCache('file',function(u15){return t15(q15(f16.resourcePath,u15));});this.onresourcesloading=this.onresourcesloaded=function(){};}if(typeof Promise=='undefined'){window.Promise=(function(){function r16(s16){function t16(w16){x16=w16;a17.state=r16.FULFILLED;for(var b17=0;b17<y16.length;++b17)y16[b17](w16);y16=z16=null;}function v16(w16){x16=w16;a17.state=r16.REJECTED;for(var c17=0;c17<z16.length;++c17)z16[c17](w16);y16=z16=null;}var x16;var y16=[];var z16=[];var a17=this;this.state=r16.PENDING;s16(t16,v16);this.then=function(onFulfill,onReject){return new r16(function(nextResolve,nextReject){if(a17.state==r16.PENDING){if(onFulfill)y16.push(function(w16){nextResolve(onFulfill(w16));});if(onReject)z16.push(function(w16){nextReject(onReject(w16));});} else if(a17.state==r16.FULFILLED&&onFulfill){nextResolve(onFulfill(x16));} else if(a17.state==r16.REJECTED&&onReject){nextReject(onReject(x16));}});};}r16.PENDING=1;r16.FULFILLED=2;r16.REJECTED=3;r16.all=function(promiseArray){return new r16(function(resolve,reject){function d17(j17,f17){return function(result){if(h17){h17[j17]=result;--g17;if(g17==0)f17(h17);}};}var g17=promiseArray.length;var h17=[];for(var j17=0;j17<promiseArray.length;++j17)h17.push(null);for(var j17=0;j17<promiseArray.length;++j17)promiseArray[j17].then(d17(j17,resolve),function(error){h17=null;reject(error);});});};return r16;})();}return w15;})();renderjs.Resources=Resources;var Parser=(function(window){var k17={ident:'[a-zA-Z_$][a-zA-Z_$0-9]*',num:'-?[0-9]+(?:\\.[0-9]*)?',string:'(?:"[^"]*(?:""[^"]+)*")|(?:\'[^\']*(?:\'\'[^\']+)*\')',oper:'[+*^/%.,-]',bracket:'[)(]'};var l17=[k17.ident,k17.num,k17.oper,k17.bracket];var m17=('('+l17.join(')|('))+')';var n17=new Object();function o17(p17){if(p17[0]=="'")return p17.substring(1,p17.length-1).replace("''","'"); else return p17.substring(1,p17.length-1).replace('""','"');}function q17(r17,s17,t17){if(r17())return s17();if(t17)return t17();return 0.0;}function u17(){function v17(){if(n18.value=='-'){d18();var r18=k18();return {op:'negate',subtree:r18};} else {return k18();}}function w17(){if(n18.type==k17.ident){if(o18.value!='(')return b18({op:'lookup',name:n18.value});return x17();} else if(n18.type==k17.num){return b18({op:'const',value: +n18.value});} else if(n18.type==k17.string){return b18({op:'const',value:o17(n18.value)});} else if(n18.value=='('){d18();var s18=v17();d18();return s18;}}function x17(){var t18=n18.value;var u18=[];d18();d18();while(true){u18.push(v17());if(n18.value==',')d18(); else break;}d18();return {op:'call',name:t18,args:u18};}function y17(z17,a18){return function(){var v18=a18();while(z17.indexOf(n18.value)>=0){var w18=n18.value;d18();var x18=a18();v18={op:w18,left:v18,right:x18};}return v18;};}function b18(c18){d18();return c18;}function d18(){n18=p18.shift();o18=p18[0];return n18;}function e18(h18){if(h18.left){h18.left=e18(h18.left);h18.right=e18(h18.right);if(h18.left.op=='const'&&h18.right.op=='const'){switch(h18.op){case '+':return {op:'const',value:left.value+right.value};case '-':return {op:'const',value:left.value-right.value};case '*':return {op:'const',value:left.value*right.value};case '/':return {op:'const',value:left.value/right.value};case '%':return {op:'const',value:left.value%right.value};case '^':return {op:'const',value:Math.pow(left.value,right.value)};default:throw {error:'unknown operation '+h18.op};}}} else if(h18.subtree){h18.subtree=e18(h18.subtree);if(h18.subtree.op=='const')return {op:'const',value:-h18.subtree.value};} else if(h18.args instanceof Array){if(h18.name=='pi')return {op:'const',value:Math.PI};if(h18.name=='e')return {op:'const',value:Math.E};for(var y18=0;y18<h18.args.length;++y18)h18.args[y18]=e18(h18.args[y18]);}return h18;}function g18(h18){if(h18.op=='const')return function(){return h18.value;};if(h18.op=='call'){var b19=l18.builtins[h18.name];if(!b19)b19=l18.resolve(h18.name);if(!b19)throw {error:'unknown function '+h18.name};var c19=h18.args.map(g18);if(typeof b19!='function'){var d19=b19.lazyEval;if(b19.minArgs&&c19.length<b19.minArgs)throw {error:'too few arguments to function',reason:{funcName:h18.name,minArgs:b19.minArgs}};if(b19.singleton)b19=b19.singleton; else return b19.factory.apply(b19,c19);if(d19)return function(){return b19.apply(this,c19);};}return function(){return b19.apply(this,c19.map(function(a){return a();}));};}if(h18.op=='lookup'){var e19=l18.resolve(h18.name);if(typeof e19=='function')return e19;return function(){return e19;};}if(h18.op=='negate'){var f19=g18(h18.subtree);return function(){return -f19();};}var z18=g18(h18.left);var a19=g18(h18.right);switch(h18.op){case '+':return function(){return z18()+a19();};case '-':return function(){return z18()-a19();};case '*':return function(){return z18()*a19();};case '/':return function(){return z18()/a19();};case '%':return function(){return z18()%a19();};case '^':return function(){return Math.pow(z18(),a19());};default:throw {error:'unknown operation '+h18.op};}}var i18=y17(['^'],w17);var j18=y17(['*','/'],i18);var k18=y17(['+','-'],j18);var l18=this;var m18=1;var n18=null;var o18=null;var p18=[];var q18=null;this.resolve=function(name){return 0.0;};this.parse=function(k18){var g19=new RegExp(m17,'g');var h19;while((h19=g19.exec(k18))!==null){var i19=null;for(var j19=0;j19<l17.length;++j19){if(h19[j19+1]){i19=l17[j19];break;}}p18.push({type:i19,value:h19[0]});}p18.push({type:n17});d18();q18=v17();};this.createEvaluator=function(){var k19=e18(q18);return g18(k19);};this.builtins={sin:Math.sin,cos:Math.cos,tan:Math.tan,atan:Math.atan,atan2:Math.atan2,exp:Math.exp,log:Math.log,if:{lazyEval:true,minArgs:2,singleton:q17}};}u17.createEvaluator=function(expression,resolver,builtins){var l19=new u17();if(builtins){for(var m19 in builtins)l19.builtins[m19]=builtins[m19];}l19.resolve=resolver;l19.parse(expression);return l19.createEvaluator();};return u17;})();renderjs.Parser=Parser;var Shader=(function(){function n19(o19,p19,q19){function r19(s19,t19){return ((t19||'u')+s19[0].toUpperCase())+s19.substring(1);}var u19=o19.createProgram();var v19=o19.createShader(o19.VERTEX_SHADER);o19.shaderSource(v19,p19);o19.compileShader(v19);if(!o19.getShaderParameter(v19,o19.COMPILE_STATUS))throw {message:'invalid vertex shader',reason:o19.getShaderInfoLog(v19)};var w19=o19.getShaderInfoLog(v19);if(w19)console.log(w19);o19.attachShader(u19,v19);var x19=o19.createShader(o19.FRAGMENT_SHADER);o19.shaderSource(x19,q19);o19.compileShader(x19);if(!o19.getShaderParameter(x19,o19.COMPILE_STATUS))throw {message:'invalid fragment shader',reason:o19.getShaderInfoLog(x19)};w19=o19.getShaderInfoLog(x19);if(w19)console.log(w19);o19.attachShader(u19,x19);o19.linkProgram(u19);if(!o19.getProgramParameter(u19,o19.LINK_STATUS))throw {message:'program filed to link',reason:o19.getProgramInfoLog(u19)};this.glProgram=u19;this.use=function(){o19.useProgram(this.glProgram);};this.destroy=function(){o19.useProgram(this.glProgram);o19.detachShader(u19,v19);o19.detachShader(u19,x19);o19.deleteShader(u19,v19);o19.deleteShader(u19,x19);o19.useProgram(null);o19.deleteProgram(u19);};this.registerFlag=function(s19,initValue){var y19=o19.getUniformLocation(u19,r19(s19));var z19=initValue;if(y19){Object.defineProperty(this,s19,{get:function(){return z19;},set:function(value){z19=value;o19.uniform1i(y19,value?1:0);return z19;}});if(initValue)o19.uniform1i(y19,1);} else {console.log('WARNING: shader has no uniform '+r19(s19));}};this.registerVertexAttrib=function(s19,type,size){var a20=o19.getAttribLocation(u19,r19(s19,'a'));var b20;if(a20>=0){Object.defineProperty(this,s19,{get:function(){return b20;},set:function(newValue){b20=newValue;if(b20){o19.bindBuffer(o19.ARRAY_BUFFER,b20);o19.vertexAttribPointer(a20,size,type,false,0,0);o19.enableVertexAttribArray(a20);} else {o19.disableVertexAttribArray(a20);}return b20;}});} else {console.log('WARNING: shader has no attribute '+r19(s19,'a'));}};this.setSampler=function(s19,textureUnit){var c20=o19.getUniformLocation(u19,s19);o19.useProgram(this.glProgram);o19.uniform1i(c20,textureUnit);};this.registerUniformMatrix=function(s19){var d20=r19(s19);var e20=o19.getUniformLocation(u19,d20);var f20=o19.getUniformLocation(u19,d20+'Inverse');var g20;if(e20||f20){Object.defineProperty(this,s19,{get:function(){return g20;},set:function(newValue){g20=newValue;if(e20)o19.uniformMatrix4fv(e20,false,g20.getData());if(f20){g20.push();g20.invert();o19.uniformMatrix4fv(f20,false,g20.getData());g20.pop();}return g20;}});} else {console.log('WARNING: shader has no uniform '+d20);}};this.registerUniformInt=function(s19){var h20=o19.getUniformLocation(u19,r19(s19));var i20;if(h20){Object.defineProperty(this,s19,{get:function(){return i20;},set:function(newValue){i20=newValue;o19.uniform1i(h20,i20);return i20;}});} else {console.log('WARNING: shader has no uniform '+r19(s19));}};this.registerUniformFloat=function(s19){var j20=o19.getUniformLocation(u19,r19(s19));var k20;if(j20){Object.defineProperty(this,s19,{get:function(){return k20;},set:function(newValue){k20=newValue;o19.uniform1f(j20,k20);return k20;}});} else {console.log('WARNING: shader has no uniform '+r19(s19));}};this.registerUniformComplex=function(s19,initVal){var l20=r19(s19);var m20=o19.getUniformLocation(u19,l20+'.Re');var n20=o19.getUniformLocation(u19,l20+'.Im');var o20=new Geometry.Complex(initVal);if(m20){Object.defineProperty(this,s19,{get:function(){if(o20.Im==0.0)return o20.re; else return o20;},set:function(newRe,newIm){o20=new Geometry.Complex(newRe,newIm);o19.uniform1f(m20,o20.re);o19.uniform1f(n20,o20.im);return o20;}});} else {console.log('WARNING: shader has no uniform '+r19(s19));}};this.registerUniformFloat3=function(s19){var p20=o19.getUniformLocation(u19,r19(s19));var q20;if(p20){Object.defineProperty(this,s19,{get:function(){return q20;},set:function(){if(typeof arguments[1]=='undefined')q20=[arguments[0][0],arguments[0][1],arguments[0][2]]; else q20=[arguments[0],arguments[1],arguments[2]];o19.uniform3f(p20,q20[0],q20[1],q20[2]);return q20;}});} else {console.log('WARNING: shader has no uniform '+r19(s19));}};this.registerUniformFloat4=function(s19){var r20=o19.getUniformLocation(u19,r19(s19));var s20;if(r20){Object.defineProperty(this,s19,{get:function(){return s20;},set:function(){if(typeof arguments[1]=='undefined')s20=[arguments[0][0],arguments[0][1],arguments[0][2],arguments[0][3]]; else s20=[arguments[0],arguments[1],arguments[2],arguments[3]];o19.uniform4f(r20,s20[0],s20[1],s20[2],s20[3]);return s20;}});} else {console.log('WARNING: shader has no uniform '+r19(s19));}};this.registerUniformFloat3Array=function(s19){var t20=o19.getUniformLocation(u19,r19(s19));var u20;if(t20){Object.defineProperty(this,s19,{get:function(){return u20;},set:function(newValue){u20=newValue;if(u20.length==0)return u20;if(typeof u20[0][0]!='undefined'){var v20=new Float32Array(3*u20.length);var w20=0;for(var x20=0;x20<u20.length;++x20){v20[w20++]=u20[x20][0];v20[w20++]=u20[x20][1];v20[w20++]=u20[x20][2];}o19.uniform3fv(t20,v20);} else {o19.uniform3fv(t20,u20);}return u20;}});} else {console.log('WARNING: shader has no uniform '+r19(s19));}};this.setUniform2f=function(uniformName,x,y){var y20=o19.getUniformLocation(u19,uniformName);if(y20){o19.useProgram(u19);o19.uniform2f(y20,x,y);}};}return n19;})();renderjs.Shader=Shader;var createRenderer=(function(){function z20(a21,b21,c21,d21){function h21(i21){if(!z23.running&&!o24)return;if(a24==undefined){a24=i21;b24=z23.time;}z23.time=(i21-a24)/1000+b24;m21(z23.time);requestAnimationFrame(h21);}function j21(h23){l21();m21(h23);z23.frameCount++;}function l21(){a21.clearColor(0.0,0.0,0.0,1.0);a21.enable(a21.DEPTH_TEST);a21.depthFunc(a21.LEQUAL);m24.use();m24.viewportMatrix=r24;a21.bindFramebuffer(a21.FRAMEBUFFER,null);}function m21(h23){p24.identity();m24.cameraMatrix=q24;h24=o21();m24.numberOfLights=h24.types.length;m24.lightPositions=h24.positions;m24.lightColors=h24.colors;m24.ambientLight=h24.ambient;a21.clear(a21.COLOR_BUFFER_BIT|a21.DEPTH_BUFFER_BIT);a23(m24,c24,h23);z23.frameCount++;z23.dirty=false;}function o21(){var z24=[];var a25=[];var b25=[];var c25=[0.0,0.0,0.0];i24.identity();function d25(e25){if(e25.transform&&(e25.lights||e25.childrenWithLights)){i24.push();e25.transform(i24);}if(e25.lights){for(var g25=0;g25<e25.lights.length;++g25){var h25=e25.lights[g25];if(h25.type=='ambient'){c25[0]+=h25.color[0]();c25[1]+=h25.color[1]();c25[2]+=h25.color[2]();continue;}z24.push(h25.type);var i25=i24.transform(h25.position[0](),h25.position[1](),h25.position[2]());a25.push(i25[0]);a25.push(i25[1]);a25.push(i25[2]);if(h25.color){b25.push(h25.color[0]());b25.push(h25.color[1]());b25.push(h25.color[2]());} else {b25.push(1.0);b25.push(1.0);b25.push(1.0);}}}if(e25.childrenWithLights){for(var j25=0;j25<e25.childrenWithLights.length;++j25)d25(e25.childrenWithLights[j25]);}if(e25.transform&&(e25.lights||e25.childrenWithLights))i24.pop();}for(var f25=0;f25<c24.length;++f25)d25(c22(c24[f25]));return {types:z24,positions:a25,colors:b25,ambient:c25};}function p21(q21){if(typeof q21=='number')return function(){return q21;};if(typeof q21=='boolean')return function(){return q21?1.0:0.0;};return Parser.createEvaluator(q21,function(parameter){if(parameter=='$time')return function(){return z23.time;};return function(){var k25=z23.parameters[parameter];if(typeof k25=='function')return k25(z23.time);if(typeof k25=='number')return k25;if(typeof k25=='boolean')return k25?1.0:0.0;return 0.0;};},y23);}function r21(s21,t21){return function(){s21.apply(this,arguments);t21.apply(this,arguments);};}function u21(v21,w21){return function(){var l25=[w21];for(var m25=0;m25<arguments.length;++m25)l25.push(arguments[m25]);v21.apply(this,l25);};}function x21(y21){if(typeof y21=='string'){if(y21.length==0)return function(){};if(y21[0]=='#'){var n25=y21.substring(1);return u21(function(n25,m){var o25=d24[n25];if(o25){var p25=z23.getTransform(o25);m.push();m.load(p25);m.mul();}},n25);} else {var q25=y21;return u21(function(q25,m){var r25=z23.parameters[q25];if(r25){if(typeof r25=='function')r25=r25(z23.time);m.push();m.load(r25);m.mul();}},q25);}}if(y21[0]=='rotate'){var s25=p21(y21[1]);var t25=p21(y21[2]);var u25=p21(y21[3]);var v25=p21(y21[4]);return function(matrix){matrix.rotate(s25(),[t25(),u25(),v25()]);};} else if(y21[0]=='translate'){var w25=p21(y21[1]);var x25=p21(y21[2]);var y25=p21(y21[3]);return function(matrix){matrix.translate(w25(),x25(),y25());};} else if(y21[0]=='scale'){var z25=p21(y21[1]);var a26=p21(y21[2]);var b26=p21(y21[3]);return function(matrix){matrix.scale(z25(),a26(),b26());};} else {throw {error:'unsupported transform',reason:y21};}}function z21(v22,f23){f23.vertexPosition=v22.vertexBuffer;f23.vertexNormal=v22.normalBuffer;f23.textureCoord=v22.texCoords;if(v22.texture){a21.activeTexture(a21.TEXTURE0);a21.bindTexture(a21.TEXTURE_2D,v22.texture);}if(v22.normalMap){f23.normalMapping=true;a21.activeTexture(a21.TEXTURE1);a21.bindTexture(a21.TEXTURE_2D,v22.normalMap);f23.uVector=v22.tangentSpace.u;f23.vVector=v22.tangentSpace.v;}a21.bindBuffer(a21.ELEMENT_ARRAY_BUFFER,v22.faceBuffer);a21.drawElements(a21.TRIANGLES,v22.faceCount,a21.UNSIGNED_SHORT,0);if(v22.normalMap){f23.normalMapping=false;f23.uVector=null;f23.vVector=null;}}function c22(g23){return g23.__renderData||(g23.__renderData=n22(g23));}function e22(f23){f23.registerVertexAttrib('vertexPosition',a21.FLOAT,3);f23.registerVertexAttrib('vertexNormal',a21.FLOAT,3);f23.registerVertexAttrib('textureCoord',a21.FLOAT,2);f23.registerVertexAttrib('uVector',a21.FLOAT,3);f23.registerVertexAttrib('vVector',a21.FLOAT,3);f23.registerUniformMatrix('modelMatrix');f23.registerUniformMatrix('cameraMatrix');f23.registerUniformMatrix('viewportMatrix');f23.registerUniformInt('numberOfLights');f23.registerUniformFloat3Array('lightPositions');f23.registerUniformFloat3Array('lightColors');f23.registerUniformFloat3('ambientLight');}function g22(h22,i22){var c26=m24;try{var d26=new Shader(z23.gl,i22[h22.vertex],i22[h22.fragment]);d26.use();e22(d26);if(h22.uniforms){for(var e26 in h22.uniforms){var f26,g26;if(typeof h22.uniforms[e26]=='string')f26=h22.uniforms[e26],g26=undefined; else f26=h22.uniforms[e26].type,g26=h22.uniforms[e26].default;switch(f26){case 'mat4':d26.registerUniformMatrix(e26);break;case 'int':case 'bool':d26.registerUniformInt(e26);break;case 'float':d26.registerUniformFloat(e26);break;case 'complex':d26.registerUniformComplex(e26);g26=new Complex(g26);break;case 'vec3':d26.registerUniformFloat3(e26);break;case 'vec3[]':d26.registerUniformFloat3Array(e26);break;default:z23.onerror({error:'unsupported uniform type',reason:f26});continue;}if(typeof g26!=undefined)d26[e26]=g26;}}if(h22.attributes){for(var h26 in h22.attributes){var i26,j26=h22.attributes[h26].size|0;switch(h22.attributes[h26].type){case 'float':i26=a21.FLOAT;break;case 'int':i26=a21.INT;break;case 'double':i26=a21.DOUBLE;break;case 'uint':i26=a21.UNSIGNED_INT;break;case 'short':i26=a21.SHORT;break;case 'ushort':i26=a21.UNSIGNED_SHORT;break;default:z23.onerror({error:'unsupported vertex attribute type',reason:h22.attributes[h26].type});continue;}d26.registerVertexAttrib(h26,j26,i26);}}return d26;}catch(x){z23.onerror(x);}finally{m24=c26;m24.use();}}function j22(m22){m22.refCount=(m22.refCount||0)+1;}function l22(m22){m22.refCount=m22.refCount-1;if(m22.refCount==0)d21.texture.forget(m22);}function n22(g23){var k26={};if(g23.id)d24[g23.id]=g23;if(g23.mesh){k26.mesh={};k26.mesh.vertexBuffer=i23(g23.mesh.vertices,3);if(g23.mesh.texture){k26.mesh.texture=n24;d21.texture(g23.mesh.texture).then(function(m22){k26.mesh.texture=m22;s23();});}var l26=g23.mesh.normals;if(!l26)l26=Geometry.computeNormals(g23.mesh);k26.mesh.normalBuffer=i23(l26,3);if(g23.mesh.texCoords){k26.mesh.texCoords=i23(g23.mesh.texCoords,2);if(g23.mesh.normalMap){k26.mesh.normalMap=null;d21.texture(g23.mesh.normalMap).then(function(m22){k26.mesh.normalMap=m22;s23();});if(!g23.mesh.tangentSpace){var m26=Geometry.computeTangentSpace(g23.mesh,l26,true);k26.mesh.tangentSpace={u:i23(m26,3,a21.FLOAT,a21.ARRAY_BUFFER,1,0,0),v:i23(m26,3,a21.FLOAT,a21.ARRAY_BUFFER,1,0,1)};} else {k26.mesh.tangentSpace={u:i23(g23.mesh.tangentSpace.u,3),v:i23(g23.mesh.tangentSpace.v,3)};}}}if(g23.mesh.mode=='strip'){throw {error:'mesh mode not supported',reason:g23.mesh.mode};} else if(g23.mesh.faces){k26.mesh.faceBuffer=i23(g23.mesh.faces,3,a21.UNSIGNED_SHORT,a21.ELEMENT_ARRAY_BUFFER);k26.mesh.faceCount=3*g23.mesh.faces.length;k26.mesh.draw=z21;} else {}}if(g23.transform){if(typeof g23.transform=='string'){k26.transform=x21(g23.transform);} else {var n26=undefined;for(var o26=0;o26<g23.transform.length;++o26){var p26=x21(g23.transform[o26]);if(n26)n26=r21(n26,p26); else n26=p26;}k26.transform=n26;}}if(g23.shader){if(g23.shader.vertex&&g23.shader.fragment){var q26={};q26[g23.shader.vertex]=z23.resources.file;q26[g23.shader.fragment]=z23.resources.file;k26.pending=true;z23.resources.all(q26).then(function(i22){k26.program=g22(g23.shader,i22);k26.pending=false;s23();});if(g23.shader.textureUnits)k26.textureUnits=g23.shader.textureUnits;if(g23.shader.blend){switch(g23.shader.blend){case 'default':default:k26.blend=function(a21){a21.enable(a21.BLEND);a21.blendEquation(a21.FUNC_ADD);a21.blendFunc(a21.SRC_ALPHA,a21.ONE_MINUS_SRC_ALPHA);};}}}if(g23.shader.parameters){k26.uniforms=k26.uniforms||{};for(var r26 in g23.shader.parameters)k26.uniforms[r26]=p21(g23.shader.parameters[r26]);}}if(g23.material){k26.uniforms=k26.uniforms||{};for(var s26 in g23.material)k26.uniforms[s26]=p21(g23.material[s26]);}if(g23.flags){k26.flags={};k26.uniforms=k26.uniforms||{};for(var t26 in g23.flags){var u26=g23.flags[t26];var v26=p21(u26);k26.flags[t26]=v26;k26.uniforms[t26]=v26;}}if(g23.lights){k26.lights=g23.lights.map(function(light){var y26=light.type;if(y26=='point')y26=1;var z26={type:y26};if(light.position){z26.position=[p21(light.position[0]),p21(light.position[1]),p21(light.position[2])];}if(light.color){z26.color=[p21(light.color[0]),p21(light.color[1]),p21(light.color[2])];}return z26;});var w26=k26;for(var x26=g23.parent;x26&&x26.__renderData;x26=x26.parent){x26.__renderData.childrenWithLights=x26.__renderData.childrenWithLights||[];x26.__renderData.childrenWithLights.push(w26);w26=x26.__renderData;}}g23.__renderData=k26;if(g23.children){for(var a27=0;a27<g23.children.length;++a27)n22(g23.children[a27]);}return k26;}function p22(g23,r22){var b27=g23.__renderData;if(g23.id&&d24[g23.id]===g23)delete d24[g23.id];if(b27){if(b27.mesh){if(b27.mesh.vertexBuffer)a21.deleteBuffer(b27.mesh.vertexBuffer);if(b27.mesh.normalBuffer)a21.deleteBuffer(b27.mesh.normalBuffer);if(b27.mesh.texCoords)a21.deleteBuffer(b27.mesh.texCoords);if(b27.mesh.tangentSpace){a21.deleteBuffer(b27.mesh.tangentSpace.u);a21.deleteBuffer(b27.mesh.tangentSpace.v);}if(b27.mesh.faceBuffer)a21.deleteBuffer(b27.mesh.faceBuffer);if(b27.mesh.texture)l22(b27.mesh.texture);if(b27.mesh.normalMap)l22(b27.mesh.normalMap);}if(b27.shader)h22.destroy();delete g23.__renderData;}if(r22&&g23.children){for(var c27=0;c27<g23.children.length;++c27)p22(g23.children[c27]);}}function s22(){a21.bindFramebuffer(a21.FRAMEBUFFER,j24.framebuffer);a21.clearColor(0.0,0.0,0.0,0.0);a21.clear(a21.COLOR_BUFFER_BIT|a21.DEPTH_BUFFER_BIT);a21.clearColor(0.0,0.0,0.0,1.0);}function t22(){a21.bindFramebuffer(a21.FRAMEBUFFER,null);l24.use();l24.viewportMatrix=r24;l24.vertexPosition=l24.vertices;l24.textureCoord=l24.texCoords;a21.activeTexture(a21.TEXTURE0);a21.bindTexture(a21.TEXTURE_2D,j24.texture);a21.enable(a21.BLEND);a21.blendEquation(a21.FUNC_ADD);a21.blendFunc(a21.SRC_ALPHA,a21.ONE_MINUS_SRC_ALPHA);a21.drawArrays(a21.TRIANGLES,0,6);a21.disable(a21.BLEND);m24.use();}function u22(v22){var d27=new Uint16Array((v22.faces.length*3)*2);for(var e27=0;e27<v22.faces.length;++e27){d27[6*e27+0]=v22.faces[e27][0];d27[6*e27+1]=v22.faces[e27][1];d27[6*e27+2]=v22.faces[e27][1];d27[6*e27+3]=v22.faces[e27][2];d27[6*e27+4]=v22.faces[e27][2];d27[6*e27+5]=v22.faces[e27][0];}var f27=a21.createBuffer();a21.bindBuffer(a21.ELEMENT_ARRAY_BUFFER,f27);a21.bufferData(a21.ELEMENT_ARRAY_BUFFER,d27,a21.STATIC_DRAW);return f27;}function w22(f23,g23,z22){var g27=f23.wireframe;if(!z22.mesh.edgeList)z22.mesh.edgeList=u22(g23.mesh);f23.renderEdges=true;f23.vertexPosition=z22.mesh.vertexBuffer;f23.vertexNormal=z22.mesh.normalBuffer;f23.textureCoord=z22.mesh.texCoords;f23.wireframe=false;a21.bindBuffer(a21.ELEMENT_ARRAY_BUFFER,z22.mesh.edgeList);a21.drawElements(a21.LINES,z22.mesh.faceCount*2,a21.UNSIGNED_SHORT,0);f23.renderEdges=false;f23.wireframe=g27;}function a23(f23,c23,h23){for(var i27=0;i27<c23.length;++i27){if(!c23[i27].flags||!c23[i27].flags.wireframe)e23(f23,c23[i27],h23);}for(var i27=0;i27<c23.length;++i27){if(c23[i27].flags&&c23[i27].flags.wireframe)e23(f23,c23[i27],h23);}}function e23(f23,g23,h23){var j27=c22(g23);if(j27.pending)return;if(z23.onbeforerendernode)z23.onbeforerendernode(g23,h23,f23);var k27=null;var l27=null;var m27=null;var n27=(j27.flags&&j27.flags.renderEdges)&&j27.flags.renderEdges();if(j27.program){l27=f23;f23=j27.program;f23.use();f23.cameraMatrix=l27.cameraMatrix;f23.cameraMatrixInverse=l27.cameraMatrixInverse;f23.viewportMatrix=l27.viewportMatrix;f23.viewportMatrixInverse=l27.viewportMatrixInverse;f23.numberOfLights=h24.types.length;f23.lightPositions=h24.positions;f23.lightColors=h24.colors;}if(j27.uniforms){k27={};for(var o27 in j27.uniforms){var p27=j27.uniforms[o27];k27[o27]=f23[o27];f23[o27]=p27();}}if(j27.transform){p24.push();j27.transform(p24);}if(j27.blend){m27=s24;s24=j27.blend;s24(a21);}if(j27.mesh){f23.modelMatrix=p24;if(f23.wireframe){if(n27)w22(f23,g23,j27);s22();}j27.mesh.draw(j27.mesh,f23);if(f23.wireframe)t22();if(!f23.wireframe&&n27)w22(f23,g23,j27);}if(g23.children)a23(f23,g23.children,h23);if(m27){s24=m27;s24(a21);}if(j27.transform)p24.pop();if(k27){for(var q27 in k27)f23[q27]=k27[q27];}if(l27){l27.use();}if(z23.onafterrendernode)z23.onafterrendernode(g23,h23,f23);}function i23(j23,k23,l23,m23,n23,o23,p23){l23=l23||a21.FLOAT;m23=m23||a21.ARRAY_BUFFER;n23=n23||1;o23=o23|0;var r27;var s27=(j23.length-o23)/n23|0;if(l23==a21.FLOAT)r27=new Float32Array(s27*k23); else if(l23==a21.UNSIGNED_SHORT)r27=new Uint16Array(s27*k23); else throw {error:'unknown buffer type',reason:l23};var t27=0;if(typeof p23=='undefined'){for(var v27=o23;v27<j23.length;v27+=n23)for(var j=0;j<k23;++j)r27[t27++]=j23[v27][j];} else {for(var w27=o23;w27<j23.length;w27+=n23)for(var j=0;j<k23;++j)r27[t27++]=j23[w27][p23][j];}var u27=a21.createBuffer();a21.bindBuffer(m23,u27);a21.bufferData(m23,r27,a21.STATIC_DRAW);return u27;}function q23(r23){r23=r23&&t24.floatTexture;var x27=a21.createFramebuffer();a21.bindFramebuffer(a21.FRAMEBUFFER,x27);x27.width=b21;x27.height=c21;var y27=a21.createTexture();a21.bindTexture(a21.TEXTURE_2D,y27);a21.texParameteri(a21.TEXTURE_2D,a21.TEXTURE_MIN_FILTER,a21.NEAREST);a21.texParameteri(a21.TEXTURE_2D,a21.TEXTURE_MAG_FILTER,a21.NEAREST);a21.texParameteri(a21.TEXTURE_2D,a21.TEXTURE_WRAP_S,a21.CLAMP_TO_EDGE);a21.texParameteri(a21.TEXTURE_2D,a21.TEXTURE_WRAP_T,a21.CLAMP_TO_EDGE);if(r23)a21.texImage2D(a21.TEXTURE_2D,0,a21.RGBA,b21,c21,0,a21.RGBA,a21.FLOAT,null); else a21.texImage2D(a21.TEXTURE_2D,0,a21.RGBA,b21,c21,0,a21.RGBA,a21.UNSIGNED_BYTE,null);var z27=a21.createRenderbuffer();a21.bindRenderbuffer(a21.RENDERBUFFER,z27);a21.renderbufferStorage(a21.RENDERBUFFER,a21.DEPTH_COMPONENT16,b21,c21);a21.framebufferTexture2D(a21.FRAMEBUFFER,a21.COLOR_ATTACHMENT0,a21.TEXTURE_2D,y27,0);a21.framebufferRenderbuffer(a21.FRAMEBUFFER,a21.DEPTH_ATTACHMENT,a21.RENDERBUFFER,z27);a21.bindTexture(a21.TEXTURE_2D,null);a21.bindRenderbuffer(a21.RENDERBUFFER,null);a21.bindFramebuffer(a21.FRAMEBUFFER,null);return {framebuffer:x27,texture:y27,renderbuffer:z27};}function s23(){z23.dirty=true;z23.onrepaintrequired();}function t23(u23){console.log('ERROR: '+u23.message);if(u23.reason)console.log(u23.reason);throw u23;}function v23(){u24.then(function(){l21();a24=undefined;requestAnimationFrame(h21);},t23);}function w23(){++o24;if(o24==1&&!z23.running)v23();}function x23(){--o24;}var y23={smooth:{minArgs:3,factory:function(smoothingFunction,duration,input){var a28;smoothingFunction=smoothingFunction&&smoothingFunction()||'ease';if(typeof smoothingFunction=='string'){var k28=Bezier[smoothingFunction];a28=function(dur){return function(t){return k28(t,dur);};};} else {a28=function(dur){return function(t){return Bezier.cubicBezier(arguments[0](),arguments[1](),arguments[2](),arguments[3],t,dur);};};duration=arguments[4];input=arguments[5];}var b28=undefined;var c28=undefined;var d28=undefined;var e28=undefined;var f28=undefined;var g28=undefined;var h28=undefined;var i28=input;var j28=1.0;return function(){var l28=i28();if(d28==undefined)d28=l28;if(d28!=l28){var m28= +duration();if(m28!=b28){b28=m28;c28=a28(m28);}var n28;if(h28!=undefined)n28=(h28-z23.Time)/(h28-g28);if((h28!=undefined&&n28>0.01)&&n28<0.99){var o28=z23.time;var p28=o28+m28;var q28=p28-h28;var r28=(o28*((o28+q28)-h28))/(o28-h28);var s28=c28(o28-g28);var t28=c28(o28-r28);var u28=((s28*(f28-e28)+e28)-t28*l28)/(1-t28);j28=m28/(p28-r28);f28=l28;g28=r28;h28=p28;e28=u28;} else {if(h28==undefined)w23();j28=1.0;e28=d28;g28=z23.time;h28=g28+m28;f28=l28;}d28=l28;}if(h28==undefined)return l28;if(h28<=z23.time){g28=h28=f28=undefined;x23();return l28;}if(g28>z23.time){console.log('nothing to see here');}return e28+(f28-e28)*c28((z23.time-g28)*j28);};}}};d21.createCache('texture',function(url){return d21.image(url).then(function(img){var v28=a21.createTexture();a21.bindTexture(a21.TEXTURE_2D,v28);a21.texImage2D(a21.TEXTURE_2D,0,a21.RGBA,a21.RGBA,a21.UNSIGNED_BYTE,img);a21.texParameteri(a21.TEXTURE_2D,a21.TEXTURE_MAG_FILTER,a21.LINEAR);a21.texParameteri(a21.TEXTURE_2D,a21.TEXTURE_MIN_FILTER,a21.LINEAR_MIPMAP_NEAREST);a21.generateMipmap(a21.TEXTURE_2D);a21.bindTexture(a21.TEXTURE_2D,null);return v28;});});var z23=this;this.gl=a21;this.dirty=false;this.resources=d21;var a24,b24;var c24=[];var d24={};var e24={};var f24={};var g24=[];var h24=[];var i24=new MatrixStack();var j24;var k24;var l24;var m24;var n24;var o24=0;var p24=new MatrixStack();var q24=new MatrixStack();var r24=new MatrixStack();var s24=function(a21){a21.disable(a21.BLEND);};var t24={fragDepth:a21.getExtension('EXT_frag_depth'),floatTexture:a21.getExtension('OES_texture_float'),floatLinear:a21.getExtension('OES_float_linear'),colorBufferFloat:a21.getExtension('WEBGL_color_buffer_float')};var u24=d21.all({'std-vertex.es2':d21.file,'std-fragment.es2':d21.file,'wfm-vertex.es2':d21.file,'wfm-fragment.es2':d21.file,'loadingtexture.png':d21.image}).then(function(z22){k24=new Shader(a21,z22['std-vertex.es2'],z22['std-fragment.es2']);e22(k24);k24.registerFlag('wireframe');k24.registerFlag('renderEdges');k24.setSampler('uTexture',0);k24.setSampler('uNormalMap',1);k24.registerUniformInt('normalMapping');k24.registerUniformComplex('refractiveIndex');k24.registerUniformFloat('gloss');k24.registerUniformFloat4('highlightColor');l24=new Shader(a21,z22['wfm-vertex.es2'],z22['wfm-fragment.es2']);l24.registerVertexAttrib('vertexPosition',a21.FLOAT,2);l24.registerVertexAttrib('textureCoord',a21.FLOAT,2);l24.setSampler('uWireframe',0);l24.setUniform2f('uViewportSize',b21,c21);l24.vertices=i23([[-1,-1],[1,-1],[1,1],[1,1],[-1,1],[-1,-1]],2);l24.texCoords=i23([[0,0],[1,0],[1,1],[1,1],[0,1],[0,0]],2);m24=k24;n24=z22['loadingtexture.png'];return true;});function v24(w24,x24,y24){r24.reset();r24.perspective(30, +b21/  +c21,x24,y24);r24.push();r24.invert();r24.swap();}j24=q23(true);v24(30,1,50);q24.translate(0,0,-10);this.time=0;this.running=false;this.parameters={};this.frameCount=0;this.start=function(){if(z23.running)return;z23.running=true;if(!o24)v23();};this.stop=function(){z23.running=false;};this.renderAt=function(h23){u24.then(function(){j21(h23);},t23);};this.render=function(){this.renderAt(this.time);};this.resize=function(w,h){b21=w;c21=h;v24(30,1,50);l24.setUniform2f('uViewportSize',b21,c21);j24=q23(true);a21.viewport(0,0,b21,c21);s23();};this.addNode=function(g23,parent){if(typeof parent!='undefined')(parent.children=parent.children||[]).push(g23); else c24.push(g23);g23.parent=parent;n22(g23);s23();};this.removeNode=function(g23){var w28=c24;if(g23.parent)w28=g23.parent.children;var x28=w28.indexOf(g23);if(x28>=0){w28.splice(x28,1);p22(g23,true);}s23();};this.bindParameter=function(name,fn){this.parameters[name]=fn;};this.setCameraTransform=function(m){q24.reset();q24.load(m);q24.invert();s23();};this.setTexture=function(g23,m22){this.resources.texture(m22).then(function(tex){if(g23.__renderData)g23.__renderData.mesh.texture=tex;});};this.getLocalTransform=function(g23){var y28=new MatrixStack();var z28=c22(g23);if(z28.transform)z28.transform(y28);return y28;};this.getTransform=function(g23){var a29;if(g23.parent)a29=this.getTransform(g23.parent); else a29=new MatrixStack();var b29=c22(g23);if(b29.transform)b29.transform(a29);return a29;};this.onerror=function(err){};this.onrepaintrequired=function(){};this.onbeforerendernode=null;this.onafterrendernode=null;}function e21(f21,g21){return new Promise(function(resolve,reject){try{var c29=f21.getContext('webgl')||f21.getContext('experimental-webgl');if(!c29)return reject('no webgl');var d29;if(g21 instanceof Resources)d29=g21; else d29=new Resources(g21);d29.image.set("loadingtexture.png",(function(){var e29=new Image();e29.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAIAAAB7GkOtAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3wwTDwc2I0dVSQAABfxJREFUeNrt18ENAzEQA7FT+u9ZqSIItEdWYMuPgdP2WZZk+vz2t7/97f8vnweAVxIAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAEwAYAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAPxS1i/QdvsBEvvb3/729wMAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAQAAAEAAABAAAAQBAAAC4IW23L5BMn9/+9re//f0AABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAEAATAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgAgAAAIAAACAIAAACAAAJyR9Qu03X6AxP72t7/9/QAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAAABAAAAQBAAAAQAABuSNvtCyTT57e//e1vfz8AAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABABAAEwAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAIAAACAIAAACAAAAgAAGdk/QJttx8gsb/97W9/PwAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAABAAAAQBAAAAQAAAEAIAb0nb7Asn0+e1vf/vb3w8AAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAAATABAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAACAIAAACAAAAgAAAIAwBlZv0Db7QdI7G9/+9vfDwAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAAAQBAAAAQAAAEAAABAOCGL4MkY+1A+o9iAAAAAElFTkSuQmCC";return e29;})());d29.file.set("std-vertex.es2",atob("cHJlY2lzaW9uIGhpZ2hwIGZsb2F0Ow0KDQphdHRyaWJ1dGUgdmVjMyBhVmVydGV4UG9zaXRpb247DQphdHRyaWJ1dGUgdmVjMyBhVmVydGV4Tm9ybWFsOw0KYXR0cmlidXRlIHZlYzIgYVRleHR1cmVDb29yZDsNCmF0dHJpYnV0ZSB2ZWMzIGFVVmVjdG9yOw0KYXR0cmlidXRlIHZlYzMgYVZWZWN0b3I7DQoNCnVuaWZvcm0gbWF0NCB1TW9kZWxNYXRyaXg7DQp1bmlmb3JtIG1hdDQgdUNhbWVyYU1hdHJpeDsNCnVuaWZvcm0gbWF0NCB1Vmlld3BvcnRNYXRyaXg7DQp1bmlmb3JtIG1hdDQgdVZpZXdwb3J0TWF0cml4SW52ZXJzZTsNCnVuaWZvcm0gYm9vbCB1V2lyZWZyYW1lOw0KDQp2YXJ5aW5nIGxvd3AgdmVjNCB2Q29sb3I7DQp2YXJ5aW5nIGhpZ2hwIHZlYzIgdlRleHR1cmVDb29yZDsNCnZhcnlpbmcgaGlnaHAgZmxvYXQgdk5vcm1hbGl6ZWREZXB0aDsNCnZhcnlpbmcgaGlnaHAgdmVjNCB2UG9zaXRpb247DQp2YXJ5aW5nIGhpZ2hwIHZlYzMgdk1vZGVsU3BhY2VQb3NpdGlvbjsNCnZhcnlpbmcgaGlnaHAgdmVjMyB2Q2FtU3BhY2VQb3NpdGlvbjsNCnZhcnlpbmcgaGlnaHAgdmVjMyB2Tm9ybWFsOw0KdmFyeWluZyBoaWdocCB2ZWMzIHZVVmVjdG9yOw0KdmFyeWluZyBoaWdocCB2ZWMzIHZWVmVjdG9yOw0KDQp2b2lkIG1haW4odm9pZCkgew0KICAgIHZlYzQgbW9kZWxTcGFjZSA9IHVNb2RlbE1hdHJpeCAqIHZlYzQoYVZlcnRleFBvc2l0aW9uLCAxLjApOw0KICAgIHZlYzQgY2FtZXJhU3BhY2UgPSB1Q2FtZXJhTWF0cml4ICogbW9kZWxTcGFjZTsNCiAgICB2ZWM0IGNsaXBTcGFjZSA9IHVWaWV3cG9ydE1hdHJpeCAqIGNhbWVyYVNwYWNlOw0KICAgIGdsX1Bvc2l0aW9uID0gY2xpcFNwYWNlOw0KICAgIHZQb3NpdGlvbiA9IGNsaXBTcGFjZTsNCiAgICB2Q2FtU3BhY2VQb3NpdGlvbiA9IGNhbWVyYVNwYWNlLnh5eiAvIGNhbWVyYVNwYWNlLnc7DQogICAgdk1vZGVsU3BhY2VQb3NpdGlvbiA9IG1vZGVsU3BhY2UueHl6IC8gbW9kZWxTcGFjZS53Ow0KICAgIC8vIEFjdHVhbGx5IHRoZSBjYWxjdWxhdGlvbiBiZWxvdyBpcyBub3QgY29ycmVjdCwgc2VlIGZvciBleGFtcGxlIHRoZSBkaXNjdXNzaW9uIGF0DQogICAgLy8gICBodHRwOi8vd3d3LmxpZ2h0aG91c2UzZC5jb20vdHV0b3JpYWxzL2dsc2wtMTItdHV0b3JpYWwvdGhlLW5vcm1hbC1tYXRyaXgvDQogICAgLy8gQWxzbywgaXJyaXRhdGluZ2x5LCBXZWJHTCAocmVhZCBHTCBFUykgZG9lc24ndCBzdXBwb3J0IHRoZSBpbnZlcnNlKCkgZnVuY3Rpb24uICBBbmQgY2FsY3VsYXRpbmcNCiAgICAvLyB0aGUgaW52ZXJzZSBpbiBKYXZhc2NyaXB0IGZvciBlYWNoIG1lc2ggYXQgZXZlcnkgZnJhbWUgaXMgbGlrZWx5IHRvIGJlIHNsb3cuICBTbyBJJ20gc3RpY2tpbmcgd2l0aA0KICAgIC8vIHRoaXMgdW50aWwgSSBjYW4gaW1wbGVtZW50IGFuIGludmVyc2UgZnVuY3Rpb24gaW4gR0xTTC4gIEhvcGVmdWxseSB0aGUgR1BVIGNvbXBpbGVyIHdpbGwgYmUgZ29vZA0KICAgIC8vIGVub3VnaCB0byBvcHRpbWl6ZSB0aGlzIG91dCBvZiB0aGUgdmVydGV4IHBpcGVsaW5lLg0KICAgIHZlYzQgbm9ybWFsID0gdU1vZGVsTWF0cml4ICogdmVjNChhVmVydGV4Tm9ybWFsLCAwLjApOw0KICAgIHZOb3JtYWwgPSBub3JtYWwueHl6Ow0KICAgIHZlYzQgdVZlYyA9IHVNb2RlbE1hdHJpeCAqIHZlYzQoYVVWZWN0b3IsIDAuMCk7DQogICAgdlVWZWN0b3IgPSB1VmVjLnh5ejsNCiAgICB2ZWM0IHZWZWMgPSB1TW9kZWxNYXRyaXggKiB2ZWM0KGFWVmVjdG9yLCAwLjApOw0KICAgIHZWVmVjdG9yID0gdlZlYy54eXo7DQogICAgaWYgKHVXaXJlZnJhbWUpIHsNCiAgICAgICAgdk5vcm1hbGl6ZWREZXB0aCA9IGNsaXBTcGFjZS56IC8gY2xpcFNwYWNlLnc7DQogICAgICAgIHZlYzQgYyA9IHVDYW1lcmFNYXRyaXggKiB1TW9kZWxNYXRyaXggKiB2ZWM0KGFWZXJ0ZXhOb3JtYWwsIDAuMCk7DQogICAgICAgIHZlYzMgY2FtZXJhTm9ybWFsID0gbm9ybWFsaXplKHZlYzMoYy54LCBjLnksIGMueikpOw0KICAgICAgICB2Q29sb3IgPSB2ZWM0KDAuNSpjYW1lcmFOb3JtYWwueHl6K3ZlYzMoMC41LDAuNSwwLjUpLCAxLjApOw0KICAgIH0NCiAgICB2VGV4dHVyZUNvb3JkID0gYVRleHR1cmVDb29yZDsNCn0="));d29.file.set("std-fragment.es2",atob("cHJlY2lzaW9uIGhpZ2hwIGZsb2F0Ow0KDQpjb25zdCBpbnQgTUFYX0xJR0hUUyA9IDIwOw0KDQpzdHJ1Y3QgQ29tcGxleCB7DQogICAgZmxvYXQgUmU7DQogICAgZmxvYXQgSW07DQp9Ow0KDQp1bmlmb3JtIHNhbXBsZXIyRCB1VGV4dHVyZTsNCnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIHVOb3JtYWxNYXA7DQp1bmlmb3JtIGJvb2wgdU5vcm1hbE1hcHBpbmc7DQp1bmlmb3JtIGJvb2wgdVdpcmVmcmFtZTsNCnVuaWZvcm0gYm9vbCB1UmVuZGVyRWRnZXM7DQp1bmlmb3JtIG1hdDQgdVZpZXdwb3J0TWF0cml4Ow0KdW5pZm9ybSBtYXQ0IHVDYW1lcmFNYXRyaXhJbnZlcnNlOw0KdW5pZm9ybSBpbnQgdU51bWJlck9mTGlnaHRzOw0KdW5pZm9ybSB2ZWMzIHVMaWdodFBvc2l0aW9uc1tNQVhfTElHSFRTXTsNCnVuaWZvcm0gdmVjMyB1TGlnaHRDb2xvcnNbTUFYX0xJR0hUU107DQp1bmlmb3JtIENvbXBsZXggdVJlZnJhY3RpdmVJbmRleDsNCnVuaWZvcm0gZmxvYXQgdUFtYmllbnRSZWZyYWN0aXZlSW5kZXg7DQp1bmlmb3JtIHZlYzMgdUFtYmllbnRMaWdodDsNCnVuaWZvcm0gdmVjNCB1SGlnaGxpZ2h0Q29sb3I7DQp1bmlmb3JtIGZsb2F0IHVHbG9zczsNCg0KdmFyeWluZyBsb3dwIHZlYzQgdkNvbG9yOw0KdmFyeWluZyBoaWdocCB2ZWMyIHZUZXh0dXJlQ29vcmQ7DQp2YXJ5aW5nIGhpZ2hwIGZsb2F0IHZOb3JtYWxpemVkRGVwdGg7DQp2YXJ5aW5nIGhpZ2hwIHZlYzQgdlBvc2l0aW9uOw0KdmFyeWluZyBoaWdocCB2ZWMzIHZNb2RlbFNwYWNlUG9zaXRpb247DQp2YXJ5aW5nIGhpZ2hwIHZlYzMgdkNhbVNwYWNlUG9zaXRpb247DQp2YXJ5aW5nIGhpZ2hwIHZlYzMgdk5vcm1hbDsNCnZhcnlpbmcgaGlnaHAgdmVjMyB2VVZlY3RvcjsNCnZhcnlpbmcgaGlnaHAgdmVjMyB2VlZlY3RvcjsNCg0KZmxvYXQgbW9kaWZpZWRCZXNzZWxfMChmbG9hdCB4KSB7DQogICAgZmxvYXQgYXggPSBhYnMoeCk7DQogICAgZmxvYXQgeTsNCg0KICAgaWYgKGF4IDwgMy43NSkgew0KICAgICAgeSA9IHgvMy43NTsNCiAgICAgIHkgPSB5Knk7DQogICAgICByZXR1cm4gMS4wICsgeSooMy41MTU2MjI5ICsgeSooMy4wODk5NDI0ICsgeSooMS4yMDY3NDkyICsgeSooMC4yNjU5NzMyICsgeSooMC4zNjA3NjhlLTEgKyB5KjAuNDU4MTNlLTIpKSkpKTsNCiAgIH0gZWxzZSB7DQogICAgICB5ID0gMy43NSAvIGF4Ow0KICAgICAgcmV0dXJuIChleHAoYXgpL3NxcnQoYXgpKSAqICgwLjM5ODk0MjI4ICsgeSooMC4xMzI4NTkyZS0xICsgeSooMC4yMjUzMTllLTIgKyB5KigtMC4xNTc1NjVlLTIgKyB5KigwLjkxNjI4MWUtMg0KICAgICAgICAgKyB5KigtMC4yMDU3NzA2ZS0xICsgeSooMC4yNjM1NTM3ZS0xICsgeSooLTAuMTY0NzYzM2UtMSArIHkqMC4zOTIzNzdlLTIpKSkpKSkpKTsNCiAgIH0NCn0NCg0KdmVjMyB3bm9ybSh2ZWM0IHgpIHsNCiAgICByZXR1cm4geC54eXogLyB4Lnc7DQp9DQoNCnZvaWQgbWFpbih2b2lkKSB7DQogICAgaWYgKCFnbF9Gcm9udEZhY2luZykNCiAgICAgICAgZGlzY2FyZDsNCiAgICBpZiAodVJlbmRlckVkZ2VzKSB7DQogICAgICAgIGZsb2F0IHogPSBzcXJ0KHZQb3NpdGlvbi56IC8gMi4wICsgMC41KTsNCiAgICAgICAgZ2xfRnJhZ0NvbG9yID0gdmVjNCh6LCB6LCB6LCAxLjApOw0KICAgIH0gZWxzZSBpZiAodVdpcmVmcmFtZSkgew0KICAgICAgICAvLyB0cnkgdG8gZmxhdHRlbiB0aGUgZGVwdGggb3V0IGEgYml0IHNvIGl0IHJlcHJlc2VudHMgYmV0dGVyIGluIGxpbWl0ZWQgYml0cw0KICAgICAgICBmbG9hdCBkZXB0aFJlcCA9IGxvZyh2Tm9ybWFsaXplZERlcHRoICogKGV4cCgxLjApIC0gMS4wKSArIDEuMCk7DQogICAgICAgIGRlcHRoUmVwID0gbG9nKGRlcHRoUmVwICogKGV4cCgxLjApIC0gMS4wKSArIDEuMCk7DQogICAgICAgIGdsX0ZyYWdDb2xvciA9IHZlYzQodkNvbG9yLnJnYiwgZGVwdGhSZXApOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHZlYzQgdGV4dHVyZUNvbG9yID0gdGV4dHVyZTJEKHVUZXh0dXJlLCB2ZWMyKHZUZXh0dXJlQ29vcmQucywgdlRleHR1cmVDb29yZC50KSk7DQogICAgICAgIHZlYzQgZnJhZ0NvbG9yOw0KICAgICAgICBpZiAodU51bWJlck9mTGlnaHRzID4gMCkgew0KICAgICAgICAgICAgdmVjMyBjYW1lcmFQb3NpdGlvbiA9IHdub3JtKHVDYW1lcmFNYXRyaXhJbnZlcnNlICogdmVjNCgwLjAsIDAuMCwgMC4wLCAxLjApKTsNCiAgICAgICAgICAgIHZlYzMgbm9ybWFsID0gbm9ybWFsaXplKHZOb3JtYWwpOw0KICAgICAgICAgICAgaWYgKHVOb3JtYWxNYXBwaW5nKSB7DQogICAgICAgICAgICAgICAgbG93cCB2ZWM0IGRpc3BsYWNlbWVudCA9IHRleHR1cmUyRCh1Tm9ybWFsTWFwLCB2ZWMyKHZUZXh0dXJlQ29vcmQucywgdlRleHR1cmVDb29yZC50KSk7DQogICAgICAgICAgICAgICAgbm9ybWFsID0gbm9ybWFsaXplKA0KICAgICAgICAgICAgICAgICAgICAyLjAqKGRpc3BsYWNlbWVudC5yIC0gMC41KSpub3JtYWxpemUodlVWZWN0b3IpDQogICAgICAgICAgICAgICAgICArIDIuMCooZGlzcGxhY2VtZW50LmcgLSAwLjUpKm5vcm1hbGl6ZSh2VlZlY3RvcikNCiAgICAgICAgICAgICAgICAgICsgMi4wKihkaXNwbGFjZW1lbnQuYiAtIDAuNSkqbm9ybWFsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZlYzMgdG90YWxMaWdodCA9IHZlYzMoMCwgMCwgMCk7DQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IE1BWF9MSUdIVFM7ICsraSkgew0KICAgICAgICAgICAgICAgIGlmIChpID49IHVOdW1iZXJPZkxpZ2h0cykNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgdmVjMyBsaWdodENvbG9yID0gdUxpZ2h0Q29sb3JzW2ldOw0KICAgICAgICAgICAgICAgIHZlYzMgbGlnaHRQb3NpdGlvbiA9IHVMaWdodFBvc2l0aW9uc1tpXTsNCiAgICAgICAgICAgICAgICBpZiAobGlnaHRDb2xvci5yID09IDAuMCAmJiBsaWdodENvbG9yLmcgPT0gMC4wICYmIGxpZ2h0Q29sb3IuYiA9PSAwLjApDQogICAgICAgICAgICAgICAgICAgIGxpZ2h0Q29sb3IgPSB2ZWMzKDEuMCwxLjAsMS4wKTsNCiAgICAgICAgICAgICAgICB2ZWMzIGluY2lkZW50ID0gbm9ybWFsaXplKHZNb2RlbFNwYWNlUG9zaXRpb24gLSBsaWdodFBvc2l0aW9uKTsNCiAgICAgICAgICAgICAgICB2ZWMzIHJlZmxlY3RpdmUgPSByZWZsZWN0KGluY2lkZW50LCBub3JtYWwpOw0KICAgICAgICAgICAgICAgIGZsb2F0IG4xID0gdUFtYmllbnRSZWZyYWN0aXZlSW5kZXg7DQogICAgICAgICAgICAgICAgaWYgKG4xID09IDAuMCkNCiAgICAgICAgICAgICAgICAgICAgbjEgPSAxLjA7DQogICAgICAgICAgICAgICAgZmxvYXQgY3RpID0gLWRvdChub3JtYWwsIGluY2lkZW50KTsNCiAgICAgICAgICAgICAgICBpZiAoY3RpIDwgMC4wKQ0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gdGhpcyBsaWdodCBpcyBiZWhpbmQgdGhpcyBmYWNlDQogICAgICAgICAgICAgICAgZmxvYXQgc3RpID0gc3FydCgxLjAgLSBjdGkqY3RpKTsNCiAgICAgICAgICAgICAgICBmbG9hdCBSOw0KICAgICAgICAgICAgICAgIFIgPSB1UmVmcmFjdGl2ZUluZGV4LlJlOw0KICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSByZWZsZWN0YW5jZSB1c2luZyB0aGUgRnJlc25lbCBlcXVhdGlvbnMNCiAgICAgICAgICAgICAgICAvLyBUaGVyZSBpcyBhIHdheSB0byBkbyB0aGlzIGluIDggbXVscyBidXQgSSdtIHRvbyBsYXp5IDotKQ0KICAgICAgICAgICAgICAgIGlmICh1UmVmcmFjdGl2ZUluZGV4LkltID09IDAuMCkgeyAvLyBzaW1wbGUgY2FzZSBmb3Igbm9uLWNvbmR1Y3RvcnMNCiAgICAgICAgICAgICAgICAgICBmbG9hdCBuMiA9IHVSZWZyYWN0aXZlSW5kZXguUmU7DQogICAgICAgICAgICAgICAgICAgIGlmIChuMiA9PSAwLjApDQogICAgICAgICAgICAgICAgICAgICAgICBuMiA9IDEuNTsgLy8gZ29vZCBkZWZhdWx0IGZvciBwbGFzdGlja3kgc29saWRzDQogICAgICAgICAgICAgICAgICAgIGZsb2F0IHN0dCA9IG4xL24yKnN0aTsNCiAgICAgICAgICAgICAgICAgICAgZmxvYXQgY3R0ID0gc3FydCgxLjAgLSBzdHQqc3R0KTsNCiAgICAgICAgICAgICAgICAgICAgZmxvYXQgYSA9IG4xKmN0aSAtIG4yKmN0dDsNCiAgICAgICAgICAgICAgICAgICAgZmxvYXQgYiA9IG4xKmN0dCAtIG4yKmN0aTsNCiAgICAgICAgICAgICAgICAgICAgZmxvYXQgYyA9IG4xKmN0aSArIG4yKmN0dDsNCiAgICAgICAgICAgICAgICAgICAgUiA9IDAuNSooYSphICsgYipiKS8oYypjKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBSID0gMC4wOyAvLyBUT0RPDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vIEZvciB0aGUgZ2xvc3MgKG9yIHJvdWdobmVzcyksIHdlIGFzc3VtZSBhIHZvbiBNaXNlcyBkaXN0cmlidXRpb24gb2YgZGVmbGVjdGlvbiBhbmdsZXMgZnJvbQ0KICAgICAgICAgICAgICAgIC8vIHRoZSBwcmluY2lwYWwgcmVmbGVjdGlvbiB2ZWN0b3IuICBUaGUgayBwYXJhbWV0ZXIgb2YgdGhlIGRpc3RyaWJ1dGlvbiBpcyBzdWNoIHRoYXQgaz0wIGltcGxpZXMNCiAgICAgICAgICAgICAgICAvLyBwZXJmZWN0bHkgZXZlbiBkaXN0cmlidXRpb24gKGVxdWl2YWxlbnQgdG8gYSBmdWxseS1kaWZmdXNlIHN1cmZhY2UpLCBhbmQgYXMgayAtPiDiiJ4sIHRoZSBkaXN0cmlidXRpb24NCiAgICAgICAgICAgICAgICAvLyB0ZW5kcyB0b3dhcmRzIHRoZSBEaXJhYyBkZWx0YSBmdW5jdGlvbiAoaS5lLiBhbiBpbmZpbml0ZSBzcGlrZSBhdCAwKS4gIFRoZSBpbnRlZ3JhbCB1bmRlciB0aGUNCiAgICAgICAgICAgICAgICAvLyBQREYgaXMgb2YgY291cnNlIDEsIHNvIGVuZXJneSBpcyBjb25zZXJ2ZWQuICBXZSBjYW4gaWRlbnRpZnkgdUdsb3NzID0gMSA9PiBrID0g4oieIGFuZA0KICAgICAgICAgICAgICAgIC8vIHVHbG9zcyA9IDAgPT4gayA9IDANCiAgICAgICAgICAgICAgICBmbG9hdCBTID0gMC4wOw0KICAgICAgICAgICAgICAgIHZlYzMgY2FtZXJhVmVjID0gbm9ybWFsaXplKGNhbWVyYVBvc2l0aW9uIC0gdk1vZGVsU3BhY2VQb3NpdGlvbik7DQogICAgICAgICAgICAgICAgZmxvYXQgY29zX3QgPSBkb3QoY2FtZXJhVmVjLCByZWZsZWN0aXZlKTsNCiAgICAgICAgICAgICAgICBmbG9hdCBrID0gMi43MTgvKDEuMC11R2xvc3MpLTIuNzE4Ow0KICAgICAgICAgICAgICAgIGlmICh1R2xvc3MgPiAwLjk3KSAgLy8gaW4gdGhlb3J5LCB3aGF0IGhhcHBlbnMgaGVyZSBpcyBhbGwgdGhlIGxpZ2h0IGdvZXMgYWxvbmcgdGhlIHJlZmxlY3RpdmUgdmVjdG9yLg0KICAgICAgICAgICAgICAgICAgICBrID0gODcuODgyOyAgICAgLy8gaW4gcHJhY3RpY2UsIHRoaXMganVzdCBvdmVyZmxvd3MgYWxsIHRoZSBjYWxjdWxhdGlvbnMNCiAgICAgICAgICAgICAgICBmbG9hdCBJID0gbW9kaWZpZWRCZXNzZWxfMChrKTsNCiAgICAgICAgICAgICAgICBTID0gUiAqIGV4cChrICogY29zX3QpIC8gKDYuMjgzMTg1MyAqIEkpOw0KICAgICAgICAgICAgICAgIC8vIFNvIHRoZSBlbmVyZ3kgZnJvbSB0aGUgaW5jb21pbmcgbGlnaHQgaXMgZGlzdHJpYnV0ZWQgYXMgZm9sbG93czoNCiAgICAgICAgICAgICAgICAvLyAgIFIgLSBnZXRzIHJlZmxlY3RlZCBvZmYgc29tZXdoZXJlIGVsc2UNCiAgICAgICAgICAgICAgICAvLyAgIFMgLSBnZXRzIHJlZmxlY3RlZCBpbnRvIHRoZSBjYW1lcmENCiAgICAgICAgICAgICAgICAvLyAgIEQgLSBpcyBlbWl0dGVkIHVuaWZvcm1seSBpbiBhbGwgZGlyZWN0aW9ucw0KICAgICAgICAgICAgICAgIC8vIFRoZXJlZm9yZSB3aGF0IHJlYWNoZXMgdGhlIGNhbWVyYSBpcyBTICsgRC9waQ0KICAgICAgICAgICAgICAgIC8vIHJlbGF0aXZlIGVuZXJnaWVzIG9mIGNvbG9ycyB1c2VkIGhlcmU6IDAuMzByICsgMC41OWcgKyAwLjExYiBiYXNlZCBvbiBZVVYgaW50ZW5zaXR5IG1vZGVsDQogICAgICAgICAgICAgICAgLy8gbWF4aW11bSB0b3RhbCBlbmVyZ3k6IDEvMC4zICsgMS8wLjU5ICsgMS8wLjExID0gMTQuMTE5MTU3Njc4NDc5NzEyMzc4MDE3NDYyNzYzMjI1DQogICAgICAgICAgICAgICAgZmxvYXQgZW5lcmd5SW5jb21pbmcgPQ0KICAgICAgICAgICAgICAgICAgICAobGlnaHRDb2xvci5yIC8gMC4zICsgbGlnaHRDb2xvci5nIC8gMC41OSArIGxpZ2h0Q29sb3IuYiAvIDAuMTEpIC8gMTQuMTEyOw0KICAgICAgICAgICAgICAgIGZsb2F0IGQgPSAoMS4wIC0gUikgKiBlbmVyZ3lJbmNvbWluZzsgIC8vIHdoZXJlJ3MgdGhlIFBJPyAgaW4gdGhlIHRleHR1cmUuLi4NCiAgICAgICAgICAgICAgICBmbG9hdCBzID0gUyAqIGVuZXJneUluY29taW5nOw0KICAgICAgICAgICAgICAgIHRvdGFsTGlnaHQgKz0gZCAqIHRleHR1cmVDb2xvci5yZ2IgKiBsaWdodENvbG9yLnJnYiArIHMgKiBsaWdodENvbG9yLnJnYjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRvdGFsTGlnaHQgKz0gdUFtYmllbnRMaWdodC5yZ2IgKiB0ZXh0dXJlQ29sb3IucmdiOw0KICAgICAgICAgICAgZnJhZ0NvbG9yID0gdmVjNCgoMS4wIC0gdUhpZ2hsaWdodENvbG9yLmEpICogdG90YWxMaWdodC5yZ2IgKyB1SGlnaGxpZ2h0Q29sb3IuYSAqIHVIaWdobGlnaHRDb2xvci5yZ2IsIDEuMCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBmcmFnQ29sb3IgPSB0ZXh0dXJlQ29sb3I7DQogICAgICAgIH0NCiAgICAgICAgZ2xfRnJhZ0NvbG9yID0gZnJhZ0NvbG9yOw0KICAgIH0NCn0="));d29.file.set("wfm-vertex.es2",atob("YXR0cmlidXRlIHZlYzIgYVZlcnRleFBvc2l0aW9uOw0KYXR0cmlidXRlIHZlYzIgYVRleHR1cmVDb29yZDsNCg0KdmFyeWluZyBoaWdocCB2ZWMyIHZUZXh0dXJlQ29vcmQ7DQoNCnZvaWQgbWFpbih2b2lkKSB7DQogICAgZ2xfUG9zaXRpb24gPSB2ZWM0KGFWZXJ0ZXhQb3NpdGlvbi54LCBhVmVydGV4UG9zaXRpb24ueSwgMC4wLCAxLjApOw0KICAgIHZUZXh0dXJlQ29vcmQgPSBhVGV4dHVyZUNvb3JkOw0KfQ=="));d29.file.set("wfm-fragment.es2",atob("I2V4dGVuc2lvbiBHTF9FWFRfZnJhZ19kZXB0aCA6IGVuYWJsZQ0KcHJlY2lzaW9uIGhpZ2hwIGZsb2F0Ow0KDQp1bmlmb3JtIHNhbXBsZXIyRCB1V2lyZWZyYW1lOw0KdW5pZm9ybSB2ZWMyIHVWaWV3cG9ydFNpemU7DQp1bmlmb3JtIG1hdDQgdVZpZXdwb3J0TWF0cml4Ow0KdW5pZm9ybSBtYXQ0IHVWaWV3cG9ydE1hdHJpeEludmVyc2U7DQoNCnZhcnlpbmcgdmVjMiB2VGV4dHVyZUNvb3JkOw0KDQp2b2lkIG1haW4odm9pZCkgew0KICAgIHZlYzQgcGl4ID0gdGV4dHVyZTJEKHVXaXJlZnJhbWUsIHZUZXh0dXJlQ29vcmQpOw0KICAgIGlmIChwaXguYSA9PSAwLjApIHsNCiAgICAgICAgZGlzY2FyZDsNCiAgICB9IGVsc2Ugew0KICAgICAgICB2ZWMyIG9uZVBpeGVsID0gdmVjMigxLjAsIDEuMCkgLyB1Vmlld3BvcnRTaXplOw0KICAgICAgICB2ZWM0IGVkZ2UgPSAoOC4qcGl4IC0NCiAgICAgICAgICAgIHRleHR1cmUyRCh1V2lyZWZyYW1lLCB2VGV4dHVyZUNvb3JkICsgdmVjMigtb25lUGl4ZWwueCwgLW9uZVBpeGVsLnkpKSAtDQogICAgICAgICAgICB0ZXh0dXJlMkQodVdpcmVmcmFtZSwgdlRleHR1cmVDb29yZCArIHZlYzIoLW9uZVBpeGVsLngsIDApKSAtDQogICAgICAgICAgICB0ZXh0dXJlMkQodVdpcmVmcmFtZSwgdlRleHR1cmVDb29yZCArIHZlYzIoLW9uZVBpeGVsLngsIG9uZVBpeGVsLnkpKSAtDQogICAgICAgICAgICB0ZXh0dXJlMkQodVdpcmVmcmFtZSwgdlRleHR1cmVDb29yZCArIHZlYzIoMCwgLW9uZVBpeGVsLnkpKSAtDQogICAgICAgICAgICB0ZXh0dXJlMkQodVdpcmVmcmFtZSwgdlRleHR1cmVDb29yZCArIHZlYzIoMCwgb25lUGl4ZWwueSkpIC0NCiAgICAgICAgICAgIHRleHR1cmUyRCh1V2lyZWZyYW1lLCB2VGV4dHVyZUNvb3JkICsgdmVjMihvbmVQaXhlbC54LCAtb25lUGl4ZWwueSkpIC0NCiAgICAgICAgICAgIHRleHR1cmUyRCh1V2lyZWZyYW1lLCB2VGV4dHVyZUNvb3JkICsgdmVjMihvbmVQaXhlbC54LCAwKSkgLQ0KICAgICAgICAgICAgdGV4dHVyZTJEKHVXaXJlZnJhbWUsIHZUZXh0dXJlQ29vcmQgKyB2ZWMyKG9uZVBpeGVsLngsIG9uZVBpeGVsLnkpKSkvOC4gOw0KICAgICAgICBmbG9hdCBlZGdpbmVzcyA9IGVkZ2UuciplZGdlLnIgKyBlZGdlLmcqZWRnZS5nICsgZWRnZS5iKmVkZ2UuYjsNCiAgICAgICAgaWYgKGVkZ2luZXNzID4gMC4wMSkgew0KICAgICAgICAgICAgZ2xfRnJhZ0NvbG9yID0gdmVjNCgxLDEsMSwxKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGZsb2F0IHkgPSAwLjErcGl4LmEtMC4yKihwaXguYi0wLjUpKihwaXguYi0wLjUpOw0KICAgICAgICAgICAgZmxvYXQgdSA9IDAuMDgqKHBpeC5yLTAuNSkqKHBpeC5yLTAuNSk7DQogICAgICAgICAgICBmbG9hdCB2ID0gMC4xMioocGl4LmctMC41KSoocGl4LmctMC41KTsNCiAgICAgICAgICAgIGdsX0ZyYWdDb2xvcj12ZWM0KHkseSt1LHkrdiwwLjUpOw0KICAgICAgICB9DQojaWZkZWYgR0xfRVhUX2ZyYWdfZGVwdGgNCiAgICAgICAgZmxvYXQgZGVwdGhSZXAgPSBwaXguYTsNCiAgICAgICAgZmxvYXQgbmRjX2RlcHRoID0gKGV4cChkZXB0aFJlcCkgLSAxLjApLyhleHAoMS4wKSAtIDEuMCk7DQogICAgICAgIG5kY19kZXB0aCA9IChleHAobmRjX2RlcHRoKSAtIDEuMCkvKGV4cCgxLjApIC0gMS4wKTsNCiAgICAgICAgZmxvYXQgZmFyID0gZ2xfRGVwdGhSYW5nZS5mYXI7DQogICAgICAgIGZsb2F0IG5lYXIgPSBnbF9EZXB0aFJhbmdlLm5lYXI7DQogICAgICAgIGdsX0ZyYWdEZXB0aEVYVCA9ICgoKGZhciAtIG5lYXIpICogbmRjX2RlcHRoKSArIG5lYXIgKyBmYXIpIC8gMi4wOw0KI2VuZGlmDQogICAgICAgIC8vZ2xfRnJhZ0NvbG9yID0gdmVjNChkdi56LCAwLDAsMSk7DQogICAgfQ0KfQ=="));d29.all({'loadingtexture.png':d29.image,'std-vertex.es2':d29.file,'std-fragment.es2':d29.file,'wfm-vertex.es2':d29.file,'wfm-fragment.es2':d29.file}).then(function(preloaded){try{var f29=new z20(c29,f21.width,f21.height,d29);f21.__renderjs=f29;resolve(f29);}catch(error){reject(error);}});}catch(error){reject(error);}});}return e21;})();renderjs.createRenderer=createRenderer;var Primitives=(function(){function g29(h29,i29){if(h29 instanceof Array){if(!(i29 instanceof Array))throw {error:'expecting array object'};return h29.concat(i29);}for(var u29 in i29){if(typeof h29[u29]!='object')h29[u29]=i29[u29]; else h29[u29]=g29(h29[u29],i29[u29]);}return h29;}var j29=0.525731112119133606;var k29=0.850650808352039932;var l29=[[-j29,0,k29],[j29,0,k29],[-j29,0,-k29],[j29,0,-k29],[0,k29,j29],[0,k29,-j29],[0,-k29,j29],[0,-k29,-j29],[k29,j29,0],[-k29,j29,0],[k29,-j29,0],[-k29,-j29,0]];var m29=[[0,1,4],[0,4,9],[9,4,5],[4,8,5],[4,1,8],[8,1,10],[8,10,3],[5,8,3],[5,3,2],[2,3,7],[7,3,10],[7,10,6],[7,6,11],[11,6,0],[0,6,1],[6,10,1],[9,11,0],[9,2,11],[9,5,2],[7,11,2]];var n29=Geometry.Maps;function o29(p29,q29,r29,s29){for(var v29=0;v29<p29.vertices.length;++v29){var w29=p29.vertices[v29];var x29=p29.normals[v29];var y29=p29.texCoords[v29];if(((((((q29[0]==w29[0]&&q29[1]==w29[1])&&q29[2]==w29[2])&&r29[0]==x29[0])&&r29[1]==x29[1])&&r29[2]==x29[2])&&s29[0]==y29[0])&&s29[1]==y29[1])return v29;}p29.vertices.push(q29);p29.normals.push(r29);p29.texCoords.push(s29);return v29;}var t29={cube:function(properties,options){var z29;options=options||{};if(options.projection=='square'){z29=[[0.333,0.667],[0.667,0.667],[0.667,0.333],[0.333,0.333],[0.000,0.667],[0.333,0.667],[0.333,0.333],[0.000,0.333],[0.667,0.667],[1.000,0.667],[1.000,0.333],[0.667,0.333],[0.333,0.333],[0.667,0.333],[0.667,0.000],[0.333,0.000],[0.333,1.000],[0.667,1.000],[0.667,0.667],[0.333,0.667],[0.000,0.333],[0.333,0.333],[0.333,0.000],[0.000,0.000]];} else {z29=[[0.50,0.75],[0.75,0.50],[0.50,0.25],[0.25,0.50],[0.25,1.00],[0.50,0.75],[0.25,0.50],[0.00,0.75],[0.75,0.50],[1.00,0.25],[0.75,0.00],[0.50,0.25],[0.25,0.50],[0.50,0.25],[0.25,0.00],[0.00,0.25],[0.75,1.00],[1.00,0.75],[0.75,0.50],[0.50,0.75],[1.00,1.25],[1.25,1.00],[1.00,0.75],[0.75,1.00]];}return g29({mesh:{vertices:[[-0.5,-0.5,0.5],[0.5,-0.5,0.5],[0.5,0.5,0.5],[-0.5,0.5,0.5],[-0.5,-0.5,-0.5],[-0.5,-0.5,0.5],[-0.5,0.5,0.5],[-0.5,0.5,-0.5],[0.5,-0.5,0.5],[0.5,-0.5,-0.5],[0.5,0.5,-0.5],[0.5,0.5,0.5],[-0.5,0.5,0.5],[0.5,0.5,0.5],[0.5,0.5,-0.5],[-0.5,0.5,-0.5],[-0.5,-0.5,-0.5],[0.5,-0.5,-0.5],[0.5,-0.5,0.5],[-0.5,-0.5,0.5],[0.5,-0.5,-0.5],[-0.5,-0.5,-0.5],[-0.5,0.5,-0.5],[0.5,0.5,-0.5]],texCoords:z29,texture:'loadingtexture.png',faces:[[0,1,2],[2,3,0],[4,5,6],[6,7,4],[8,9,10],[10,11,8],[12,13,14],[14,15,12],[16,17,18],[18,19,16],[20,21,22],[22,23,20]]}},properties);},sphere:function(properties,options){options=options||{};options.targetTriangles=options.targetTriangles||320;options.projection=options.projection||n29.Polar;if(typeof options.projection=='string'){switch(options.projection){case 'polar':options.projection=n29.Polar;break;case 'hammer':case 'hammerAitoff':options.projection=n29.HammerAitoff;break;case 'mercator':options.projection=n29.Mercator;break;}}function a30(e30,f30){var l30=e30[0]+f30[0];var m30=e30[1]+f30[1];var n30=e30[2]+f30[2];var o30=Math.sqrt((l30*l30+m30*m30)+n30*n30);return [l30/o30,m30/o30,n30/o30];}function d30(e30,f30,g30,h30){if(h30>=i30){var p30=options.projection.getTextureCoordinates(e30,f30,g30);var q30=o29(j30,e30,e30,p30[0]);var r30=o29(j30,f30,f30,p30[1]);var s30=o29(j30,g30,g30,p30[2]);j30.faces.push([q30,r30,s30]);} else {var t30=a30(e30,f30);var u30=a30(f30,g30);var v30=a30(g30,e30);d30(e30,t30,v30,h30+1);d30(f30,u30,t30,h30+1);d30(g30,v30,u30,h30+1);d30(t30,u30,v30,h30+1);}}var i30=Math.round(Math.log(options.targetTriangles/20)/Math.log(4))|0;var j30={vertices:[],normals:[],texCoords:[],faces:[],texture:'loadingtexture.png'};for(var k30=0;k30<m29.length;++k30){d30(l29[m29[k30][0]],l29[m29[k30][1]],l29[m29[k30][2]],0);}return g29({mesh:j30},properties);},disc:function(properties,options){var w30=w30||{};var x30=(w30.numTriangles||24)|0;var y30=[];var z30=[];var a31=[];var b31=[];y30.push([0,0,0]);a31.push([0,0,1]);b31.push([0.5,0.5]);for(var c31=0;c31<x30;++c31){var d31=Math.cos(((c31*2)*Math.PI)/x30);var e31=Math.sin(((c31*2)*Math.PI)/x30);y30.push([d31,e31,0]);a31.push([0,0,1]);b31.push([(d31+1)/2,1-(e31+1)/2]);if(c31>0)z30.push([0,c31,c31+1]);}z30.push([0,c31,1]);return g29({mesh:{vertices:y30,normals:a31,texCoords:b31,faces:z30,texture:'loadingtexture.png'}},properties);}};return t29;})();renderjs.Primitives=Primitives;})(typeof window !== "undefined" ? window : this);